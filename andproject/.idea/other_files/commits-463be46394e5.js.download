"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["commits","ui_packages_file-renderer-blob_FileRendererBlob_tsx"],{91160:(e,t,n)=>{n.d(t,{M:()=>i});function i(e){if(null==e)throw Error("Failed to load page data.")}},76391:(e,t,n)=>{n.d(t,{N:()=>DebouncedWorkerManager});let DebouncedWorkerManager=class DebouncedWorkerManager{post(e){if(this.debounceOverrideCondition&&this.debounceOverrideCondition(e))return this.delayId&&clearTimeout(this.delayId),this.postNow(e);this.idle()?(this.delayId&&clearTimeout(this.delayId),this.delayId=setTimeout(()=>{this.postNow(e)},this.delayMs)):this.nextRequest=e}postNow(e){this.currentRequest=e,this.worker.postMessage(e)}idle(){return!this.currentRequest}terminate(){this.worker.terminate()}constructor(e,t=200,n){this.worker=e,this.delayMs=t,this.debounceOverrideCondition=n,this.currentRequest=void 0,this.nextRequest=void 0,this.worker.onmessage=({data:e})=>{this.onResponse&&this.onResponse(e),this.nextRequest?(this.postNow(this.nextRequest),this.nextRequest=void 0):this.currentRequest=void 0}}}},92957:(e,t,n)=>{var i,r=n(86233),a=n(79840),l=n(74848),s=n(89504),o=n(86584),d=n(82897),c=n(96540);function u(e){let t=(0,d.B)(),[n]=(0,c.useState)(t?.repo),[i]=(0,c.useState)(t?.currentUser);return(0,l.jsx)(o.Q,{user:i,children:(0,l.jsx)(s.d,{repository:n,children:e.children})})}try{u.displayName||(u.displayName="App")}catch{}var f=n(37541),m=n(76515),h=n(89895),p=n(83056),g=n(51884),x=n(97156),y=n(26750),b=n(59008),j=n(69144),C=n(93653),v=n(18312),N=n(38621),w=n(65481),L=n(30729);function S(){return(0,l.jsxs)(w.A,{variant:"warning",className:"mb-4",children:[(0,l.jsx)(L.A,{icon:N.AlertIcon,className:"mr-2"}),(0,l.jsx)("span",{className:"overflow-hidden",children:"This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository."})]})}try{S.displayName||(S.displayName="SpoofedCommitWarningBanner")}catch{}var D=n(75177),k=n(1719);function I({oid:e,repo:t}){return(0,k.N)(e,t.id)?(0,l.jsxs)(w.A,{className:"mb-4",children:[(0,l.jsx)(D.A,{as:"img",src:"/images/modules/commit/flowers@2x.png",alt:"flower image",className:"mr-4 mt-1 float-left",sx:{width:"88px",height:"49px"}}),(0,l.jsx)("h2",{children:"Thanks for everything, Jim."}),(0,l.jsx)("p",{children:"We will miss you."})]}):null}try{I.displayName||(I.displayName="WeirichCommitBanner")}catch{}function _({oid:e,repo:t,commitBranchState:n}){return(0,l.jsxs)(l.Fragment,{children:[n.loading||0!==n.branches.length?null:(0,l.jsx)(S,{}),(0,l.jsx)(I,{oid:e,repo:t})]})}try{_.displayName||(_.displayName="CommitBanners")}catch{}var E=n(84116),A=n(56628),R=n(59572),T=n(15820),F=n(22084),O=n(13894),P=n(92979),$=n(21255),M=n(87330),U=n(34614),B=n(55847),H=n(3121),V=n(94977),z=n(20053),G=n(83808),K=n(87213),W=n(47373),q=n(94034),X=n(11732),Q=n(29367),Y=n(15941),J=n(7512),Z=n(94153);function ee({data:e,repo:t,className:n}){return e.loading||0!==e.branches.length?(0,l.jsxs)("div",{className:(0,z.$)(n,"d-flex flex-items-center flex-wrap fgColor-muted gap-1"),children:[(0,l.jsx)(L.A,{className:"mr-1",icon:N.GitBranchIcon}),e.loading?(0,l.jsx)(P.O,{width:"60px",variant:"rounded",height:"22px"}):e.branches.map((n,i)=>(0,l.jsxs)("div",{children:[(0,l.jsx)(et,{branch:n,repo:t}),i!==e.branches.length-1?(0,l.jsx)("span",{className:"ml-1 user-select-none",children:"+"}):null]},n.branch))]}):null}function et({branch:e,repo:t}){return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Z.A,{className:"mx-1",href:(0,p.WJ)({owner:t.ownerLogin,repo:t.name,branch:e.branch}),children:e.branch}),e.prs.length>0?(0,l.jsxs)(l.Fragment,{children:["(",e.prs.map((t,n)=>(0,l.jsxs)(c.Fragment,{children:[(0,l.jsx)(en,{pullRequest:t}),n!==e.prs.length-1?(0,l.jsx)(l.Fragment,{children:",\xa0"}):null]},`pr-${t.repo.ownerLogin}-${t.repo.name}-${t.number}`)),")"]}):null]})}function en({pullRequest:e}){let{repo:t,number:n,showPrefix:i}=e,r=i?`${t.ownerLogin}/${t.name}`:"";return(0,l.jsxs)(U.A,{href:(0,p.oD)({repo:t,number:n}),className:"fgColor-muted","data-hovercard-url":(0,p.i9)({owner:t.ownerLogin,repo:t.name,pullRequestNumber:n}),children:[r,"#",n]})}try{ee.displayName||(ee.displayName="CommitBranchInfo")}catch{}try{et.displayName||(et.displayName="BranchFragment")}catch{}try{en.displayName||(en.displayName="PullRequestLink")}catch{}let ei={"commit-message-container":"CommitHeader-module__commit-message-container--nl1pf","commit-header-actions":"CommitHeader-module__commit-header-actions--kHXV1"};var er=n(56226);function ea({commit:e,repo:t}){return(0,l.jsxs)(l.Fragment,{children:[`${e.parents.length} parent${e.parents.length>1||0===e.parents.length?"s":""} `,e.parents.map((e,n)=>(0,l.jsxs)(c.Fragment,{children:[0!==n?" + ":"",(0,l.jsx)(U.A,{to:(0,p.$Q)({owner:t.ownerLogin,repo:t.name,commitish:e})+new URL(x.fV.origin+x.fV.pathname+x.fV.search,x.fV.origin).search,as:er.N,className:"color-fg-default Link--inTextBlock","data-hovercard-url":(0,p.fQ)({owner:t.ownerLogin,repo:t.name,commitish:e}),children:(0,W.F)(e)})]},e))]})}try{ea.displayName||(ea.displayName="CommitParents")}catch{}var el=n(16823),es=n(86079);function eo({data:e,repo:t,className:n}){if(0===e.tags.length)return null;let i=e.tags.length>2&&e.tags.length<25,r=e.tags.length>=25;return(0,l.jsxs)("div",{className:(0,z.$)(n,"d-flex flex-items-center flex-wrap gap-1"),children:[(0,l.jsx)(L.A,{className:"mr-2 fgColor-muted",icon:N.TagIcon}),(0,l.jsx)(U.A,{href:(0,p.cp)({owner:t.ownerLogin,repo:t.name,tag:e.tags[0]}),className:"fgColor-default",children:e.tags[0]}),i?(0,l.jsx)(ed,{tags:e.tags,repo:t}):null,r?(0,l.jsx)(ec,{tags:e.tags,repo:t}):null,e.tags.length>1?(0,l.jsx)(U.A,{href:(0,p.cp)({owner:t.ownerLogin,repo:t.name,tag:e.tags[e.tags.length-1]}),className:"fgColor-muted",children:e.tags[e.tags.length-1]}):null]})}function ed({tags:e,repo:t}){let[n,i]=(0,c.useState)(!1),r=(0,c.useRef)(null),a=(0,c.useCallback)(()=>{i(!0),requestAnimationFrame(()=>r.current?.focus())},[]);return n?(0,l.jsx)(l.Fragment,{children:e.slice(1,e.length-1).map((e,n)=>(0,l.jsx)(U.A,{ref:0===n?r:null,href:(0,p.cp)({owner:t.ownerLogin,repo:t.name,tag:e}),className:"fgColor-muted mx-1",children:e},e))}):(0,l.jsx)(M.K,{"aria-label":"Show more tags",unsafeDisableTooltip:!0,icon:N.KebabHorizontalIcon,size:"small",variant:"invisible",onClick:a})}function ec({tags:e,repo:t}){let[n,i]=(0,c.useState)(!1),r=(0,c.useRef)(null);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(M.K,{"aria-label":"Show all tags",unsafeDisableTooltip:!0,icon:N.KebabHorizontalIcon,size:"small",variant:"invisible",onClick:()=>i(!0),ref:r}),n&&(0,l.jsx)(es.l,{title:`${e.length} tags`,onClose:()=>i(!1),returnFocusRef:r,width:"medium",height:e.length>=12?"small":"auto",renderBody:()=>(0,l.jsx)(el.l,{className:"overflow-y-auto py-2","data-testid":"tag-dialog-list",children:e.map(e=>(0,l.jsx)(el.l.LinkItem,{href:(0,p.cp)({owner:t.ownerLogin,repo:t.name,tag:e}),children:e},e))})})]})}try{eo.displayName||(eo.displayName="CommitTagInfo")}catch{}try{ed.displayName||(ed.displayName="ExpandedTags")}catch{}try{ec.displayName||(ec.displayName="CommitTagsDialog")}catch{}function eu({commit:e,commitInfo:t,repo:n}){let i=(0,c.useRef)(null),r=(0,K.I)(`${(0,p.$Q)({owner:n.ownerLogin,repo:n.name,commitish:e.oid})}/deferred_commit_data`);return(0,l.jsxs)($.z,{children:[(0,l.jsx)($.z.TitleArea,{variant:"large",sx:{minWidth:0,alignItems:"center"},children:(0,l.jsx)($.z.Title,{as:"h1",sx:{minWidth:0},className:"f2",children:(0,l.jsx)(F.yx,{ref:i,html:e.shortMessageMarkdown,className:"markdown-title"})})}),(0,l.jsxs)($.z.ContextArea,{children:[(0,l.jsx)($.z.ContextBar,{children:(0,l.jsx)(em,{})}),(0,l.jsx)($.z.ContextAreaActions,{children:(0,l.jsx)(M.K,{as:U.A,href:(0,p.IO)({repo:n,action:"tree",commitish:e.oid}),icon:N.FileCodeIcon,"aria-label":"Browse files"})})]}),(0,l.jsx)($.z.Actions,{className:(0,z.$)(ei["commit-header-actions"]),children:(0,l.jsxs)("div",{className:"d-none d-md-flex gap-2 flex-items-center flex-justify-between flex-md-justify-end",children:[(0,l.jsx)(em,{}),(0,l.jsx)(V.A,{text:"Browse the repository at this point in the history",direction:"sw",sx:{display:"flex"},children:(0,l.jsx)(B.Q,{as:U.A,href:(0,p.IO)({repo:n,action:"tree",commitish:e.oid}),leadingVisual:N.FileCodeIcon,children:"Browse files"})})]})}),(0,l.jsx)($.z.Description,{children:(0,l.jsxs)("div",{className:"d-flex flex-column gap-2 width-full",children:[(0,l.jsx)(X.j,{commit:e,repo:n,settings:{fontColor:"fg.default",avatarSize:20,fontWeight:"bold"},textVariant:"muted",children:(0,l.jsx)(ef,{deferredData:r,oid:e.oid,repo:n})}),(0,l.jsxs)(J.Z,{className:"pt-0",children:[e.bodyMessageHtml&&(0,l.jsx)("div",{className:(0,z.$)(ei["commit-message-container"]),children:(0,l.jsx)(F.yx,{html:e.bodyMessageHtml,className:"ws-pre-wrap extended-commit-description-container f6 wb-break-word text-mono"})}),(0,l.jsxs)("div",{className:"p-2 d-flex gap-2 flex-column flex-md-row flex-justify-between",children:[(0,l.jsxs)("div",{className:"d-flex flex-row flex-items-center",children:[(0,l.jsx)(ee,{data:t,repo:n}),t.tags.length>0&&(0,l.jsx)("span",{className:"px-2",children:"\xb7"}),(0,l.jsx)(eo,{data:t,repo:n})]}),(0,l.jsxs)("pre",{className:"color-fg-muted d-flex flex-items-center",children:[(0,l.jsx)(ea,{commit:e,repo:n})," commit ",(0,l.jsx)("span",{className:"fgColor-default",children:(0,W.F)(e.oid)}),(0,l.jsx)(Y.w,{sha:e.oid,direction:"sw"})]})]})]})]})})]})}function ef({deferredData:e,oid:t,repo:n}){let{helpUrl:i}=(0,G.D)(),r=void 0===e,a="";try{a=e?.statusCheckStatus?.short_text?.split("checks")[0]?.trim()||""}catch{}return(0,l.jsxs)(l.Fragment,{children:[r&&(0,l.jsx)(P.O,{className:"ml-2",variant:"rounded",width:Q._e}),e?.statusCheckStatus&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"d-flex ml-2 mr-1",children:"\xb7"}),(0,l.jsx)(q.d,{oid:t,status:e?.statusCheckStatus?.state,descriptionString:a,repo:n}),e?.signatureInformation&&e?.verifiedStatus!=="unsigned"&&(0,l.jsx)("span",{className:"d-flex ml-2",children:"\xb7"})]}),e?.signatureInformation&&(0,l.jsx)("div",{className:"ml-2",children:(0,l.jsx)(O.h,{commitOid:t,hasSignature:!0,verificationStatus:e.verifiedStatus,signature:{helpUrl:i,...e.signatureInformation}})})]})}function em(){let e=(0,T.u)("diff_ux_refresh_beta");return(0,l.jsxs)("div",{className:"d-flex flex-items-center gap-2",children:[(0,l.jsx)(H.A,{variant:"success",children:e?"Beta":"Alpha"}),(0,l.jsx)(U.A,{href:"https://gh.io/new-commit-details-feedback",target:"_blank",rel:"noopener noreferrer",className:"no-wrap f5 text-normal",children:"Give feedback"})]})}try{eu.displayName||(eu.displayName="CommitHeader")}catch{}try{ef.displayName||(ef.displayName="DeferredCommitHeaderData")}catch{}try{em.displayName||(em.displayName="Feedback")}catch{}function eh({unavailableReason:e,commit:t,commitInfo:n}){let i=(0,s.t)(),r=ep[e];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(A.B,{"data-hpc":!0,padding:{narrow:"normal",regular:"spacious"},children:(0,l.jsx)(eu,{commit:t,commitInfo:n,repo:i})}),(0,l.jsxs)(R.A,{children:[(0,l.jsx)(R.A.Visual,{children:r.visual}),(0,l.jsx)(R.A.Heading,{children:r.heading}),(0,l.jsx)(R.A.Description,{children:r.description}),r.secondaryAction]})]})}let ep={corrupt:{visual:(0,l.jsx)(N.AlertIcon,{}),heading:"Sorry, this diff is unavailable.",description:"The repository may be missing relevant data.",secondaryAction:(0,l.jsx)(R.A.SecondaryAction,{href:(0,p.y2)(),children:"Please contact support for more information"})},"missing commits":{visual:(0,l.jsx)(N.AlertIcon,{}),heading:"Sorry, this diff is unavailable.",description:"The repository may be missing relevant data.",secondaryAction:(0,l.jsx)(R.A.SecondaryAction,{href:(0,p.y2)(),children:"Please contact support for more information"})},timeout:{visual:(0,l.jsx)(N.HourglassIcon,{}),heading:"Sorry, this diff is taking too long to generate.",description:"It may be too large to display on GitHub."},"too busy":{visual:(0,l.jsx)(N.HourglassIcon,{}),heading:"Sorry, this diff is temporarily unavailable due to heavy server load.",description:"Please try again later."}};try{eh.displayName||(eh.displayName="CommitUnavailable")}catch{}var eg=n(62353),ex=n(48193),ey=n(67726),eb=n(73627),ej=n(41631),eC=n(35822),ev=n(27788),eN=n(28784),ew=n(84928);let eL="/users/diffview",eS=(0,c.createContext)({hideWhitespace:!1,splitPreference:"split",lineSpacing:"relaxed",updateHideWhitespace:()=>{},updateSplitPreference:()=>{},updateLineSpacing:()=>{}});function eD({viewSettings:e,children:t}){let n=(0,ev.Z)(),i=(0,o.i)(),r=function(e){let t=e,[n]=(0,ev.o)(),i=n.get("diff");return("split"===i||"unified"===i)&&(t=i),t}(e.splitPreference),a=function(e){let t=e,[n]=(0,ev.o)(),i=n.get("w");return"1"===i?t=!0:"0"===i&&(t=!1),t}(e.hideWhitespace),s=e.lineSpacing,[d,u]=(0,c.useState)(r),[f,m]=(0,c.useState)(a),[h,g]=(0,c.useState)(s),x=function(){let e=(0,ew.W)(`${eL}?diff=split`,"post"),t=(0,ew.W)(`${eL}?diff=unified`,"post");return async function(n){"split"===n?await e():"unified"===n&&await t()}}(),y=async function(e,t){if(!t)return;let n=new FormData;n.set("diff_line_spacing",e),(0,eN.DI)((0,p.Dk)(t),{method:"PUT",body:n,headers:{Accept:"application/json"}})},b=(0,c.useCallback)(e=>{(function(e,t){let n=new URL(window.location.href,window.location.origin);if(t){let i=encodeURIComponent(t);n.searchParams.set(e,i)}else n.searchParams.delete(e);window.history.replaceState({path:n.toString()},"",n.toString())})("diff",e),u(e),x(e)},[x]),j=(0,c.useCallback)(e=>{m(e),n(`${window.location.pathname}?w=${e?"1":"0"}`)},[n]),C=(0,c.useCallback)(e=>{g(e),y(e,i)},[i,y]),v=(0,c.useMemo)(()=>({hideWhitespace:f,splitPreference:d,lineSpacing:h,updateHideWhitespace:j,updateSplitPreference:b,updateLineSpacing:C}),[f,h,d,j,C,b]);return(0,l.jsx)(eS.Provider,{value:v,children:t})}function ek(){return(0,c.useContext)(eS)}try{eS.displayName||(eS.displayName="DiffViewSettingsContext")}catch{}try{eD.displayName||(eD.displayName="DiffViewSettingsProvider")}catch{}let eI="commit-details-marker-portal",e_={extraDiffEntries:[],loading:!0,error:!1};var eE=n(48058);function eA(e){if(!e)return"";let t=e.lastIndexOf(".");return!t||t<0?eE.F7:`.${e.substring(t+1)}`}let eR=(e,t=0)=>`calc(${e}px + ${t}px)`,eT={position:"sticky",zIndex:1,backgroundColor:"canvas.default","&::before":{bg:"canvas.default",content:'""',position:"absolute",display:"block",height:"100%",width:"calc(100% + 30px)",ml:"-14px",mr:-3}};var eF=n(30792),eO=n(65568),eP=n(6256),e$=n(71878),eM=n(20594);async function eU(e,t,n){let i=await (0,eN.Sr)(`${t}?pathDigest=${n}${function(e){let t="";for(let n=0;n<e.length;n++)t+=`&lineRanges[]=${JSON.stringify(e[n])}`;return t}(e)}`);if(i.ok)return await i.json()??void 0}async function eB({repo:e,sha1:t,sha2:n,entry:i}){let r=await (0,eN.Sr)((0,eM.RD)((0,p.ux)({owner:e.ownerLogin,repo:e.name,entry:i,sha1:t,sha2:n})));if(r.ok){let e=await r.json();return(0,eM.Av)(e),e.diffLines}}var eH=n(81602),eV=n(89323);function ez({oid:e,path:t,repo:n,isViewable:i=!0,copilotDiffChatProps:r}){return(0,l.jsxs)(eV.W,{children:[(0,l.jsx)(eV.W.Anchor,{children:(0,l.jsx)("button",{className:"Button Button--iconOnly Button--invisible","aria-label":"More options",children:(0,l.jsx)(N.KebabHorizontalIcon,{})})}),(0,l.jsx)(eV.W.Overlay,{children:(0,l.jsxs)(el.l,{children:[(0,l.jsxs)(el.l.LinkItem,{href:(0,p.nD)({repo:n.name,owner:n.ownerLogin,filePath:t,commitish:e}),inactiveText:i?void 0:"Action unavailable",children:[(0,l.jsx)(el.l.LeadingVisual,{children:(0,l.jsx)(N.EyeIcon,{})}),"View file"]}),r&&(0,l.jsx)(eH.$,{...r})]})})]})}try{ez.displayName||(ez.displayName="BlobActionsMenu")}catch{}let eG=(0,c.memo)(function({commitOid:e,path:t,proseDiffHtml:n,fileRendererInfo:i,dependencyDiffPath:r}){let{loaded:a,richDiffData:o}=function(e,t,n,i){let r=!!t.proseDiffHtml||!!t.fileRendererInfo||!!i,a=(0,s.t)(),[l,o]=(0,c.useState)(r),[d,u]=(0,c.useState)(t),f=(0,c.useCallback)(async()=>{let t=await (0,eN.lS)(`${(0,p.$Q)({owner:a.ownerLogin,repo:a.name,commitish:e})}/rich_diff/${encodeURIComponent(n)}`);t.ok&&u(await t.json()),o(!0)},[e,n,a]);return(0,c.useEffect)(()=>{r||f()},[r,f]),{loaded:l,richDiffData:d}}(e,{proseDiffHtml:n,fileRendererInfo:i},t,r);return(0,l.jsx)(f.Uz,{dependencyDiffPath:r,fileRendererInfo:o.fileRendererInfo,loading:!a,proseDiffHtml:o.proseDiffHtml})});try{eG.displayName||(eG.displayName="CommitRichDiff")}catch{}let eK={isInMergeQueue:!1,state:"OPEN"},eW=c.memo(c.forwardRef(eq));function eq({prId:e,diffMatches:t,focusedSearchResult:n,diffEntryData:i,splitPreference:r,lineSpacing:a,contextLinePathURL:s,recalcTotalHeightOfVirtualWindow:u,helpUrl:m,headerStickyOffset:h=0,repo:p,oid:g,index:x,ignoreWhitespace:y,virtualizerScrollTo:b},j){let C=(0,o.i)(),v=function(){let e=(0,d.B)(),{commit:t,commentInfo:n}=e,i=(0,e$.I)({commit:t,repo:e.repo,viewerCanReply:n.canComment}),{addComment:r,deleteComment:a,editComment:l,hideComment:s,unhideComment:o}=(0,eP.X)(),{findInlineComment:u}=(0,eO.B)(),f=(0,c.useCallback)(({filePath:e,onCompleted:t,onError:n,text:i,thread:a})=>{let[l,s]=a.id.split("::");if(!l||!s){n(Error("Invalid threadId"));return}r(i,e,s).then(e=>{e.comment?t?.(e.comment.id):n(Error("Failed to add comment"))})},[r]),m=(0,c.useCallback)(({text:e,diffLine:t,filePath:n,onCompleted:i,onError:a})=>{t&&t.position&&r(e,n,t.position.toString()).then(e=>{if(e.comment){let r=e.comment.id,a=`${n}::${t.position}`;i?.(a,r)}else a?.(Error("Failed to add comment"))})},[r]),h=(0,c.useCallback)(({comment:e,text:t,onCompleted:n,onError:i})=>{let r=u(e.id);if(!r){i(Error("Comment not found"));return}l(t,{id:r.id,bodyVersion:r.bodyVersion}).then(e=>{e.updatedFields?n?.():i(Error("Failed to edit comment"))})},[l,u]),p=(0,c.useCallback)(({commentId:e,onCompleted:t,onError:n})=>{let i=u(e);if(!i){n?.(Error("Comment not found"));return}a(i.id.toString()).then(e=>{"success"===e?t?.():"error"===e&&n?.(Error("Failed to delete comment"))})},[a,u]),g=(0,c.useCallback)(({commentId:e,reason:t,onCompleted:n,onError:i})=>{let r=u(e);if(!r){i?.(Error("Comment not found"));return}s(r.id.toString(),t).then(e=>{"success"===e?n?.():"error"===e&&i(Error("Failed to hide comment"))})},[u,s]),x=(0,c.useCallback)(({commentId:e,onCompleted:t,onError:n})=>{let i=u(e);if(!i){n?.(Error("Comment not found"));return}o(i.id.toString()).then(e=>{"success"===e?t?.():"error"===e&&n(Error("Failed to unhide comment"))})},[u,o]);return(0,c.useMemo)(()=>({batchingEnabled:!1,commentSubjectType:"commit",multilineEnabled:!1,resolvingEnabled:!1,suggestedChangesEnabled:!1,lazyFetchReactionGroups:!0,lazyFetchEditHistory:!0,addThread:m,addThreadReply:f,deleteComment:p,editComment:h,pendingSuggestedChangesBatch:[],submitSuggestedChanges:ey.l,addSuggestedChangeToPendingBatch:ey.l,removeSuggestedChangeFromPendingBatch:ey.l,addFileLevelThread:ey.l,resolveThread:ey.l,unresolveThread:ey.l,hideComment:g,unhideComment:x,fetchThread:i,commentBoxConfig:{pasteUrlsAsPlainText:!1,useMonospaceFont:!1}}),[m,f,p,h,i,g,x])}(),N=(0,c.useMemo)(()=>({filteredMarkers:[],activeGlobalMarkerID:"",decrementActiveMarker:ey.l,incrementActiveMarker:ey.l,onActivateGlobalMarkerNavigation:ey.l,overlayPortalContainerName:eI}),[]),w=(0,d.B)().commentInfo,{getThreadDataByPathAndPosition:L,initialExpandedThreadId:S}=(0,eO.B)(),[k,I]=(0,c.useState)(eX(i.current[x],L)),_=(0,c.useCallback)(e=>{I(eX(e,L))},[L]),[E,A]=(0,c.useState)(k.collapsed),[R,T]=(0,c.useState)(k.defaultToRichDiff),[F,O]=(0,c.useState)(k.diffManuallyExpanded),P=(0,c.useRef)(!1),{fetchInjectedContextLines:$,fetchDiffLines:M}={fetchInjectedContextLines:eU,fetchDiffLines:eB},U=(0,c.useRef)([]),B=(0,c.useCallback)(async e=>{U.current.push(e);let t=await $(U.current,s,k.pathDigest);if(void 0!==t){let e={...k};e.diffLines=t.diffEntryWithContext,_(e),i.current[x]=e,u()}},[s,i,k,x]),H=async()=>{U.current=[],P.current||((k.newTreeEntry?.lineCount??0)<5e3?U.current.push({start:1,end:Math.max(k.oldTreeEntry?.lineCount??0,k.newTreeEntry?.lineCount??0)}):U.current=function(e,t){let n=[];for(let t=0;t<e.length;t++)if("HUNK"===e[t].type){let i=e[t-1>=0?t-1:0],r=e[t+1<e.length?t+1:e.length-1],a=i?.blobLineNumber,l=r?.blobLineNumber;a&&l&&(n.push({start:a,end:a+40}),n.push({start:Math.max(l-40,1),end:l}))}let i=e[e.length-1].blobLineNumber;return i<t&&n.push({start:i,end:i+40}),n}(k.diffLines,k.newTreeEntry?.lineCount??0)),P.current=!P.current;let e=await $(U.current,s,k.pathDigest);if(void 0!==e){let t={...k};t.diffLines=e.diffEntryWithContext,_(t),i.current[x]=t,u()}},V=(0,c.useCallback)(async()=>{if(0===k.diffLines.length){let e=await M({repo:p,sha1:k.oldOid,sha2:k.newOid,entry:k.diffNumber.toString()});if(!e)return;let t={...k};t.diffLines=e,_(t),i.current[x]=t}k.diffManuallyExpanded=!0,i.current[x].diffManuallyExpanded=!0,O(!0),u(),requestAnimationFrame(()=>{b?.(x,{align:"center"})})},[i,k,x,u]);(0,c.useEffect)(()=>{_(i.current[x]),U.current=[]},[y,x,i,g,p.name,p.ownerLogin,k.path,_]);let z=(0,c.useMemo)(()=>{if(P.current||(i.current[x]?.diffLines?.[1]?.blobLineNumber||0)>1)return!0;let e=i.current[x]?.diffLines?.length||0,t=i.current[x]?.diffLines?.[e-1]?.blobLineNumber||0,n=i.current[x]?.newTreeEntry?.lineCount||0;return t<n||e-1<n},[i.current[x]?.diffLines,i.current[x]?.newTreeEntry?.lineCount,x,i]),G=(0,c.useMemo)(()=>({avatarUrl:C?.avatarURL??"",diffViewPreference:r,isSiteAdmin:!1,login:C?.login??"",lineSpacingPreference:a,tabSizePreference:C?.tabSize??8,viewerCanComment:w.canComment,viewerCanApplySuggestion:!1}),[r,C?.avatarURL,C,C?.login,C?.tabSize,a]),K=(0,c.useMemo)(()=>{if(e&&k.copilotChatReferenceData)return{referenceData:k.copilotChatReferenceData,queryVariables:{pullRequestId:e,startOid:k.oldOid,endOid:k.newOid}}},[k,e]);return(0,l.jsxs)("div",{className:"position-relative",ref:j,children:[(0,l.jsx)(D.A,{sx:{...eT,top:[eR(56,h),eR(64,h)]},children:(0,l.jsx)(eF.B,{areLinesExpanded:P.current,canExpandOrCollapseLines:z,defaultToRichDiff:k.defaultToRichDiff,fileLinkHref:`#diff-${k.pathDigest}`,isCollapsed:E,canToggleRichDiff:k.canToggleRichDiff,linesAdded:k.linesAdded,linesChanged:k.linesChanged,linesDeleted:k.linesDeleted,newMode:k.newTreeEntry?.mode,newPath:k.newTreeEntry?.path,oldMode:k.oldTreeEntry?.mode,oldPath:k.oldTreeEntry?.path,patchStatus:k.status,path:k.path,onToggleExpandAllLines:H,onToggleFileCollapsed:()=>{k.collapsed=!E,i.current[x].collapsed=!E,A(!E)},onToggleDiffDisplay:e=>T(e),rightSideContent:(0,l.jsx)(ez,{oid:"REMOVED"===k.status&&k.deletedSha?k.deletedSha:g,path:k.path,repo:p,isViewable:!k.isSubmodule,copilotDiffChatProps:K})})}),E?null:(0,l.jsx)("div",{className:"border position-relative rounded-bottom-2",children:R?(0,l.jsx)(eG,{commitOid:g,path:k.path,proseDiffHtml:k.proseDifffHtml,fileRendererInfo:k.renderInfo,dependencyDiffPath:k.dependencyDiffPath}):(0,l.jsx)(f.T5,{diffContext:"commit",copilotChatReferenceData:e?k.copilotChatReferenceData:void 0,searchResults:t,focusedSearchResult:n,diffEntryData:k,baseHelpUrl:m,commentingEnabled:!0,commentBatchPending:!1,repositoryId:p.id.toString(),subject:eK,subjectId:e?.toString()??"",viewerData:G,newCommitOid:k.newOid,oldCommitOid:k.oldOid,addInjectedContextLines:B,commentingImplementation:v,markerNavigationImplementation:N,diffLinesManuallyUnhidden:F,onHandleLoadDiff:V,initialExpandedThreadId:S})})]})}function eX(e,t){for(let n of e.diffLines??[]){let i=t(e.path,n.position);i?n.threadsData={totalCommentsCount:i.count,totalCount:i.count,threads:(i.threads??[]).map(e=>({id:e.id,diffSide:e.diffSide,commentsData:e.commentsData,line:n.blobLineNumber,isOutdated:!1}))}:n.threadsData=void 0}return e}try{eW.displayName||(eW.displayName="Diff")}catch{}try{eq.displayName||(eq.displayName="DiffUnmemoized")}catch{}let eQ=c.memo(eY);function eY(){return(0,l.jsx)("div",{className:"pt-3",children:(0,l.jsxs)("div",{className:"border borderColor-muted rounded-top-2",children:[(0,l.jsx)("div",{className:"gap-2 p-3 border-bottom borderColor-muted bgColor-muted rounded-top-2",children:(0,l.jsx)(P.O,{height:"sm",variant:"rounded",width:"140px"})}),(0,l.jsxs)("div",{className:"d-flex flex-column gap-2 p-3",children:[(0,l.jsx)(P.O,{height:"sm",variant:"rounded",width:"random"}),(0,l.jsx)(P.O,{height:"sm",variant:"rounded",width:"random"}),(0,l.jsx)(P.O,{height:"sm",variant:"rounded",width:"random"}),(0,l.jsx)(P.O,{height:"sm",variant:"rounded",width:"random"})]})]})})}try{eQ.displayName||(eQ.displayName="LoadingContentBlock")}catch{}try{eY.displayName||(eY.displayName="LoadingContentBlockUnmemoized")}catch{}function eJ({diffEntryData:e,contextLinePathURL:t,selectedPathDigest:n,unselectedFileExtensions:i,repo:r,oid:a,ignoreWhitespace:s,commitInfo:o,filterTerm:u,searchTerm:h,setSearchTerm:g,isStickied:b}){let j=ek(),C=j.lineSpacing,v=(0,d.B)(),N=(0,c.useCallback)(()=>S({}),[]),[L,S]=(0,c.useState)({}),D=(0,c.useRef)(e),{findInDiffWorkerPath:k}=(0,G.D)(),I=(0,c.useRef)(e),_=(0,c.useRef)(e.length>40),E=(0,c.useRef)(null),[A,R]=(0,c.useState)(s),T=(0,c.useRef)(0),[F,O]=(0,c.useState)(a),{diffFindOpen:P,setDiffFindOpen:$}=(0,f.K_)(),{findInFileShortcut:M}=(0,eg.wk)(),U=(0,c.useRef)(null),{focusedSearchResult:B,setFocusedSearchResult:H,searchResults:V,currentIndex:z,setCurrentIndex:K}=(0,f.xB)(D.current,h,k,L);function W(){$(!0);let e=window.getSelection()?.toString();e&&g(e),P&&U?.current?.focus()}(0,c.useEffect)(()=>{i&&i.size>0?D.current=I.current.filter(e=>!i.has(eA(e.path))):D.current=I.current,u&&(D.current=D.current.filter(e=>e.path.toLowerCase().includes(u.toLowerCase()))),_.current=D.current.length>40,N()},[i?.size,u]),(0,c.useEffect)(()=>{D.current=e,I.current=e,_.current=D.current.length>40,N(),R(s),O(a)},[v.path]);let q=(0,eb.X)(),X=(0,p.gq)({owner:v.repo.ownerLogin,repo:v.repo.name,commitish:v.commit.oid}),Q=function(e,t,n,i,r,a){let[l,s]=(0,c.useState)(e_),o=(0,c.useRef)([]),d=(0,c.useRef)(n);return(0,c.useEffect)(()=>{if(!i||!r)return;let a=!1,l=async(e,t,n)=>{s(e_);let r=await (0,eN.lS)(`${i}?start_entry=${e}&bytes=${t}&lines=${n}`);if(!a)try{if(r.ok){let e=await r.json();e&&(e.loading=e.loadMore,o.current=o.current.concat(e.extraDiffEntries),e.extraDiffEntries=o.current,e.loadMore&&d.current!==e.asyncDiffLoadInfo.startIndex?(d.current=e.asyncDiffLoadInfo.startIndex,s(e),setTimeout(()=>l(e.asyncDiffLoadInfo.startIndex,e.asyncDiffLoadInfo.byteCount,e.asyncDiffLoadInfo.lineShownCount),0)):(d.current===e.asyncDiffLoadInfo.startIndex?e.error=!0:e.error=!1,e.loading=!1,s(e)))}else s(e=>({...e,loading:!1,error:!0,extraDiffEntries:o.current}))}catch(e){s(e=>({...e,loading:!1,error:!0,extraDiffEntries:o.current}))}};return l(n,e,t),function(){a=!0}},[e,t,r,n,i,a]),(0,c.useEffect)(()=>{o.current=[],d.current=n},[i,n,a]),l}(v.asyncDiffLoadInfo.byteCount,v.asyncDiffLoadInfo.lineShownCount,v.asyncDiffLoadInfo.startIndex,X,v.moreDiffsToLoad,s);(0,c.useEffect)(()=>{let e=D.current.concat(Q.extraDiffEntries);i&&i.size>0?D.current=e.filter(e=>!i.has(eA(e.path))):D.current=e,u&&(D.current=D.current.filter(e=>e.path.toLowerCase().includes(u.toLowerCase()))),I.current=e,_.current=D.current.length>40,N()},[Q.extraDiffEntries.length]);let Y=(0,c.useRef)(null),J=(0,ej.h)({parentRef:Y,size:D.current.length,estimateSize:(0,c.useCallback)(e=>{var t;let n;return t=D.current[e],n=67,t?.collapsed?n:t?.newTreeEntry?.isGenerated&&!t?.diffManuallyExpanded?199:t?.isTooBig?104:(t?.diffLines&&("compact"===C?n+=20*t.diffLines.length:n+=25*t.diffLines.length),t?.newTreeEntry?.lineCount&&t.newTreeEntry.lineCount>(t?.diffLines[t?.diffLines.length-1]?.right??0)&&(n+=32),n)},[D.current.length,L]),useVirtualImpl:ej.Y,rangeExtractor(e){let t=x.fV.hash.substring(1),n=(0,m.pd)(t),i=document.querySelector("[data-path-digest]:focus-within")?.getAttribute("data-path-digest"),r=D.current.findIndex(e=>e.pathDigest===i),a=D.current.findIndex(e=>n?.endsWith(e.pathDigest));return r<0&&a<0?(0,eC.v)(e):Array.from(new Set([...(0,eC.v)(e),...[r,a].filter(e=>e>-1)])).sort((e,t)=>e-t)}});return(0,c.useEffect)(()=>{let e=n.includes("R"),t=n.includes("L"),i=t||e,r=i?t?n.split("L")[0]:n.split("R")[0]:n,a=eZ(r??n,D.current);if(-1===a){if(Q.error&&null!==E){let e=E.current?.childNodes[0];e?.focus(),e?.scrollIntoView({block:"center"})}return}if(_.current)J.scrollToIndex(a,{align:"center"}),requestAnimationFrame(()=>{if(i&&e0(Y,n));else{let e=Y.current?.querySelectorAll(`[aria-label="collapse file: ${D.current[a]?.path}"]`);e&&1===e.length&&e[0].focus()}});else if(i&&e0(Y,n));else{let e=Y.current?.querySelectorAll(`[data-diff-anchor=diff-${r}]`);if(e&&1===e.length){let t=e[0].getBoundingClientRect().top+(x.cg?.scrollY??0)-67-60;x.cg?.scrollTo(0,t);let n=Y.current?.querySelectorAll(`[aria-label="collapse file: ${D.current[a]?.path}"]`);n&&1===n.length&&n[0].focus()}}},[n,Q]),(0,l.jsxs)("div",{"data-hpc":!0,ref:Y,children:[(0,l.jsx)(ex.dE,{id:eI}),!_.current&&D.current.map((e,n)=>(0,l.jsx)("div",{style:{paddingTop:0===n?0:16,left:3,right:3},children:(0,l.jsx)(eW,{prId:o?.branches[0]?.prs[0]?.globalRelayId,diffEntryData:D,index:n,splitPreference:j.splitPreference,contextLinePathURL:t,recalcTotalHeightOfVirtualWindow:ey.l,repo:r,helpUrl:q.helpUrl,oid:F,ignoreWhitespace:A,lineSpacing:j.lineSpacing})},e.pathDigest)),!_.current&&0===D.current.length&&(0,l.jsx)("h3",{className:"d-flex flex-justify-center",children:"There are no files selected for viewing"}),_.current&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(y.ak,{commands:{"commit-diff-view:open-find":W}}),(0,l.jsx)("button",{hidden:!0,"data-hotkey":M.hotkey,onClick:W}),P&&(0,l.jsx)(f.qj,{inputContainer:U,currentPathDigestIndex:T,stickied:b,searchTerm:h,focusedSearchResult:B,currentIndex:z,setCurrentIndex:K,setFocusedSearchResult:H,setSearchTerm:g,searchResults:V,scrollDiffCellIntoView:e=>{let t=eZ(e?.pathDigest??"",D.current);-1!==t&&(J.scrollToIndex(t,{align:"center"}),requestAnimationFrame(()=>{(function(e,t){let n=x.XC?.getElementById(`match-${t}-${e}`);n&&n.scrollIntoView({block:"center"})})(e?.indexWithinDigest??0,e?.pathDigest??"")}))},onClose:()=>{$(!1)}}),(0,l.jsx)("div",{style:{height:J.totalSize,width:"100%",position:"relative"},children:J.virtualItems.map(e=>{let n,i;let a=D.current[e.index];return(V.has(a?.pathDigest??"")&&(n=V.get(a?.pathDigest??"")??[]),B&&a?.pathDigest===B?.pathDigest&&(i=B?.indexWithinDigest??-1),a)?(0,l.jsx)("div",{ref:e.measureRef,"data-key":e.key,style:{position:"absolute",paddingTop:0===e.index?0:16,left:3,right:3,transform:`translateY(${e.start}px)`},children:(0,l.jsx)(eW,{prId:o?.branches[0]?.prs[0]?.globalRelayId,diffMatches:n,focusedSearchResult:i,diffEntryData:D,index:e.index,splitPreference:j.splitPreference,contextLinePathURL:t,recalcTotalHeightOfVirtualWindow:N,headerStickyOffset:-e.start,helpUrl:q.helpUrl,repo:r,oid:F,ignoreWhitespace:A,lineSpacing:C,virtualizerScrollTo:J.scrollToIndex})},a.pathDigest):null})})]}),v.moreDiffsToLoad&&(0,l.jsxs)(l.Fragment,{children:[Q.loading&&(0,l.jsx)(eQ,{}),Q.error&&(0,l.jsx)("div",{style:{justifyContent:"center",paddingTop:"16px"},ref:E,children:(0,l.jsx)(w.A,{variant:"danger",tabIndex:0,children:(0,l.jsx)("div",{className:"d-flex flex-items-center",style:{justifyContent:"center"},children:"There was a problem loading the remainder of the diff."})})})]})]})}function eZ(e,t){for(let n=0;n<t.length;n++)if(e===t[n]?.pathDigest)return n;return -1}function e0(e,t){let n=e.current?.querySelectorAll(`[data-line-anchor=diff-${t}]`);return!!n&&1===n.length&&(n[0].focus(),!0)}try{eJ.displayName||(eJ.displayName="Diffs")}catch{}var e1=n(84217),e2=n(52464),e8=n(76049),e4=n(27756);function e3(e){return 0===((0,d.B)().userNotices??[]).filter(e=>!e.dismissed).filter(t=>t.name===e).length}let e6="compact_diff_lines";function e7(){let e=e3(e6),{dismissNotice:t}=function(e){let t=e3(e);return{dismissNotice:(0,c.useCallback)(()=>{(0,e4.M3)()&&!t&&(0,eN.DI)((0,p.VB)({noticeName:e}),{method:"POST"})},[t,e])}}(e6),{updateLineSpacing:n}=ek(),[i,r]=(0,c.useState)(!0),a=(0,c.useCallback)(()=>{n("compact"),r(!1),t()},[t,n]),s=(0,c.useCallback)(()=>{r(!1),t()},[t]);return e?null:(0,l.jsx)(e8.A,{open:i,caret:"top-right",sx:{top:"60px",right:"-4px"},children:(0,l.jsxs)(e8.A.Content,{className:"d-flex flex-column gap-2",sx:{minWidth:"260px",width:"40%"},children:[(0,l.jsx)(e1.A,{sx:{fontSize:2},as:"h2",children:"Customizable line height"}),(0,l.jsx)("p",{children:"The default line height has been increased for improved accessibility. You can choose to enable a more compact line height from the view settings menu."}),(0,l.jsxs)("div",{className:"d-flex gap-2 flex-row w-full flex-wrap",children:[(0,l.jsx)(B.Q,{onClick:a,sx:{flexShrink:0,flexGrow:1},children:"Enable compact line height"}),(0,l.jsx)(B.Q,{onClick:s,variant:"invisible",sx:{color:"accent.fg",flexGrow:1},alignContent:"center",children:"Dismiss"})]})]})})}try{e7.displayName||(e7.displayName="DiffCompactLinesPopover")}catch{}function e5(){let{hideWhitespace:e,updateHideWhitespace:t,lineSpacing:n,updateLineSpacing:i}=ek();return(0,l.jsxs)(el.l.Group,{selectionVariant:"multiple",variant:"subtle",children:[(0,l.jsx)(el.l.Item,{selected:e,onSelect:()=>t(!e),children:"Hide whitespace"}),(0,l.jsx)(el.l.Item,{selected:"compact"===n,onSelect:()=>{"compact"===n?i("relaxed"):i("compact")},children:"Compact line height"})]})}try{e5.displayName||(e5.displayName="DiffLinePresentationToggles")}catch{}function e9(){let{splitPreference:e,updateSplitPreference:t}=ek();return(0,l.jsxs)(el.l.Group,{selectionVariant:"single",children:[(0,l.jsx)(el.l.GroupHeading,{children:"Layout"}),(0,l.jsx)(el.l.Item,{selected:"unified"===e,onSelect:()=>t("unified"),children:"Unified"}),(0,l.jsx)(el.l.Item,{selected:"split"===e,onSelect:()=>t("split"),children:"Split"})]})}try{e9.displayName||(e9.displayName="DiffViewPreferenceToggle")}catch{}function te(){return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(eV.W,{children:[(0,l.jsx)(eV.W.Anchor,{children:(0,l.jsx)("button",{className:"Button Button--iconOnly Button--invisible ml-2","aria-label":"Diff view settings",children:(0,l.jsx)(N.GearIcon,{})})}),(0,l.jsx)(eV.W.Overlay,{children:(0,l.jsxs)(el.l,{children:[(0,l.jsx)(e9,{}),(0,l.jsx)(el.l.Divider,{}),(0,l.jsx)(e5,{})]})})]}),(0,l.jsx)(e7,{})]})}try{te.displayName||(te.displayName="DiffViewSettings")}catch{}function tt({treeToggleElement:e,headerInfo:t}){let n=(0,c.useRef)(null),i=function(e){let[t,n]=(0,c.useState)(!1),i=(0,c.useCallback)(e=>{let i=e[e.length-1].intersectionRatio<1;i!==t&&n(i)},[t,n]);return(0,c.useEffect)(()=>{let t=e.current,n=new IntersectionObserver(i,{threshold:[1],rootMargin:"-1px 0px 0px 0px"});return e.current&&n.observe(e.current),()=>{t&&n.unobserve(t)}},[e,i]),t}(n),r=i?{display:["none","inherit"]}:{};return(0,l.jsxs)("div",{className:"d-flex flex-items-center flex-justify-between gap-2 pt-3 pt-lg-4 pb-2 position-sticky top-0 color-bg-default",style:{zIndex:2},ref:n,children:[(0,l.jsxs)("div",{className:"d-flex flex-items-center",children:[e,(0,l.jsxs)(e1.A,{as:"h2",className:"mx-2 f4",children:[t.filesChangedString," file",t.filesChanged>1?"s":""," changed"]}),(0,l.jsxs)(eF.C,{sx:r,isAddition:!0,children:["+",t.additions]}),(0,l.jsxs)(eF.C,{sx:r,isAddition:!1,children:["-",t.deletions]}),(0,l.jsx)(e2.A,{sx:{fontSize:0,ml:2,color:"fg.muted",whiteSpace:"nowrap",...r},children:"lines changed"})]}),(0,l.jsxs)("div",{className:"d-flex",children:[i&&(0,l.jsx)(tn,{}),(0,l.jsx)(te,{})]})]})}let tn=()=>(0,l.jsx)(B.Q,{leadingVisual:N.ArrowUpIcon,variant:"invisible",className:"fgColor-default px-2 f6 gap-1",onClick:e=>{e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})},children:"Top"});try{tt.displayName||(tt.displayName="DiffsHeader")}catch{}try{tn.displayName||(tn.displayName="GoToTopButton")}catch{}var ti=n(70170),tr=n(49078),ta=n(42024);let tl="diff_file_tree";function ts({diffs:e,onFileSelected:t,diffsHeader:n,unselectedFileExtensions:i,onFilterTextChange:r,onFileExtensionsChange:a}){let[s,o]=(0,c.useState)(""),{getCommentCountByPath:d}=(0,eO.B)(),u=(0,c.useRef)(null),f=(0,c.useMemo)(()=>new Set(e.map(e=>eA(e.path))),[e]),m=e;i&&i.size>0&&(m=m.filter(e=>!i.has(eA(e.path))));let h=(s?m.filter(e=>e.path.toLowerCase().includes(s.toLowerCase())):m).map(e=>{let t=d(e.path);return{...e,totalCommentsCount:t??0}});return(0,l.jsxs)("div",{className:"d-flex flex-column gap-2",id:tl,children:[(0,l.jsx)("h2",{className:"sr-only",children:"File tree"}),(0,l.jsx)("div",{className:"d-md-none",ref:u,children:n}),(0,l.jsx)(to,{filterText:s,onFilterTextChange:e=>{o(e),r(e)},fileExtensions:f,unselectedFileExtensions:i,onFileExtensionsChange:a}),(0,l.jsx)(tr.oj,{diffs:h,renderPattern:"traditional",onSelect:e=>{t(e,(0,ta.nn)(window.innerWidth)<=ta.Gy.medium?"close_tree":void 0)}})]})}function to({filterText:e,onFilterTextChange:t,fileExtensions:n,unselectedFileExtensions:i,onFileExtensionsChange:r}){let a=(0,c.useRef)((0,ti.s)(e=>t(e),250));return(0,l.jsx)(eE.kF,{filterText:e,fileExtensions:n,unselectedFileExtensions:i,onFilterTextChange:e=>a.current(e),onFilterChange:(e,t)=>{r(e,t.extension)}})}try{ts.displayName||(ts.displayName="FileTree")}catch{}try{to.displayName||(to.displayName="FileFilter")}catch{}function td({diffEntryData:e,contextLinePathURL:t,repo:n,oid:i}){let r=ek(),a=(0,c.useRef)(e),s=(0,eb.X)(),o=(0,d.B)();return(0,l.jsx)("div",{"data-hpc":!0,children:e.map((e,d)=>(0,l.jsx)("div",{className:0===d?"pt-0":"pt-3",children:(0,l.jsx)(eW,{prId:void 0,diffEntryData:a,index:d,helpUrl:s.helpUrl,lineSpacing:r.lineSpacing,splitPreference:r.splitPreference,contextLinePathURL:t,recalcTotalHeightOfVirtualWindow:ey.l,repo:n,ignoreWhitespace:o.ignoreWhitespace,oid:i})},e.pathDigest))})}try{td.displayName||(td.displayName="SSRDiffs")}catch{}var tc=n(15617);async function tu({repo:e,commitOid:t,untilCommentId:n}){let i=await (0,eN.Sr)((0,eM.RD)((0,p.cl)({owner:e.ownerLogin,repo:e.name,commitOid:t,untilCommentId:n})));if(i.ok){let e=await i.json();return(0,eM.Av)(e),e}throw Error("Failed to fetch comment data")}let tf=c.forwardRef(({expanded:e,testid:t,ariaLabel:n,ariaControls:i,onToggleExpanded:r,alignment:a,dataHotkey:s,className:o,tooltipDirection:d},c)=>(0,l.jsx)(V.A,{"aria-label":n,id:`expand-button-${t}`,direction:d,children:(0,l.jsx)(M.K,{unsafeDisableTooltip:!0,ref:c,"data-testid":e?`collapse-${t}`:`expand-${t}`,"aria-labelledby":`expand-button-${t}`,"aria-expanded":e,"aria-controls":i,icon:e?"left"===a?N.SidebarExpandIcon:N.SidebarCollapseIcon:"left"===a?N.SidebarCollapseIcon:N.SidebarExpandIcon,"data-hotkey":s,onClick:e=>{r(e)},variant:"invisible",className:(0,z.$)(o,"fgColor-muted")})}));tf.displayName="ExpandButton";let tm=(0,g.E7)();function th(){(0,j.L)(!0);let e=(0,d.B)(),{splitPagePaneHiddenSx:t,splitPageContentHidden:n,treeToggleElement:i,collapseTree:r}=function(e,t){let n=async function(e,t){if(!t)return;let n=new FormData;n.set("file_tree_visible",e?"true":"false"),(0,eN.DI)((0,p.h6)(t),{method:"PUT",body:n,headers:{Accept:"application/json"}})},[i]=(0,b.I)(()=>!1,!0,[]),r=(0,o.i)(),a=(0,c.useRef)(null),s=(0,c.useRef)(null),[d,u]=(0,c.useState)(t),[f,m]=(0,c.useState)(!1),h=(0,c.useCallback)(()=>{(0,ta.nn)(window.innerWidth)<=ta.Gy.medium?(m(!0),requestAnimationFrame(()=>s.current?.focus())):(u(!0),n(!0,r),requestAnimationFrame(()=>a.current?.focus()))},[r,n]),g=(0,c.useCallback)(()=>{(0,ta.nn)(window.innerWidth)<=ta.Gy.medium?(m(!1),requestAnimationFrame(()=>s.current?.focus())):(u(!1),n(!1,r),requestAnimationFrame(()=>a.current?.focus()))},[r,n]),x=(0,c.useMemo)(()=>(0,l.jsx)(tf,{expanded:d,alignment:"left",ariaLabel:d?"Collapse file tree":"Expand file tree",tooltipDirection:"se",testid:"file-tree-button",ariaControls:e,ref:a,onToggleExpanded:()=>{d?g():h()},className:"d-none d-md-flex position-relative"}),[d,e,g,h]),y=(0,c.useMemo)(()=>(0,l.jsx)(tf,{expanded:f,alignment:"left",ariaLabel:f?"Collapse file tree":"Expand file tree",tooltipDirection:"se",testid:"file-tree-button",ariaControls:e,ref:s,onToggleExpanded:()=>{f?g():h()},className:"d-md-none position-relative"}),[f,e,g,h]),j=(0,c.useMemo)(()=>(0,l.jsxs)(l.Fragment,{children:[y,x]}),[y,x]);return{splitPagePaneHiddenSx:i&&!t?{display:"none"}:{flexDirection:["column","column","inherit"],"@media screen and (max-width: 768px)":f?{mt:-3}:{display:"none"},"@media screen and (min-width: 769px)":d?{height:"100vh",maxHeight:"100vh !important"}:{display:"none"}},splitPageContentHidden:{narrow:f,regular:!1},expandTree:h,collapseTree:g,treeToggleElement:j,treeToggleRef:a}}(tl,e.fileTreeExpanded),[a,u]=(0,c.useState)(new Set),[g]=(0,b.I)(()=>!1,!0,[]),[N,w]=(0,c.useState)(""),[L,S]=(0,c.useState)(""),[D,k]=(0,c.useState)(""),[I,A]=(0,c.useState)(!1),R=(0,c.useCallback)((e,t)=>{(0,m.pk)(`diff-${e.pathDigest}`),w(e.pathDigest),"close_tree"===t&&r()},[r]),T=function(e){let t=(0,s.t)(),[n,i]=(0,c.useState)({branches:[],tags:[],loading:!0});return(0,c.useEffect)(()=>{let n=!1;return(async()=>{i({branches:[],tags:[],loading:!0});let r=await (0,eN.lS)((0,p.jn)({owner:t.ownerLogin,repo:t.name,commitish:e}));if(!n)try{if(r.ok){let e=await r.json();e.loading=!1,e&&i({...e,loading:!1})}else i({branches:[],tags:[],loading:!1})}catch(e){i({branches:[],tags:[],loading:!1})}})(),function(){n=!0}},[t.ownerLogin,t.name,e]),n}(e.commit.oid),F=(0,p.t0)({owner:e.repo.ownerLogin,repo:e.repo.name,commitish:e.commit.oid}),O=(0,c.useCallback)((e,t)=>{let n=new Set(a);"selectFileExtension"===e?n.delete(t):"unselectFileExtension"===e&&n.add(t),u(n)},[a]);(0,c.useEffect)(()=>{u(new Set)},[e.commit]),(0,c.useEffect)(()=>{let e=x.cg?.location.hash;if(e?.indexOf("diff-")!==-1){let t=e?.split("diff-");t&&2===t.length&&w(t[1]??"")}},[]);let P=(0,c.useMemo)(()=>({hideWhitespace:e.ignoreWhitespace,splitPreference:e.splitViewPreference,lineSpacing:e.diffLineSpacingPreference}),[e.diffLineSpacingPreference,e.ignoreWhitespace,e.splitViewPreference]);(0,c.useEffect)(()=>{(x.cg?.scrollY??0)>0&&x.cg?.scrollTo(0,0)},[e.path]);let{deferredCommentData:$,state:M}=function(e,t){let[n,i]=(0,c.useState)(void 0),[r,a]=(0,c.useState)("initial");return(0,c.useEffect)(()=>{let n;i(void 0),a("loading");let r=x.cg?.location.hash;r&&/^#commitcomment-\d+$/.test(r)&&(n=r.replace("#commitcomment-","")),(async()=>{i(await tu({repo:e,commitOid:t,untilCommentId:n})),a("loaded")})()},[t,e]),{deferredCommentData:n,state:r}}(e.repo,e.commit.oid),U=$?.threadMarkers,[B,H]=(0,c.useState)(void 0);(0,c.useEffect)(()=>{if("loaded"===M){let e=x.cg?.location.hash.slice(1);if(e&&$){if(/^commitcomment-\d+$/.test(e))$?.discussionComments.comments.find(t=>t.urlFragment===e)&&x.cg?.requestAnimationFrame(()=>{let t=document.getElementById(e??"");t&&(t.scrollIntoView({block:"center"}),t.focus())});else if(/^r\d+$/.test(e)){let t=e.replace("r","");for(let e of $.threadMarkers)if(e.threads){for(let n of e.threads)if(n.commentsData.comments){for(let e of n.commentsData.comments)if(e&&e.id&&e.id.toString()===t){H(n.id);return}}}}}}},[$,M]);let V=()=>(0,l.jsx)(tt,{treeToggleElement:i,headerInfo:e.headerInfo});if(e.unavailableReason)return(0,l.jsx)(eh,{commit:e.commit,commitInfo:T,unavailableReason:e.unavailableReason});let[z,G]=function(e){let t=e.findIndex(e=>void 0===e.oldOid)-1;return[-2===t?e:e.slice(0,t+1),e.map(e=>({path:e.path,changeType:e.status,pathDigest:e.pathDigest}))]}(e.diffEntryData);return(0,l.jsx)(v.RelayEnvironmentProvider,{environment:tm,children:(0,l.jsxs)(eO.r,{initialFiles:U,initialExpandedThreadId:B,children:[(0,l.jsx)(y.ak,{commands:{"commit-diff-view:create-permalink":()=>{let t=(0,p.$Q)({owner:e.repo.ownerLogin,repo:e.repo.name,commitish:e.commit.oid});window.history.pushState(null,document.title,t)}}}),(0,l.jsxs)(C.O7,{children:[(0,l.jsxs)(C.O7.Header,{children:[(0,l.jsx)(_,{commitBranchState:T,oid:e.commit.oid,repo:e.repo}),(0,l.jsx)(eu,{commit:e.commit,commitInfo:T,repo:e.repo})]}),(0,l.jsx)(C.O7.Pane,{position:"start",sticky:!0,sx:t,divider:{regular:"line",narrow:"none"},widthStorageKey:"diff-tree-pane-width",resizable:!0,children:(0,l.jsx)(ts,{diffs:G,onFileSelected:R,unselectedFileExtensions:a,diffsHeader:(0,l.jsx)(V,{}),onFileExtensionsChange:O,onFilterTextChange:S})}),(0,l.jsx)(C.O7.Content,{as:"div",width:"full",hidden:n,padding:"none",sx:{p:[3,3,3,4],pt:[0,0,0,0]},children:(0,l.jsx)(f.Yj,{children:(0,l.jsxs)(eD,{viewSettings:P,children:[(0,l.jsx)(V,{}),g?(0,l.jsx)(td,{diffEntryData:z,contextLinePathURL:F,repo:e.repo,oid:e.commit.oid}):(0,l.jsx)(f.cP,{searchTerm:D,setSearchTerm:k,children:(0,l.jsx)(eJ,{commitInfo:T,isStickied:I,searchTerm:D,setSearchTerm:k,ignoreWhitespace:e.ignoreWhitespace,diffEntryData:z,contextLinePathURL:F,filterTerm:L,unselectedFileExtensions:a,selectedPathDigest:N,repo:e.repo,oid:e.commit.oid})}),(0,l.jsx)(tc.c,{comments:$?.discussionComments?.comments,commentCount:$?.discussionComments?.count,canLoadMore:$?.discussionComments?.canLoadMore,subscribed:$?.subscribed,providerState:M,repo:e.repo,commitOid:e.commit.oid,children:(0,l.jsx)(E.$,{commit:e.commit,commentInfo:e.commentInfo})}),(0,l.jsx)(h.nq,{})]})})})]})]})})}try{th.displayName||(th.displayName="Commit")}catch{}try{(i=DiffsHeader).displayName||(i.displayName="DiffsHeader")}catch{}function tp({url:e}){return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"text-center",children:(0,l.jsxs)("p",{className:"color-fg-muted f6 mt-4",children:["Seeing something unexpected? Take a look at the",(0,l.jsxs)(U.A,{inline:!0,href:e,children:[" ","GitHub commits guide"]}),"."]})})})}try{tp.displayName||(tp.displayName="CommitHelpMessage")}catch{}let tg=(0,c.createContext)({since:null,until:null,author:null,currentBlobPath:"",pagination:{hasNextPage:!1,hasPreviousPage:!1,endCursor:"",startCursor:""},newPath:null,originalBranch:null});function tx({filters:e,children:t}){return(0,l.jsx)(tg.Provider,{value:e,children:t})}function ty(){return(0,c.useContext)(tg)}try{tg.displayName||(tg.displayName="FilterContext")}catch{}try{tx.displayName||(tx.displayName="FilterProvider")}catch{}var tb=n(29328),tj=n(38553),tC=n(23925),tv=n(20290);function tN(){let e=ty();return e.newPath&&e.originalBranch}function tw(){let e=(0,s.t)(),t=ty();return tN()?(0,l.jsx)(tv.s,{sx:{pt:1,pb:0},children:(0,l.jsxs)("div",{className:"d-flex flex-items-baseline",children:[(0,l.jsx)(tv.s.Heading,{as:"h3",title:`Renamed to ${t.newPath}`,"data-testid":"commit-note-title"}),(0,l.jsx)(er.N,{to:(0,p.Gp)({owner:e.ownerLogin,repo:e.name,ref:t.originalBranch,path:t.newPath}),children:"(Browse History)"})]})}):null}function tL(){let e=(0,tC.ej)();return e?.hasRenameCommits?(0,l.jsx)(tv.s,{children:(0,l.jsxs)("div",{className:"d-flex flex-items-baseline",children:[(0,l.jsx)(tv.s.Heading,{as:"h3",title:`Renamed from ${e?.oldName}`,"data-testid":"commit-note-title"}),(0,l.jsx)(er.N,{to:e?.historyUrl,children:"(Browse History)"})]})}):null}function tS(){let e=(0,tC.ej)();return e?.hasRenameCommits?null:(0,l.jsx)(tv.s,{clipTimeline:"bottom",children:(0,l.jsx)(tv.s.Heading,{as:"h3",title:"End of commit history for this file","data-testid":"commit-note-title"})})}function tD(){let e=ty(),t=(0,tC.xs)();return!e.currentBlobPath||e.currentBlobPath&&e.pagination.hasNextPage?null:(0,l.jsxs)(l.Fragment,{children:[t&&(0,l.jsx)(tv.s,{leadingVisual:(0,l.jsx)(tj.A,{size:"small"})}),!t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(tL,{}),(0,l.jsx)(tS,{})]})]})}try{tw.displayName||(tw.displayName="RenamedToHistory")}catch{}try{tL.displayName||(tL.displayName="RenamedFromHistory")}catch{}try{tS.displayName||(tS.displayName="EndOfFileHistory")}catch{}try{tD.displayName||(tD.displayName="EndOfFile")}catch{}function tk({commitGroups:e,deferredDataUrl:t,softNavToCommit:n}){let i=ty(),r=(0,s.t)(),a=(0,K.wu)(t);return(0,l.jsxs)("div",{className:"mb-3","data-hpc":!0,children:[(0,l.jsx)(e1.A,{as:"h2",className:"sr-only",children:"Commit History"}),(0,l.jsx)(tb.f,{leadingContent:(0,l.jsx)(tw,{}),commitGroups:e,trailingContent:(0,l.jsx)(tD,{}),repository:r,deferredCommitData:a,shouldClipTimeline:function(){let e=tN(),t=ty();return!e&&!t.pagination.hasPreviousPage}(),currentBlobPath:i.currentBlobPath,softNavToCommit:n})]})}try{tk.displayName||(tk.displayName="CommitList")}catch{}var tI=n(58143),t_=n(52876),tE=n(62689),tA=n(84929),tR=n(96912),tT=n(5225);async function tF(e){let t=await (0,eN.lS)(e);return t.ok?await t.json():void 0}let tO=new Map,tP=(0,tT.A)(tF,{cache:tO});function t$(e,t){let n=new URL(x.fV.origin+x.fV.pathname+x.fV.search,x.fV.origin),i=n.searchParams;for(let e of t)i.has(e)&&i.delete(e);for(let[t,n]of Object.entries(e))i.set(t,n.toString());return n.pathname+n.search}var tM=n(6907);let tU=(0,c.lazy)(()=>Promise.resolve().then(n.bind(n,96410)).then(e=>({default:e.DatePicker}))),tB=()=>(0,l.jsx)(L.A,{icon:N.CalendarIcon,className:"fgColor-muted",sx:{my:"2px"}});function tH({repo:e,refInfo:t,path:n,author:i,contributorsUrl:r,since:a,until:o,sx:d={}}){let u=t.name;u===t.currentOid&&(u=(0,W.F)(t.currentOid));let f=(0,ev.Z)(),m=function(e){let t=(0,s.t)(),[n,i]=(0,c.useState)({users:[],error:!1,loading:!0});return(0,c.useEffect)(()=>{let t=!1;return(async()=>{i({users:[],error:!1,loading:!0});let n=await tP(e);if(t)return;let r=[],a=!1;try{n?r=n.authors:a=!0}catch(e){a=!0}i({users:r,error:a,loading:!1})})(),function(){t=!0}},[t,"",e,"all"]),n}(r),h=c.useMemo(()=>{let e=(0,tA.H)(a??""),t=(0,tA.H)(o??"");return(0,tR.f)(e)&&(0,tR.f)(t)?{from:e,to:t}:null},[a,o]),g=n?.split("/");return(0,l.jsxs)(D.A,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",gap:2,...d},children:[n&&(0,l.jsx)("div",{className:"d-flex flex-items-center",children:(0,l.jsxs)("div",{className:"d-flex flex-items-baseline flex-column flex-sm-row",children:[(0,l.jsx)(e1.A,{as:"h2",className:"sr-only",children:"Breadcrumbs"}),(0,l.jsx)("span",{className:"fgColor-default no-wrap",children:"History for"}),(0,l.jsxs)(tE.A,{className:"ml-1",children:[(0,l.jsx)(tE.A.Item,{href:(0,p.Gp)({owner:e.ownerLogin,repo:e.name}),children:e.name}),g.map((n,i,r)=>{let a=(0,p.Gp)({owner:e.ownerLogin,repo:e.name,ref:t.name,path:r.slice(0,i+1).join("/")}),s=i===r.length-1;return(0,l.jsx)(tE.A.Item,{sx:{whiteSpace:"normal",...s?{fontWeight:"bold"}:{}},href:a,selected:s,children:n},a)})]}),(0,l.jsxs)("div",{className:"no-wrap",children:[(0,l.jsx)("span",{className:"mr-2 ml-0 ml-sm-2 fgColor-default",children:"on"}),(0,l.jsx)(Z.A,{href:(0,p.IO)({repo:e,commitish:t.name,action:"tree"}),children:u})]})]})}),!n&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e1.A,{as:"h2",className:"sr-only",children:"Branch selector"}),(0,l.jsx)(tI.PI,{cacheKey:t.listCacheKey,canCreate:!1,hotKey:"w",currentCommitish:t.name,getHref:t=>(0,p.Gp)({owner:e.ownerLogin,repo:e.name,ref:t}),selectedRefType:t.refType,defaultBranch:e.defaultBranch,owner:e.ownerLogin,repo:e.name,idEnding:"commits"})]}),(0,l.jsxs)("div",{className:"d-flex flex-column flex-sm-row gap-2",children:[(0,l.jsx)(e1.A,{as:"h2",className:"sr-only",children:"User selector"}),(0,l.jsx)(t_.T,{defaultText:"All users",width:"medium",usersState:m,showTypedInUser:!0,currentUser:i??void 0,onOpenChange:e=>e,onSelect:e=>{e.login!==i?.login&&f(t$({author:e.login},["author","before","after"]))},renderCustomFooter:()=>(0,l.jsx)(el.l.LinkItem,{href:t$({},["author"]),children:"View commits for all users"})}),(0,l.jsxs)(c.Suspense,{fallback:(0,l.jsx)(B.Q,{leadingVisual:tB,trailingVisual:N.TriangleDownIcon,children:"All time"}),children:[(0,l.jsx)(e1.A,{as:"h2",className:"sr-only",children:"Datepicker"}),(0,l.jsx)(tU,{variant:"range",value:h,maxDate:new Date,minDate:new Date(e.createdAt),showTodayButton:!0,showClearButton:!0,compressedHeader:!0,onChange:e=>{if(!e){f(t$({},["since","until"]));return}let t=function(e){if(e)return{startDate:(0,tM.x)(e.from,{representation:"date"}),endDate:(0,tM.x)(e.to,{representation:"date"})}}(e);if(!t)return;let{startDate:n,endDate:i}=t;f(t$({since:n,until:i},["before","after"]))},placeholder:"All time",anchor:({children:e,...t})=>(0,l.jsx)(B.Q,{...t,"data-testid":"date-picker-commits",leadingVisual:tB,trailingVisual:N.TriangleDownIcon,children:e})})]})]})]})}try{tU.displayName||(tU.displayName="DatePicker")}catch{}try{tB.displayName||(tB.displayName="StyledCalendarIcon")}catch{}try{tH.displayName||(tH.displayName="ListHeader")}catch{}var tV=n(6185);function tz({paginationInfo:e}){let t=e.hasPreviousPage,n=e.hasNextPage,i=e=>e?{"aria-disabled":!0,sx:{backgroundColor:"transparent",border:"none",cursor:"default",color:"primer.fg.disabled",fontWeight:"normal"},onClick:e=>e.preventDefault()}:{};return t||n?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e1.A,{as:"h2",className:"sr-only",children:"Pagination"}),(0,l.jsx)("div",{className:"d-flex flex-justify-center mt-2",children:(0,l.jsxs)(tV.A,{children:[(0,l.jsx)(B.Q,{as:er.N,to:tG(e,!1),className:"fgColor-accent text-normal",...i(!t),tabIndex:0,variant:"invisible","data-testid":"pagination-prev-button",leadingVisual:t?()=>(0,l.jsx)(L.A,{icon:N.ChevronLeftIcon,className:"fgColor-accent"}):null,children:"Previous"}),(0,l.jsx)(B.Q,{as:er.N,to:tG(e,!0),className:"fgColor-accent text-normal",...i(!n),tabIndex:0,variant:"invisible","data-testid":"pagination-next-button",trailingVisual:n?()=>(0,l.jsx)(L.A,{icon:N.ChevronRightIcon,className:"fgColor-accent"}):null,children:"Next"})]})})]}):null}function tG(e,t){return t$(t?{after:e.endCursor}:{before:e.startCursor},[t?"before":"after"])}try{tz.displayName||(tz.displayName="Pagination")}catch{}var tK=n(31881);function tW({children:e,title:t}){return(0,l.jsxs)(tK.M,{rowGap:"none",children:[(0,l.jsx)(tK.M.Header,{divider:"line",sx:{mb:3},children:(0,l.jsx)("div",{className:"d-flex flex-items-center flex-justify-between",children:(0,l.jsx)(e1.A,{as:"h1",className:"f2 text-normal pb-2",id:"commits-pagehead",children:t})})}),(0,l.jsx)(tK.M.Content,{as:"div",children:(0,l.jsx)("div",{children:e})})]})}try{tW.displayName||(tW.displayName="Layout")}catch{}var tq=n(71078);function tX(){let e=(0,s.t)(),t=(0,G.D)(),n=(0,d.B)(),i=n.filters,r=n.commitGroups,a=n.metadata.softNavToCommit,o=`There isn't any commit history to show here${null!==i.since||null!==i.until?" for the selected date range":""}`;return(0,c.useEffect)(()=>{if(!x.fV.hash&&window.scrollY>0){let e=document.querySelector("#commits-pagehead");e?.scrollIntoView()}},[n.filters.pagination,n.filters.since,n.filters.until]),(0,l.jsx)(tx,{filters:n.filters,children:(0,l.jsxs)(tW,{title:"Commits",children:[(0,l.jsx)(tH,{repo:e,contributorsUrl:n.metadata.deferredContributorUrl,since:i.since,until:i.until,author:i.author,refInfo:n.refInfo,path:i.currentBlobPath,sx:{mb:3}}),0===r.length&&(0,l.jsx)(tq.M,{timeoutMessage:n.timedOutMessage,unavailableMessage:o}),r.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(tk,{commitGroups:r,deferredDataUrl:n.metadata.deferredDataUrl,softNavToCommit:a}),(0,l.jsx)(tz,{paginationInfo:i.pagination})]}),n.metadata.showProfileHelp&&(0,l.jsx)(tp,{url:`${t.helpUrl}/articles/troubleshooting-commits-on-your-timeline`})]})})}try{tX.displayName||(tX.displayName="Commits")}catch{}(0,a.Q)("commits",()=>({App:u,routes:[(0,r.a)({path:"/:owner/:repo/commits",Component:tX}),(0,r.a)({path:"/:owner/:repo/commits/:ref",Component:tX}),(0,r.a)({path:"/:owner/:repo/commits/:ref/:path/*",Component:tX}),(0,r.a)({path:"/:owner/:repo/commit/:oid",Component:th}),(0,r.a)({path:"/:owner/:repo/commit/:oid/:path/*",Component:th}),(0,r.a)({path:"/_view_fragments/Voltron::CommitFragmentsController/show/:owner/:repo/:name/repo_layout",Component:th})]}))},87213:(e,t,n)=>{n.d(t,{I:()=>o,d_:()=>d,wu:()=>s});var i=n(20594),r=n(28784),a=n(96540),l=n(23925);function s(e,t){let[n,s]=(0,a.useState)(l.UI);return(0,a.useEffect)(()=>{if(!e)return;let t=!1;return(async()=>{s(l.UI);let n=await (0,r.Sr)((0,i.RD)(e));if(!t)try{if(n.ok){let e=await n.json();e.loading=!1,e&&((0,i.Av)(e),s(e))}else s(l.Xx)}catch(e){s(l.Xx)}})(),function(){t=!0}},[e,t]),n}function o(e){let[t,n]=(0,a.useState)(void 0);return(0,a.useEffect)(()=>{e&&(async()=>{let t=await (0,r.Sr)((0,i.RD)(e));try{if(t.ok){let e=await t.json();e&&((0,i.Av)(e),n(e.data))}}catch(e){}})()},[e]),t}function d(e,t,n,i){let[s,o]=(0,a.useState)(l.UI),d=(0,a.useRef)([...Array(n)]),c=(0,a.useRef)(t);return(0,a.useEffect)(()=>{if(!e)return;let n=!1;async function i(t){let a=await (0,r.Sr)(`${e}?start_entry=${t}`);if(!n)try{if(a.ok){let e=await a.json();if(e){let t=0;for(let n=c.current;n<e.nextIndex;n++)d.current[n]=e.deferredCommits[t],t++;e.deferredCommits=d.current,e.loadMore&&c.current!==e.nextIndex?(c.current=e.nextIndex,o(e),setTimeout(()=>i(e.nextIndex),0)):(c.current===e.nextIndex?e.error=!0:e.error=!1,o(e))}}else o(e=>({...e,loading:!1,error:!0,extraDiffEntries:d.current}))}catch(e){o(e=>({...e,loading:!1,deferredCommits:d.current}))}}return i(t),function(){n=!0}},[e,i,t]),(0,a.useEffect)(()=>{d.current=[],c.current=t},[e,i,t]),s}},48193:(e,t,n)=>{n.d(t,{$S:()=>R,Su:()=>b,uo:()=>y,dE:()=>eO,c7:()=>eT,H1:()=>ek,UA:()=>ew,cT:()=>eM,i4:()=>eD,L4:()=>f});var i=n(74848),r=n(69404),a=n(97156),l=n(75177),s=n(96540);let{getItem:o,removeItem:d,setItem:c}=(0,n(74572).D)("localStorage"),u=(e,t)=>{let{diffSide:n,filePath:i,line:r,subjectId:a}=e;if(t)return`PullRequest:${a}-File:${i}`;if(void 0!==r&&void 0!==n)return`PullRequest:${a}-File:${i}-Line:${r}-DiffSide:${n}`;throw Error("Cannot build diff line comment cache key for a comment without a line number or diff side")};function f({diffSide:e,filePath:t,handlePersistedCommentExists:n,line:i,subjectId:r,threadId:a,fileLevelComment:l}){let f,m;let h=(0,s.useMemo)(()=>a||(a??u({diffSide:e,filePath:t,line:i,subjectId:r},l)),[e,t,i,r,a,l]),{hasPersistedComment:p,removePersistedCommentFromStorage:g}=(f=o(h),m=!!f?.text?.trim(),(0,s.useEffect)(()=>{m&&n?.(f)},[m]),{hasPersistedComment:m,removePersistedCommentFromStorage:()=>{d(h),m=!1,f=null}});return{hasPersistedComment:p,persistCommentToStorage:e=>{let t={text:e.text};e.startLine&&e.startSide&&(t={...t,startLine:e.startLine,startSide:e.startSide}),c(h,t)},removePersistedCommentFromStorage:g}}function m(e,t){for(let n of function e(t,n=[]){if(""===t)return n;let i=t.match(h());if(!i)return n;let r=i.groups.fence;if(!r)return n;let a=r.includes("~")?"~":"`",l=t.match(function(e,t){let n=h([e],t);return RegExp(`${n.source}(?:\r?
)(?<suggestion>.*?)(?:\r?
)^ {0,3}${e}{${t},}[ 	]*$`,"ms")}(a,r.length));if(!l)return n;let s=0,o=i.groups.indent;""!==o&&(s=o.length);let d=l.groups.suggestion;if(s>0){let e=RegExp(`^ {0,${s}}`,"m");d=d.replace(e,"")}return n.push(d),e(t.slice(l.index+l[0].length),n)}(e))if(n===t)return{isValid:!1,errorMessage:"Suggested change cannot be the same as the original line"};return{isValid:!0,errorMessage:""}}function h(e=["`","~"],t){let n=t?`{${t}}`:"{3,}",i=e.map(e=>`${e}${n}`);return RegExp(`^(?<indent> {0,3})(?<fence>${i.join("|")})suggestion[ 	]*$`,"m")}var p=n(41907);let g=(0,s.createContext)(null),x=()=>(0,s.useContext)(g),y=g.Provider;try{g.displayName||(g.displayName="ConversationMarkdownSubjectContext")}catch{}let b=(0,s.forwardRef)(({children:e,...t},n)=>{let r=x();return(0,i.jsx)(p.h,{...t,ref:n,placeholder:"Leave a comment",actions:e,subject:r??void 0,showLabel:!1})});function j({batchPending:e,batchingEnabled:t,commentBoxConfig:n,condensed:o,fileLevelComment:d,filePath:c,focusOnMount:u,isReplying:h,lineNumber:p,onAddComment:g,onCancelComment:x,onPersistedCommentExists:y,quotedText:j="",side:C,subjectId:v,threadId:N,suggestedChangesConfig:w}){let[L,S]=(0,s.useState)(j),[D,k]=(0,s.useState)(!1),[I,_]=(0,s.useState)(),E=(0,s.useRef)(null),A=(0,s.useRef)(null),{persistCommentToStorage:R,removePersistedCommentFromStorage:T}=f({diffSide:C,filePath:c,line:p,subjectId:v,threadId:N,handlePersistedCommentExists:({text:e})=>{e&&(S(e),y?.())},fileLevelComment:!!d});(0,s.useEffect)(()=>{u&&setTimeout(()=>{if(A.current&&(a.XC||a.cg)){let e=A.current,t=e.getBoundingClientRect(),n=a.XC?.documentElement.clientHeight||0;if(!(t.top>=0&&t.bottom<=(a.cg?.innerHeight||n))){let i=t.top,r=a.XC?.documentElement.getBoundingClientRect().top||0,l=e.clientHeight*(2/3);a.cg?.scrollTo({top:i-r-2/3*n+l,behavior:"smooth"})}}E.current?.focus()},100)},[u]);let F=({submitBatch:e})=>{k(!0),_(void 0);let t=m(L,w?.sourceContentFromDiffLines??"");if(!t.isValid){_(t.errorMessage),k(!1);return}g?.({commentText:L,onCompleted(){k(!1),$()},onError(e){k(!1);let t="Failed to save comment";e.message&&(t=`${t}: ${e.message}`),_(t)},submitBatch:e})},O=()=>F({submitBatch:!1}),P=()=>F({submitBatch:!0}),$=()=>{T(),S(""),x?.()},M={footer:{justifyContent:h?"end":"space-between","> div:first-child":{display:o||h?"none":"flex"},...o&&{"> div:last-child":{display:"flex",flexDirection:"column",width:"100%"}}}};return(0,i.jsx)(l.A,{sx:{display:"flex",flexDirection:"column",fieldset:{minWidth:0,width:["100%"]}},children:(0,i.jsxs)(b,{ref:E,label:"Add diff comment",sx:M,value:L,onChange:e=>{_(void 0),R({text:e}),S(e)},onPrimaryAction:t?O:P,userSettings:n,suggestedChangesConfig:w,markdownErrorMessage:I,children:[x&&(0,i.jsx)(r.x,{disabled:D,sx:{py:1,px:2},variant:"default",onClick:$,children:"Cancel"}),!e&&(0,i.jsx)(r.x,{disabled:D||!L.length,sx:{py:1,px:2},variant:t?"default":"primary",onClick:P,ref:A,children:h?"Reply":"Comment"}),t&&(0,i.jsx)(r.x,{disabled:D||!L.length,sx:{py:1,px:2},variant:"primary",onClick:O,children:e?"Add review comment":"Start a review"})]})})}b.displayName="ConversationCommentBox";try{j.displayName||(j.displayName="AddCommentEditor")}catch{}var C=n(71312),v=n(73272),N=n(69676),w=n(82678),L=n(38553),S=n(82560),D=n(67749),k=n(61043),I=n(86079);function _({children:e,footerButtons:t}){let{containerRef:n}=(0,w.G)({bindKeys:N.z0.ArrowHorizontal|N.z0.Tab,focusInStrategy:"closest"});return t?(0,i.jsx)(I.l.Footer,{ref:n,children:(0,i.jsxs)(l.A,{sx:{display:"flex",flexDirection:"column"},children:[(0,i.jsx)(l.A,{sx:{display:"flex",flexDirection:"row",gap:2,justifyContent:"flex-end"},children:(0,i.jsx)(I.l.Buttons,{buttons:t})}),e]})}):null}let E={CHANGE_COMMIT_MESSAGE:"CHANGE_COMMIT_MESSAGE",CHANGE_EXTENDED_DESCRIPTION:"CHANGE_EXTENDED_DESCRIPTION"};function A(e,t){switch(t.type){case E.CHANGE_COMMIT_MESSAGE:return{...e,commitMessage:t.payload};case E.CHANGE_EXTENDED_DESCRIPTION:return{...e,extendedDescription:t.payload};default:return console.error("Unknown suggested change action."),e}}function R({authorLogins:e,batchSize:t,onClose:n,onCommit:r}){let a=(0,v.A)(),{sendAnalyticsEvent:o}=(0,C.s)(),[d,c]=(0,s.useState)(!1),[u,f]=(0,s.useState)(),[m,h]=(0,s.useReducer)(A,{commitMessage:1===e.length?`Apply suggestion from @${e[0]}`:1===new Set(e).size?`Apply suggestions from @${e[0]}`:"Apply suggestions from code review",extendedDescription:""}),p=(0,s.useCallback)((e,t,n)=>{if(!a())return;let i="There was an error trying to commit changes";n?i+=`: ${n}`:i+=".",c(!1),f(i)},[a]),g=(0,s.useCallback)(()=>{a()&&(c(!1),u&&f(void 0))},[u,a]),x=(0,s.useCallback)(()=>{d||(c(!0),o("comments.commit_suggestion","COMMIT_SUGGESTION_DIALOG_BUTTON",{batchSize:t}),r(`${m.commitMessage}

${m.extendedDescription}`,p,g))},[t,m.commitMessage,m.extendedDescription,g,p,d,r,o]);return(0,i.jsxs)(I.l,{title:"Apply suggestion",renderFooter:()=>(0,i.jsx)(_,{footerButtons:[{content:"Cancel",onClick:n},{content:(0,i.jsxs)(l.A,{as:"span",sx:{display:"flex",flexDirection:"row",alignItems:"center"},children:["Commit changes",d&&(0,i.jsx)(L.A,{size:"small",sx:{ml:1}})]}),onClick:x,buttonType:"primary"}],children:u&&(0,i.jsx)(S.A.Validation,{sx:{mt:2,pt:1,justifyContent:"flex-end"},variant:"error",children:u})}),onClose:n,children:[(0,i.jsxs)(S.A,{sx:{mb:2},children:[(0,i.jsx)(S.A.Label,{children:"Commit message"}),(0,i.jsx)(D.A,{block:!0,name:"commit_message",onChange:e=>h({type:E.CHANGE_COMMIT_MESSAGE,payload:e.target.value}),value:m.commitMessage})]}),(0,i.jsxs)(S.A,{children:[(0,i.jsx)(S.A.Label,{children:"Extended description (optional)"}),(0,i.jsx)(k.Ay,{block:!0,rows:3,placeholder:"Add an optional description...",onChange:e=>h({type:E.CHANGE_EXTENDED_DESCRIPTION,payload:e.target.value}),value:m.extendedDescription})]})]})}try{_.displayName||(_.displayName="DialogFooter")}catch{}try{R.displayName||(R.displayName="ApplySuggestionDialog")}catch{}var T=n(67726),F=n(85349),O=n(16255);let P=(0,s.createContext)({});function $({children:e}){let[t,n]=(0,s.useState)(!1),r=(0,s.useMemo)(()=>({isDialogOpen:t,setIsDialogOpen:n}),[t,n]);return(0,i.jsx)(P.Provider,{value:r,children:e})}let M=()=>(0,s.useContext)(P);try{P.displayName||(P.displayName="DialogStateContext")}catch{}try{$.displayName||($.displayName="DialogStateProvider")}catch{}var U=n(38621),B=n(87330),H=n(82667),V=n(22868),z=n(52464),G=n(30631),K=n(55847),W=n(30729),q=n(35993),X=n(83994);let Q={[q.U.Failure]:(0,i.jsx)(W.A,{icon:U.StopIcon,sx:{fill:"danger.fg"}}),[q.U.Warning]:(0,i.jsx)(W.A,{icon:U.AlertIcon,sx:{fill:"attention.fg"}}),[q.U.Notice]:(0,i.jsx)(W.A,{icon:U.InfoIcon,sx:{fill:"fg.muted"}})};function Y({annotation:e,ghostUser:t=H.t.ghostUser}){let n=e.checkSuite.app;return(0,i.jsxs)(l.A,{sx:{borderLeft:"6px solid",borderColor:X.GF[e.annotationLevel].primaryColor,p:4},children:[(0,i.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",mb:2},children:[Q[e.annotationLevel],(0,i.jsx)(z.A,{sx:{fontWeight:600,color:"fg.muted",fontSize:0,pl:2},children:X.GF[e.annotationLevel].ariaLabel})]}),(0,i.jsx)(z.A,{sx:{color:X.GF[e.annotationLevel].primaryColor,fontWeight:600,fontSize:1},children:e.title}),(0,i.jsx)(l.A,{sx:{mb:3,mt:1},children:e.message&&(0,i.jsx)(z.A,{sx:{fontFamily:"var(--fontStack-monospace)",fontSize:0,display:"-webkit-box",overflow:"hidden","-webkit-box-orient":"vertical","-webkit-line-clamp":"8",maxWidth:"unset"},children:e.message})}),(0,i.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,i.jsxs)(l.A,{sx:{flexGrow:2},children:[(0,i.jsx)(V.r,{src:n?.logoUrl??t.avatarUrl,alt:`${n?.name??t.login} avatar image`,"data-testid":"check-suite-app-avatar"}),(0,i.jsxs)(G.A,{sx:{ml:2,maxWidth:"300px"},inline:!0,title:`${e.checkSuite.name} / ${e.checkRun.name}`,children:[(0,i.jsx)(z.A,{sx:{fontWeight:600,fontSize:0},children:e.checkSuite.name})," /"," ",(0,i.jsx)(z.A,{sx:{fontSize:0},children:e.checkRun.name})]})]}),e.checkRun.detailsUrl&&(0,i.jsx)(K.Q,{as:"a",href:e.checkRun.detailsUrl,size:"small",children:"View details"})]})]})}try{Y.displayName||(Y.displayName="Annotation")}catch{}function J({markerId:e,markers:t}){let n=t.findIndex(t=>t.id===e);return(0,i.jsxs)(z.A,{sx:{color:"fg.muted"},children:[(0,i.jsx)(z.A,{sx:{fontWeight:500,color:"fg.default"},children:n+1})," of"," ",(0,i.jsx)(z.A,{sx:{fontWeight:500,color:"fg.default"},children:t.length})]})}function Z({markerId:e,markerNavigationImplementation:t,onNavigate:n}){let{incrementActiveMarker:r,decrementActiveMarker:a,filteredMarkers:s}=t;return s.find(t=>t.id===e)&&s.length>1?(0,i.jsxs)(l.A,{sx:{pr:1,display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,i.jsx)(B.K,{unsafeDisableTooltip:!0,"aria-label":"Load previous marker",icon:U.ChevronLeftIcon,variant:"invisible",onClick:()=>{a(e),n()}}),(0,i.jsx)(B.K,{unsafeDisableTooltip:!0,"aria-label":"Load next marker",icon:U.ChevronRightIcon,variant:"invisible",onClick:()=>{r(e),n()}}),(0,i.jsx)(l.A,{sx:{ml:1},children:(0,i.jsx)(J,{markerId:e,markers:s})})]}):null}try{J.displayName||(J.displayName="MarkerPosition")}catch{}try{Z.displayName||(Z.displayName="GlobalMarkerNavigation")}catch{}function ee({annotation:e,markerNavigationImplementation:t,onClose:n,ghostUser:r}){return(0,i.jsxs)(l.A,{sx:{width:"clamp(240px, 100vw, 540px)"},children:[(0,i.jsx)(l.A,{sx:{borderBottom:"1px solid",borderBottomColor:"border.default",display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center",p:1,background:"canvas.default"},children:(0,i.jsxs)(l.A,{sx:{display:"flex",flexDirection:"row",width:"100%",alignItems:"center"},children:[(0,i.jsx)(Z,{markerId:e.id,markerNavigationImplementation:t,onNavigate:n}),(0,i.jsx)(l.A,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center",justifyContent:"right",flexGrow:1},children:(0,i.jsx)(B.K,{unsafeDisableTooltip:!0,"aria-label":"Close annotation",icon:U.XIcon,variant:"invisible",onClick:n})})]})}),(0,i.jsx)(Y,{annotation:e,ghostUser:r})]})}try{ee.displayName||(ee.displayName="AnnotationDialog")}catch{}var et=n(89323),en=n(16823);function ei({anchorRef:e,annotations:t,handleOpenChange:n,threads:r,onShowAnnotation:a,onShowCommentThread:s,ghostUser:o=H.t.ghostUser}){function d(e){return{display:"-webkit-box",overflow:"hidden","-webkit-box-orient":"vertical","-webkit-line-clamp":e.toString(),maxWidth:"unset"}}return(0,i.jsx)(et.W,{anchorRef:e,open:!0,onOpenChange:n,children:(0,i.jsx)(et.W.Overlay,{width:"small",children:(0,i.jsx)("div",{children:(0,i.jsxs)(en.l,{children:[t.map(e=>(0,i.jsxs)(en.l.Item,{onSelect:()=>a(e.id),children:[(0,i.jsx)(en.l.LeadingVisual,{sx:{mr:2},children:(0,i.jsx)(X.Xh,{annotationLevel:e.annotationLevel},e.id)}),(0,i.jsxs)(l.A,{sx:{...d(2)},children:[e.checkSuite.name," /"," ",(0,i.jsx)(z.A,{sx:{fontWeight:400,color:"fg.muted"},children:e.checkRun.name})]}),(0,i.jsx)(en.l.Description,{variant:"block",children:(0,i.jsx)(l.A,{sx:{...d(1)},children:e.title})}),(0,i.jsx)(en.l.TrailingVisual,{children:(0,i.jsx)(W.A,{icon:U.ArrowRightIcon})})]},e.id)),r.map(e=>(0,i.jsxs)(en.l.Item,{onSelect:()=>s(e.id),children:[(0,i.jsx)(en.l.LeadingVisual,{sx:{mr:2},children:(0,i.jsx)(V.r,{alt:e.author.login,size:20,src:e.author.avatarUrl??o.avatarUrl})}),"Thread by ",e.author.login,(0,i.jsxs)(en.l.Description,{variant:"block",children:[e.commentCount," comment",e.commentCount>1?"s":""]}),(0,i.jsx)(en.l.TrailingVisual,{children:(0,i.jsx)(W.A,{icon:U.ArrowRightIcon})})]},e.id))]})})})})}try{ei.displayName||(ei.displayName="MarkersListActionMenu")}catch{}var er=n(54156),ea=n(3121),el=n(32799),es=n(96711);function eo(e,t="r"){history.replaceState(null,"",`#${t}${e}`)}var ed=n(76919),ec=n(93461),eu=n(34838),ef=n(34306),em=n(22084),eh=n(51012),ep=n(40961);function eg({commentingImplementation:e,suggestedChange:t}){let{sendAnalyticsEvent:n}=(0,C.s)();return(0,i.jsx)(l.A,{sx:{display:"flex",flexDirection:"row-reverse"},children:(0,i.jsx)(K.Q,{variant:"primary",onClick:()=>{n("comments.add_suggested_change_to_batch","ADD_SUGGESTED_CHANGE_TO_BATCH_BUTTON"),e.addSuggestedChangeToPendingBatch(t)},children:"Add suggestion to batch"})})}try{eg.displayName||(eg.displayName="AddToExistingBatch")}catch{}var ex=n(6185);let ey={addSuggestionToBatch:{text:"Add suggestion to batch"},applySuggestion:{text:"Apply suggestion"}};function eb({commentingImplementation:e,onOpenDialog:t,suggestedChange:n}){let{sendAnalyticsEvent:r}=(0,C.s)(),[a,o]=(0,s.useState)(ey.addSuggestionToBatch),[d,c]=(0,s.useState)(!1),u=(0,s.useRef)(null),f=(0,s.useRef)(null),m=()=>c(!d),{addSuggestedChangeToPendingBatch:h}=e,p=(0,s.useCallback)(()=>{a===ey.addSuggestionToBatch&&(h(n),r("comments.add_suggested_change_to_batch","ADD_SUGGESTED_CHANGE_TO_BATCH_BUTTON")),a===ey.applySuggestion&&t(f)},[h,t,a,r,n]);return(0,i.jsx)(l.A,{sx:{display:"flex",flexDirection:"row-reverse"},children:(0,i.jsxs)(ex.A,{children:[(0,i.jsx)(K.Q,{variant:"primary",onClick:p,ref:f,children:a.text}),(0,i.jsx)(B.K,{unsafeDisableTooltip:!0,ref:u,"aria-haspopup":"true","aria-label":"More suggestion batching options",icon:U.TriangleDownIcon,size:"medium",variant:"primary",onClick:m}),(0,i.jsx)(et.W,{anchorRef:u,open:d,onOpenChange:m,children:(0,i.jsx)(et.W.Overlay,{width:"medium",children:(0,i.jsx)(en.l,{selectionVariant:"single",children:Object.keys(ey).map(e=>{let t=ey[e];return(0,i.jsx)(en.l.Item,{selected:a===t,onSelect:()=>o(t),children:t.text},e)})})})})]})})}try{eb.displayName||(eb.displayName="ApplyOrAddToBatch")}catch{}function ej({reason:e,sx:t}){return(0,i.jsx)(l.A,{sx:{m:2,...t},children:(0,i.jsx)(z.A,{as:"small",sx:{color:"fg.muted"},children:e})})}try{ej.displayName||(ej.displayName="CodeSuggestionUnavailable")}catch{}function eC({commentingImplementation:e,onOpenDialog:t,suggestedChange:n}){let r=(0,s.useRef)(null),a=(0,s.useCallback)(()=>{t(r)},[t]),o=e.pendingSuggestedChangesBatch.length,{sendAnalyticsEvent:d}=(0,C.s)();return(0,i.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",flexDirection:"row"},children:[(0,i.jsx)(ea.A,{variant:"attention",sx:{my:"auto"},children:"Pending in batch"}),(0,i.jsxs)(l.A,{sx:{display:"flex",gap:2},children:[(0,i.jsx)(K.Q,{size:"medium",variant:"danger",onClick:()=>{e.removeSuggestedChangeFromPendingBatch(n),d("comments.remove_suggested_change_from_batch","REMOVE_SUGGESTED_CHANGE_FROM_BATCH_BUTTON")},children:"Remove from batch"}),(0,i.jsx)(K.Q,{ref:r,size:"medium",count:o,variant:"primary",onClick:a,children:`Apply suggestion${o>1?"s":""}`})]})]})}try{eC.displayName||(eC.displayName="CommitOrRemoveFromBatch")}catch{}function ev({commentingImplementation:e,suggestedChange:t}){let{setIsDialogOpen:n}=M(),[r,a]=(0,s.useState)(!1),o=(0,s.useRef)(),{pendingSuggestedChangesBatch:d,submitSuggestedChanges:c}=e,u=(0,ed.c0)(t,d),f=0===d.length,{isValid:m,reason:h}=(0,ed.EJ)(t,d),p=(0,s.useMemo)(()=>u?d:[t],[u,d,t]),g=(0,s.useCallback)(e=>{a(e),n?.(e)},[n]),x=(0,s.useCallback)(()=>{if(g(!1),o.current){let e=o.current.current;setTimeout(()=>e?.focus())}},[g]),y=(0,s.useCallback)(e=>{g(!0),o.current=e},[g,o]),b=(0,s.useCallback)((e,t,n)=>{c({suggestedChanges:p,commitMessage:e,onCompleted:()=>{x(),n()},onError:t})},[x,c,p]);return(0,i.jsxs)(l.A,{sx:{p:2,borderTop:"1px solid",borderColor:"border.default"},children:[u&&(0,i.jsx)(eC,{commentingImplementation:e,suggestedChange:t,onOpenDialog:y}),!u&&!m&&h&&(0,i.jsx)(ej,{reason:h,sx:{m:0}}),!u&&f&&(0,i.jsx)(eb,{commentingImplementation:e,suggestedChange:t,onOpenDialog:y}),!u&&m&&!f&&(0,i.jsx)(eg,{commentingImplementation:e,suggestedChange:t}),r&&(0,i.jsx)(R,{authorLogins:p.map(e=>e.authorLogin),batchSize:p.length,onClose:x,onCommit:b})]})}try{ev.displayName||(ev.displayName="CodeSuggestionActions")}catch{}function eN({applySuggestedChangesValidationData:e,comment:t,commentBodyRef:n,commentingImplementation:r,filePath:a,isOutdated:l,isThreadResolved:o,subject:d,suggestedChangesConfig:c,threadId:u,viewerData:f}){let m=function(e,t,n,i,r){let[a,l]=(0,s.useState)();return(0,eh.N)(()=>{if(!e.current||"LINE"!==t.subjectType)return;let a=[...e.current.getElementsByClassName("js-apply-changes")];if(a.length>0){let e=[];for(let l of a){let a=l?.closest("div.js-suggested-changes-blob");if(!a)continue;let s=[...a.querySelectorAll(".js-blob-code-addition")];r.lineRange&&e.push({authorLogin:t.author?.login??"ghost",commentId:t.id,path:n,ref:l,suggestion:s.map(e=>e.textContent),lineRange:r.lineRange,threadId:i})}l(e)}},[r.lineRange,t.author?.login,t.bodyHTML,t.id,t.subjectType,e,n,i]),a}(n,t,a,u,e);return(0,i.jsx)(i.Fragment,{children:m?.length&&m.map(n=>{let{isValid:a,reason:s}=(0,ed.o_)({suggestedChange:n,isOutdated:l,isPending:"PENDING"===t.state,isResolved:o,pullRequestIsClosed:d?.state!=="OPEN",pullRequestIsInMergeQueue:!!d?.isInMergeQueue,userCanApplySuggestion:!!f?.viewerCanApplySuggestion,applySuggestedChangesValidationData:e,suggestedChangesConfig:c});return!a&&s?(0,ep.createPortal)((0,i.jsx)(ej,{reason:s}),n.ref):(0,ep.createPortal)((0,i.jsx)(ev,{commentingImplementation:r,suggestedChange:n}),n.ref)})})}try{eN.displayName||(eN.displayName="SuggestedChangeView")}catch{}function ew({isAnchorable:e=!1,index:t=0,isLastChild:n,isOutdated:r,isThreadResolved:o,anchorPrefix:d="r",comment:c,commentingImplementation:u,filePath:h,hideActions:g,onRefreshThread:x,onQuoteReply:y=T.l,subjectId:j,subject:C,threadCommentCount:v,threadId:N,threadsConnectionId:w,suggestedChangesConfig:L,applySuggestedChangesValidationData:S,viewerData:D,ghostUser:k=H.t.ghostUser}){let{addToast:I}=(0,er.Y6)(),[_,E]=(0,s.useState)(!1),[A,R]=(0,s.useState)(c.isHidden),[F,O]=(0,s.useState)(c.body),[P,$]=(0,s.useState)(!1),[M,U]=(0,s.useState)(),{persistCommentToStorage:B,removePersistedCommentFromStorage:V}=f({subjectId:j,filePath:h,fileLevelComment:"FILE"===c.subjectType,threadId:c.id,handlePersistedCommentExists:({text:e})=>{e&&O(e)}}),{editComment:z,deleteComment:G,hideComment:K,unhideComment:W,lazyFetchReactionGroups:q,lazyFetchEditHistory:X}=u,Q=(0,s.useRef)(null),Y=(0,s.useRef)(null),J=()=>{Q.current?.focus()};(0,s.useEffect)(()=>{_&&setTimeout(J)},[_]);let Z=(0,s.useCallback)(()=>{$(!0);let e=m(F,L?.sourceContentFromDiffLines??"");if(!e.isValid){U(e.errorMessage),$(!1);return}z({text:F,comment:c,onCompleted:()=>{E(!1),$(!1),V(),x?.(N)},onError:()=>{$(!1),I({type:"error",message:"Failed to update comment"})}})},[I,F,c,z,x,V,L,N]),ee=c.currentDiffResourcePath?.split("#r").pop(),et=ee?`${d}${ee}`:void 0,en=et&&a.fV?new URL(`${a.fV.pathname}#${et}`,a.fV.origin).toString():void 0,ei=(0,s.useRef)(null);(0,s.useEffect)(()=>{e&&ee&&et&&window.location.hash.split("#").pop()===et&&(eo(ee,d),ei.current?.focus())},[d,et,ee,e]);let ea={outline:"2px solid",outlineColor:"accent.fg",outlineOffset:"-2px",boxShadow:"none"},el=t>0,es=t>1,ed=u.suggestedChangesEnabled,eh=_?"editing":A?"hidden":"visible";return(0,i.jsxs)(l.A,{ref:ei,id:e?et:void 0,tabIndex:-1,sx:{"&:not(:first-child)":{backgroundColor:"canvas.inset"},"&:first-child + div":{borderTop:"1px solid",borderColor:"border.muted"},":target":ea,":focus":ea,pb:el?0:2},children:[es&&(0,i.jsx)(l.A,{sx:{display:"flex",pl:el?1:0},children:(0,i.jsx)(l.A,{sx:{ml:4,height:8,borderLeft:"1px solid",borderColor:"border.default"}})}),(0,i.jsx)(l.A,{sx:{px:3,pt:es?0:2,pb:0},children:(0,i.jsx)(ec.R,{headingProps:{as:"h5"},avatarUrl:c.author?.avatarUrl??k.avatarUrl,comment:{...c,url:en??"",referenceText:c.reference.text??`#${c.reference.number}`},commentRef:ei,deleteComment:()=>{G({commentId:c.id,onCompleted:()=>{x?.(N)},onError:()=>{$(!1),I({type:"error",message:"Failed to delete comment"})},threadCommentCount:v,threadId:N,threadsConnectionId:w,filePath:h})},editComment:()=>{E(!0)},hideComment:e=>{K({commentId:c.id,reason:e,onCompleted:()=>{x?.(N)},onError:()=>{$(!1),I({type:"error",message:"Failed to hide comment"})}})},onMinimize:R,isMinimized:A,commentAuthorLogin:c.author?.login??k.login,navigate:T.l,commentSubjectAuthorLogin:c.reference?.author?.login??"",commentSubjectType:u.commentSubjectType,onReplySelect:y,unhideComment:()=>{W({commentId:c.id,onCompleted:()=>{x?.(N)},onError:()=>{$(!1),I({type:"error",message:"Failed to unhide comment"})}})},hideActions:g,lazyFetchEditHistory:X,isReply:!0})}),(0,i.jsxs)(l.A,{sx:{display:"flex",pl:el?1:0},children:[el&&(0,i.jsx)(l.A,{sx:{ml:4,mr:1,pl:3,borderLeft:"1px solid",borderColor:"border.default",...n&&{borderImage:"linear-gradient(to bottom, var(--borderColor-default, var(--color-border-default)), rgba(0, 0, 0, 0)) 1 100%"}}}),"editing"===eh&&(0,i.jsx)(l.A,{sx:{pr:2,pl:el?0:2,pb:2,pt:1,flexGrow:1},children:(0,i.jsxs)(b,{ref:Q,label:"Update comment",value:F,onChange:e=>{B({text:e}),O(e),U(void 0)},onPrimaryAction:Z,userSettings:u.commentBoxConfig,suggestedChangesConfig:L,markdownErrorMessage:M,children:[(0,i.jsx)(p.x,{variant:"default",onClick:()=>{E(!1),V(),O(c.body)},children:"Cancel"}),(0,i.jsx)(p.x,{disabled:P||!F.length,variant:"primary",onClick:Z,children:"Update"})]})}),"visible"===eh&&(0,i.jsx)(l.A,{sx:el?{pb:2,pr:2,overflowX:"auto",width:"100%"}:{px:3,pb:2,width:"100%"},children:c.bodyHTML&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(em.oG,{ref:Y,className:"markdown-body","comment-testid":`Comment body html for comment ${c.id}`,html:c.bodyHTML,sx:{mt:1,fontSize:1}}),(0,i.jsx)(l.A,{sx:{display:"flex",flexDirection:"column",mt:3},children:q?(0,i.jsx)(s.Suspense,{fallback:(0,i.jsx)(ef.e,{}),children:(0,i.jsx)(eu.ReactionViewerQueryComponent,{id:c.id})}):(0,i.jsx)(eu.ReactionViewer,{reactionGroups:c,subjectId:c.id})}),ed&&S&&(0,i.jsx)(eN,{comment:c,commentBodyRef:Y,commentingImplementation:u,filePath:h,isOutdated:r,isThreadResolved:o,threadId:N,suggestedChangesConfig:L,applySuggestedChangesValidationData:S,subject:C,viewerData:D})]})})]})]})}try{ew.displayName||(ew.displayName="ReviewThreadComment")}catch{}var eL=n(51888),eS=n(89895);function eD({sx:e,tabSize:t,thread:n,hideHeaderDetails:r,diffTableSx:a}){if(!n.subject?.diffLines||n.subject?.diffLines.length<1)return null;let s=(0,eL.c7)(n.subject.diffLines);return(0,i.jsxs)(l.A,{sx:{m:3,border:0,borderBottomWidth:6,borderStyle:"solid",borderColor:"border.muted",borderBottomLeftRadius:2,borderBottomRightRadius:2,...e},children:[!r&&(0,i.jsx)(l.A,{sx:{borderWidth:1,borderStyle:"solid",borderTopLeftRadius:2,borderTopRightRadius:2,borderColor:"border.muted",color:"fg.muted",px:2,py:1},children:(0,i.jsxs)(z.A,{sx:{fontSize:0,color:"fg.muted"},children:["Line"," ",(0,eS.Ah)({originalStartLine:n.subject.originalStartLine,originalEndLine:n.subject.originalEndLine,startDiffSide:n.subject.startDiffSide,endDiffSide:n.subject.endDiffSide}),", commit ",(0,i.jsx)("code",{children:n.subject.pullRequestCommit?.commit.abbreviatedOid})]})}),(0,i.jsx)(eS.l4,{lineWidth:s,lines:n.subject.diffLines,tabSize:t,sx:a})]})}try{eD.displayName||(eD.displayName="StaticUnifiedDiffPreview")}catch{}function ek({batchingEnabled:e,batchPending:t,commentAnchorPrefix:n,commentingImplementation:r,commentsConnectionId:a,filePath:o,hideDiffPreview:d,onRefreshThread:c,repositoryId:u,subject:f,subjectId:m,tabSize:h,thread:p,threadsConnectionId:g,shouldLimitHeight:x=!0,suggestedChangesConfig:y,viewerData:b,ghostUser:v}){let[N,w]=(0,s.useState)(!1),[L,S]=(0,s.useState)(void 0),{sendAnalyticsEvent:D}=(0,C.s)(),{addThreadReply:k}=r,I=e=>{S(e),w(!0)};if(null===p.commentsData.comments||p.commentsData.comments.length<1)return null;let _=(0,ed.Lm)(p),E="LINE"===p.subjectType?{lineRange:_}:void 0;return(0,i.jsx)("div",{"data-testid":"review-thread",children:(0,i.jsxs)(l.A,{sx:x?{maxHeight:"40vh",overflowY:"auto"}:{},children:[!d&&p.isOutdated&&(0,i.jsx)(eD,{tabSize:h??4,thread:p}),p.commentsData.comments.map((e,t)=>(0,i.jsx)(ew,{isAnchorable:!0,index:t,isLastChild:t===p.commentsData.comments.length-1,anchorPrefix:n,comment:e,commentConnectionId:p.commentsData.__id,commentingImplementation:r,filePath:o,isOutdated:p.isOutdated,repositoryId:u,subject:f,subjectId:m,threadId:p.id,onRefreshThread:c,onQuoteReply:I,threadCommentCount:p.commentsData.comments.length,threadsConnectionId:g,isThreadResolved:!!p.isResolved,suggestedChangesConfig:y,applySuggestedChangesValidationData:E,viewerData:b,ghostUser:v},e.id)),p.viewerCanReply&&(0,i.jsxs)(l.A,{sx:{backgroundColor:"canvas.inset",borderBottomLeftRadius:2,borderBottomRightRadius:2,p:2},children:[N&&(0,i.jsx)(j,{batchingEnabled:e,batchPending:t,commentBoxConfig:r.commentBoxConfig,condensed:!1,fileLevelComment:!0,filePath:o,focusOnMount:!0,isReplying:!0,onCancelComment:()=>{w(!1),D("comments.cancel_thread_reply","CANCEL_REVIEW_THREAD_BUTTON")},repositoryId:u,quotedText:L,subjectId:m,threadId:p.id,onAddComment:({commentText:e,onCompleted:t,onError:n,submitBatch:i})=>{let r=[];p.commentsData.__id&&r.push(p.commentsData.__id),a&&r.push(a),k({commentsConnectionIds:r,filePath:o,thread:p,text:e,submitBatch:i,onCompleted:e=>{e&&eo(e.toString()),t?.(),c?.(p.id)},onError:n,threadsConnectionId:g}),D("comments.add","ADD_COMMENT_BUTTON")},suggestedChangesConfig:y}),!N&&(0,i.jsx)(es.z,{onClick:()=>{D("comments.start_thread_reply","REPLY_TO_THREAD_INPUT_BUTTON"),w(!0)},children:"Write a reply"})]})]})})}try{ek.displayName||(ek.displayName="ReviewThread")}catch{}function eI({children:e}){return(0,i.jsx)(z.A,{sx:{fontWeight:500,color:"fg.default"},children:e})}function e_({thread:e}){return void 0!==e&&e?.diffSide&&e.line?e.startLine&&e.startDiffSide?eA({thread:e}):eE({thread:e}):null}function eE({thread:e}){let t="LEFT"===e.startDiffSide?"L":"R";return(0,i.jsxs)(z.A,{sx:{color:"fg.muted",pl:2},children:["Comment on lines"," ",(0,i.jsxs)(eI,{children:[t,e.line]})]})}function eA({thread:e}){let t="LEFT"===e.startDiffSide?"L":"R",n="LEFT"===e.diffSide?"L":"R";return(0,i.jsxs)(z.A,{sx:{color:"fg.muted",pl:2},children:["Comment on lines"," ",(0,i.jsxs)(eI,{children:[t,e.startLine]})," ","to"," ",(0,i.jsxs)(eI,{children:[n,e.line]})]})}function eR({commentingImplementation:e,filePath:t,onClose:n,onRefreshThread:r,thread:a,threads:o,threadsConnectionId:d,markerNavigationImplementation:c,ghostUser:u,...f}){let{sendAnalyticsEvent:m}=(0,C.s)(),{resolveThread:h,unresolveThread:p,resolvingEnabled:g}=e,x=o.find(e=>e.id===a.id),y=a.commentsData.comments.length>0,b=!!a.isResolved,{addToast:j}=(0,er.Y6)(),v=x?.commentsConnectionId;return y?(0,i.jsxs)(l.A,{sx:{width:"clamp(240px, 100vw, 540px)"},children:[(0,i.jsx)(l.A,{sx:{borderBottom:"1px solid",borderBottomColor:"border.default",display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center",p:1,background:"canvas.default"},children:(0,i.jsxs)(l.A,{sx:{display:"flex",flexDirection:"row",width:"100%",alignItems:"center"},children:[(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Z,{markerId:a.id,markerNavigationImplementation:c,onNavigate:n}),(0,i.jsx)(e_,{thread:x})]}),(0,i.jsxs)(l.A,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center",justifyContent:"right",flexGrow:1},children:[b&&(0,i.jsx)(ea.A,{variant:"done",size:"large",children:"Resolved"}),g&&(0,i.jsx)(el.m,{text:b?"Unresolve conversation":"Resolve conversation",type:"label",direction:"w",id:"resolve-conversation",children:(0,i.jsx)(B.K,{"aria-labelledby":"resolve-conversation",unsafeDisableTooltip:!0,icon:b?U.CheckCircleFillIcon:U.CheckCircleIcon,sx:{color:b?"var(--fgColor-done, var(--color-done-fg)) !important":void 0},variant:"invisible",onClick:b?()=>{p({thread:a,onCompleted:()=>r(a.id),onError:()=>{j({type:"error",message:"Failed to unresolve thread"})}}),m("comments.unresolve_thread","RESOLVE_CONVERSATION_BUTTON")}:()=>{h({thread:a,onCompleted:()=>r(a.id),onError:()=>{j({type:"error",message:"Failed to resolve thread"})}}),m("comments.resolve_thread","RESOLVE_CONVERSATION_BUTTON")}})}),(0,i.jsx)(B.K,{unsafeDisableTooltip:!0,"aria-label":"Close thread",icon:U.XIcon,variant:"invisible",onClick:n})]})]})}),(0,i.jsx)(s.Suspense,{fallback:(0,i.jsxs)(l.A,{sx:{height:"90px",alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center",color:"fg.muted",fontSize:0},children:[(0,i.jsx)(L.A,{}),(0,i.jsx)("p",{children:"Loading comments"})]}),children:(0,i.jsx)(ek,{commentingImplementation:e,commentsConnectionId:v,filePath:t,onRefreshThread:r,thread:a,threadsConnectionId:d,...f,ghostUser:u})})]}):null}try{eI.displayName||(eI.displayName="Emphasis")}catch{}try{e_.displayName||(e_.displayName="ThreadBanner")}catch{}try{eE.displayName||(eE.displayName="SingleLineThreadBanner")}catch{}try{eA.displayName||(eA.displayName="MultineLineThreadBanner")}catch{}try{eR.displayName||(eR.displayName="ReviewThreadDialog")}catch{}function eT(e){return(0,i.jsx)($,{children:(0,i.jsx)(eF,{...e})})}function eF({annotations:e,commentingImplementation:t,conversationAnchorRef:n,conversationListAnchorRef:r,conversationListThreads:a,isMarkerListOpen:o,fileAnchor:d,filePath:c,onAnnotationSelected:u,onCloseConversationDialog:f,onCloseConversationList:m,onThreadSelected:h,returnFocusRef:p,selectedAnnotationId:g,selectedThreadId:x,threadsConnectionId:y,markerNavigationImplementation:b,suggestedChangesConfig:j,ghostUser:C,...v}){let{isDialogOpen:N}=M(),[w,S]=(0,s.useState)(),{fetchThread:D}=t,k=(0,s.useCallback)(()=>!N&&f(),[N,f]),I=async e=>{S(void 0);let t=a.find(t=>t.id===e)?.isOutdated;S(await D(e,t))},_=(0,s.useMemo)(()=>{if(d&&w&&w.subject?.startDiffSide&&w.subject?.endDiffSide&&w.subject?.startLine&&w.subject?.endLine&&j?.configureSuggestedChangesFromLineRange){let e=w.subject?.startLine??w?.subject?.endLine,t=w.subject?.startDiffSide??w?.subject?.endDiffSide,n={diffAnchor:d,endLineNumber:w?.subject?.endLine,endOrientation:w.subject?.endDiffSide==="LEFT"?"left":"right",startLineNumber:e,firstSelectedLineNumber:e,firstSelectedOrientation:"LEFT"===t?"left":"right",startOrientation:"LEFT"===t?"left":"right"};return j?.configureSuggestedChangesFromLineRange(n)}},[d,w,j]);(0,s.useEffect)(()=>{!x&&w?S(void 0):x&&x!==w?.id&&I(x)},[D,x]);let E=x||g,A=g?e.find(e=>e.id===g):void 0;return(0,i.jsx)(i.Fragment,{children:E?(0,i.jsx)(F.T,{align:"end",anchorRef:n,focusZoneSettings:{disabled:!0},open:!0,focusTrapSettings:{disabled:!0},renderAnchor:null,overlayProps:{anchorSide:"outside-right","aria-label":`${x?"Pull Request Review Thread":"Pull Request Check Annotation"}`,id:"conversation-dialog",returnFocusRef:p,role:"dialog",sx:{width:"clamp(240px, 100vw, 540px)",borderRadius:2},onClickOutside:T.l,onKeyDown:e=>{"Escape"!==e.key&&e.stopPropagation()},portalContainerName:b.overlayPortalContainerName},onClose:k,children:w?(0,i.jsx)(eR,{commentingImplementation:t,filePath:c,thread:w,threads:a,threadsConnectionId:y,onClose:k,onThreadSelected:h,onRefreshThread:I,markerNavigationImplementation:b,suggestedChangesConfig:_,ghostUser:C,...v}):A?(0,i.jsx)(ee,{annotation:A,markerNavigationImplementation:b,onClose:k,ghostUser:C}):(0,i.jsxs)(l.A,{sx:{height:"90px",alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center",color:"fg.muted",fontSize:0},children:[(0,i.jsx)(L.A,{}),(0,i.jsx)("p",{children:"Loading comments"})]})}):o&&(0,i.jsx)(ei,{anchorRef:r,annotations:e,handleOpenChange:m,threads:a,onShowCommentThread:h,onShowAnnotation:u,ghostUser:C})})}function eO({id:e}){let t=(0,s.useRef)(null);return(0,s.useEffect)(()=>{t.current&&(0,O.c)(t.current,e)},[e]),(0,i.jsx)("span",{id:e,ref:t,style:{position:"absolute",top:0,right:0,zIndex:10}})}try{eT.displayName||(eT.displayName="Markers")}catch{}try{eF.displayName||(eF.displayName="MarkersInternal")}catch{}try{eO.displayName||(eO.displayName="MarkerPortalRoot")}catch{}var eP=n(84217);function e$({addCommentDialogTitle:e,isLeftSide:t,filePath:n,lineNumber:r,onAddComment:a,onClose:s,viewerData:o,threadsConnectionId:d,...c}){return(0,i.jsxs)(l.A,{sx:{px:2,pb:2,pt:1},children:[(0,i.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)(eP.A,{as:"h4",sx:{fontSize:1,ml:2,py:2},children:[(0,i.jsx)(V.r,{alt:o.login,size:24,src:o.avatarUrl||"",sx:{mr:2}}),(0,i.jsx)("span",{children:e??"Add a comment"})]}),s&&(0,i.jsx)(B.K,{unsafeDisableTooltip:!0,variant:"invisible",icon:U.XIcon,onClick:s,"aria-label":"Cancel"})]}),(0,i.jsx)(j,{focusOnMount:!0,condensed:!1,fileLevelComment:!1,filePath:n,lineNumber:r,onAddComment:({commentText:e,onCompleted:t,onError:i,submitBatch:r})=>{a({text:e,onError:i,onCompleted:(e,n)=>{n&&eo(n.toString()),t?.(e,n)},submitBatch:r,filePath:n,threadsConnectionId:d})},onCancelComment:s,side:t?"LEFT":"RIGHT",...c})]})}try{e$.displayName||(e$.displayName="StartThreadComment")}catch{}function eM({align:e="end",anchorRef:t,isOpen:n,returnFocusRef:r,onCloseCommentDialog:a,suggestedChangesConfig:l,...o}){let{sendAnalyticsEvent:d}=(0,C.s)(),c=(0,s.useMemo)(()=>{if(n&&l?.configureSuggestedChangesFromLineRange)return l.configureSuggestedChangesFromLineRange(l?.selectedDiffRowRange,l?.shouldStartNewConversationWithSuggestedChange)},[n,l]);return n?(0,i.jsx)(F.T,{align:e,anchorRef:t,focusZoneSettings:{disabled:!0},open:n,renderAnchor:null,focusTrapSettings:{disabled:!0},overlayProps:{id:"conversation-dialog",role:"dialog",width:"xlarge",returnFocusRef:r,sx:{borderRadius:2},"aria-label":"Add a comment",onClickOutside:T.l,onKeyDown:e=>{"Escape"!==e.key&&e.stopPropagation()}},onClose:a,children:(0,i.jsx)(e$,{onClose:()=>{a(),d("comments.cancel_thread_reply","CANCEL_REVIEW_THREAD_BUTTON")},suggestedChangesConfig:c,...o})}):null}try{eM.displayName||(eM.displayName="StartConversation")}catch{}T.l,T.l,T.l,T.l,T.l,T.l,T.l,T.l,T.l,T.l,T.l,T.l,T.l,T.l,T.l},76919:(e,t,n)=>{function i(e,t){return t.some(t=>r(t,e))}function r(e,t){return e.commentId===t.commentId&&e.path===t.path&&e.suggestion.length===t.suggestion.length&&a(e.suggestion,t.suggestion)}n.d(t,{EJ:()=>o,Lm:()=>d,c0:()=>i,o_:()=>s,yM:()=>r});let a=(e,t)=>e.length===t.length&&!e.some((e,n)=>e!==t[n]),l={USER_CANNOT_APPLY_SUGGESTION:"You do not have permission to apply this suggestion.",PULL_REQUEST_IS_CLOSED:"This suggestion cannot be applied because the pull request is closed.",PULL_REQUEST_IS_IN_MERGE_QUEUE:"This suggestion cannot be applied because the pull request is queued to merge.",IS_OUTDATED:"This suggestion is outdated and cannot be applied.",IS_PENDING:"This suggestion is part of a pending comment and cannot be applied.",IS_RESOLVED:"This suggestion is part of a resolved comment and cannot be applied.",UNCHANGED_CODE:"This suggestion is invalid because no changes were made to the code.",INVALID_RANGE:"Unable to commit due to other pending changes affecting this line.",BATCH_TOO_BIG:"Unable to commit due to too many changes in the batch.",DELETED_LINES:"Unable to apply suggestions on deleted lines.",RANGE_NOT_PROVIDED:"This suggestion does not have a valid line range.",UNABLE_TO_DETERMINE_VALIDITY:"Unable to determine the validity of this suggestion."};function s({suggestedChange:e,isOutdated:t,isPending:n,isResolved:i,pullRequestIsClosed:r,pullRequestIsInMergeQueue:a,userCanApplySuggestion:s,applySuggestedChangesValidationData:o,suggestedChangesConfig:d}){let{lineRange:c}=o;if(t)return{isValid:!1,reason:l.IS_OUTDATED};if(n)return{isValid:!1,reason:l.IS_PENDING};if(i)return{isValid:!1,reason:l.IS_RESOLVED};if(r)return{isValid:!1,reason:l.PULL_REQUEST_IS_CLOSED};if(a)return{isValid:!1,reason:l.PULL_REQUEST_IS_IN_MERGE_QUEUE};if(!s)return{isValid:!1,reason:l.USER_CANNOT_APPLY_SUGGESTION};if(!c)return{isValid:!1,reason:l.RANGE_NOT_PROVIDED};if(!d)return{isValid:!1,reason:l.UNABLE_TO_DETERMINE_VALIDITY};if(!d?.isValidSuggestionRange)return{isValid:!1,reason:l.DELETED_LINES};let u=d?.sourceContentFromDiffLines,f=e.suggestion.join("\n");return 0!==e.suggestion.length&&f===u?{isValid:!1,reason:l.UNCHANGED_CODE}:{isValid:!0}}function o(e,t){let n={isValid:!1,reason:l.INVALID_RANGE},i={isValid:!1,reason:l.BATCH_TOO_BIG};return t.length>=50?i:t.find(t=>t.threadId===e.threadId)||function(e,t){for(let r of t)if(e.path===r.path){var n,i;return n=e.lineRange,i=r.lineRange,n.endLineNumber>=i.startLineNumber&&n.startLineNumber<=i.endLineNumber}return!1}(e,t)?n:{isValid:!0}}function d(e){if(!e||"LINE"!==e.subjectType||!e.subject)return;let t=e.subject.startDiffSide??e.subject.endDiffSide;if(!t)return;if(e.isOutdated&&e.subject.originalStartLine&&e.subject.originalEndLine)return{endLineNumber:e.subject.originalEndLine,endOrientation:e.subject.endDiffSide||"RIGHT",startLineNumber:e.subject.originalStartLine,startOrientation:t};if(!e.subject.endLine||!e.subject.endDiffSide)return;let n=e.subject.startLine??e?.subject.endLine;return{endLineNumber:e.subject.endLine,endOrientation:e.subject.endDiffSide,startLineNumber:n,startOrientation:t||"RIGHT"}}},35993:(e,t,n)=>{var i;n.d(t,{U:()=>i}),function(e){e.Failure="FAILURE",e.Notice="NOTICE",e.Warning="WARNING"}(i||(i={}))},19255:(e,t,n)=>{n.d(t,{e:()=>i});function i(e){let t=document.querySelector('#__primerPortalRoot__ div[role="dialog"]'),n=document.querySelector(`#${e} div[role="dialog"]`);(t||n)&&document.dispatchEvent(new KeyboardEvent("keydown",{key:"Escape",code:"Escape",ctrlKey:!0}))}},822:(e,t,n)=>{n.d(t,{HS:()=>a,Oc:()=>r,Tv:()=>o,Xr:()=>SymbolChangedEvent,f7:()=>l,fD:()=>s,qR:()=>i});let OpenCopilotChatEvent=class OpenCopilotChatEvent extends Event{constructor(e){super("open-copilot-chat",{bubbles:!1,cancelable:!0}),this.payload=e}};let AddCopilotChatReferenceEvent=class AddCopilotChatReferenceEvent extends Event{constructor(e,t=!1,n){super("add-copilot-chat-reference",{bubbles:!1,cancelable:!0}),this.reference=e,this.openPanel=t,this.id=n}};let SymbolChangedEvent=class SymbolChangedEvent extends Event{constructor(e){super("symbol-changed",{bubbles:!1,cancelable:!0}),this.context=e}};function i(e){window.dispatchEvent(new OpenCopilotChatEvent(e))}function r(e,t=!1,n){window.dispatchEvent(new AddCopilotChatReferenceEvent(e,t,n))}function a(e){return window.addEventListener("open-copilot-chat",e),()=>{window.removeEventListener("open-copilot-chat",e)}}function l(e){return window.addEventListener("add-copilot-chat-reference",e),()=>{window.removeEventListener("add-copilot-chat-reference",e)}}function s(e){return window.addEventListener("search-copilot-chat",e),()=>{window.removeEventListener("search-copilot-chat",e)}}function o(e){return window.addEventListener("symbol-changed",e),()=>{window.removeEventListener("symbol-changed",e)}}},89426:(e,t,n)=>{n.d(t,{C6:()=>a,G7:()=>i,wh:()=>r,xP:()=>l});let i="tree-comparison",r={explain:"explain",conversation:"conversation",suggest:"suggest",askDocs:"ask-docs",discussFileDiff:"discuss-file-diff",explainFileDiff:"explain-file-diff",reviewPr:"review-pull-request"},a=["exception","filtered","contentTooLarge","rateLimit","agentUnauthorized","agentRequest","networkError","multipleAgentsAttempt"],l=["bing-search","codesearch","semanticsearch","lexicalsearch","kb-search","pathsearch","show-symbol-definition","getissue","getprcommits","getcommit","getrelease","getrepo","getdiff","get-diff-by-range","getfile","getfilechanges","getdiscussion","get-actions-job-logs","getpullrequest","getalert","planskill","get-github-data","support-search","kb-repo-search"]},38959:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});let i=function(){var e=[{alias:null,args:null,kind:"ScalarField",name:"oid",storageKey:null},{alias:null,args:null,concreteType:"Repository",kind:"LinkedField",name:"repository",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"databaseId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"owner",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"login",storageKey:null}],storageKey:null}],storageKey:null}];return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useFileDiffReference_Comparison",selections:[{alias:null,args:null,concreteType:"Commit",kind:"LinkedField",name:"oldCommit",plural:!1,selections:e,storageKey:null},{alias:null,args:null,concreteType:"Commit",kind:"LinkedField",name:"newCommit",plural:!1,selections:e,storageKey:null}],type:"PullRequestComparison",abstractKey:null}}();i.hash="fb70959c69497160ff44b9b0c7820e08";let r=i},58231:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});let i=function(){var e={alias:null,args:null,kind:"ScalarField",name:"path",storageKey:null},t=[e,{alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null}];return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useFileDiffReference_DiffEntry",selections:[{alias:null,args:null,kind:"ScalarField",name:"pathDigest",storageKey:null},e,{alias:null,args:null,kind:"ScalarField",name:"rawUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isBinary",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isSubmodule",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isLfsPointer",storageKey:null},{alias:null,args:null,concreteType:"TreeEntry",kind:"LinkedField",name:"oldTreeEntry",plural:!1,selections:t,storageKey:null},{alias:null,args:null,concreteType:"TreeEntry",kind:"LinkedField",name:"newTreeEntry",plural:!1,selections:t,storageKey:null}],type:"PullRequestDiffEntry",abstractKey:null}}();i.hash="f853615ae640634aad832da060f944cf";let r=i},53706:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});let i=function(){var e={defaultValue:null,kind:"LocalArgument",name:"endOid"},t={defaultValue:null,kind:"LocalArgument",name:"pullRequestId"},n={defaultValue:null,kind:"LocalArgument",name:"startOid"},i=[{kind:"Variable",name:"id",variableName:"pullRequestId"}],r=[{kind:"Variable",name:"endOid",variableName:"endOid"},{kind:"Variable",name:"startOid",variableName:"startOid"}],a={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},s=[{alias:null,args:null,kind:"ScalarField",name:"oid",storageKey:null},{alias:null,args:null,concreteType:"Repository",kind:"LinkedField",name:"repository",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"databaseId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"owner",plural:!1,selections:[a,{alias:null,args:null,kind:"ScalarField",name:"login",storageKey:null},l],storageKey:null},l],storageKey:null},l];return{fragment:{argumentDefinitions:[e,t,n],kind:"Fragment",metadata:null,name:"DiffChatWrapper_ComparisonQuery",selections:[{alias:"pullRequest",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:r,concreteType:"PullRequestComparison",kind:"LinkedField",name:"comparison",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"useFileDiffReference_Comparison"}],storageKey:null}],type:"PullRequest",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[t,n,e],kind:"Operation",name:"DiffChatWrapper_ComparisonQuery",selections:[{alias:"pullRequest",args:i,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[a,{kind:"InlineFragment",selections:[{alias:null,args:r,concreteType:"PullRequestComparison",kind:"LinkedField",name:"comparison",plural:!1,selections:[{alias:null,args:null,concreteType:"Commit",kind:"LinkedField",name:"oldCommit",plural:!1,selections:s,storageKey:null},{alias:null,args:null,concreteType:"Commit",kind:"LinkedField",name:"newCommit",plural:!1,selections:s,storageKey:null}],storageKey:null}],type:"PullRequest",abstractKey:null},l],storageKey:null}]},params:{id:"fb6fd29b2f37f48929378e605adb454a",metadata:{},name:"DiffChatWrapper_ComparisonQuery",operationKind:"query",text:null}}}();i.hash="e34cdc5b305060e84f51c908a09989a0";let r=i},71324:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});let i=function(){var e=[{defaultValue:null,kind:"LocalArgument",name:"diffEntryId"}],t=[{kind:"Variable",name:"id",variableName:"diffEntryId"}],n={alias:null,args:null,kind:"ScalarField",name:"path",storageKey:null},i=[n,{alias:null,args:null,kind:"ScalarField",name:"size",storageKey:null}];return{fragment:{argumentDefinitions:e,kind:"Fragment",metadata:null,name:"DiffChatWrapper_DiffEntryQuery",selections:[{alias:"diffEntry",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,kind:"FragmentSpread",name:"useFileDiffReference_DiffEntry"}],type:"PullRequestDiffEntry",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:e,kind:"Operation",name:"DiffChatWrapper_DiffEntryQuery",selections:[{alias:"diffEntry",args:t,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"pathDigest",storageKey:null},n,{alias:null,args:null,kind:"ScalarField",name:"rawUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isBinary",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isSubmodule",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isLfsPointer",storageKey:null},{alias:null,args:null,concreteType:"TreeEntry",kind:"LinkedField",name:"oldTreeEntry",plural:!1,selections:i,storageKey:null},{alias:null,args:null,concreteType:"TreeEntry",kind:"LinkedField",name:"newTreeEntry",plural:!1,selections:i,storageKey:null}],type:"PullRequestDiffEntry",abstractKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:"7c9df64c41ef33594dd0882be84ef373",metadata:{},name:"DiffChatWrapper_DiffEntryQuery",operationKind:"query",text:null}}}();i.hash="064698bd6869b0c7d063a68d0b3666d8";let r=i},45307:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});let i=function(){var e={alias:null,args:null,kind:"ScalarField",name:"isCopilotDotcomChatEnabled",storageKey:null};return{fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DiffChatWrapper_ViewerQuery",selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[e],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"DiffChatWrapper_ViewerQuery",selections:[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"viewer",plural:!1,selections:[e,{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}]},params:{id:"16bed8244ee96ad06b6638dbb86dd0ff",metadata:{},name:"DiffChatWrapper_ViewerQuery",operationKind:"query",text:null}}}();i.hash="4d1f99d4dad28f392f7ea1a3cecbcfff";let r=i},54371:(e,t,n)=>{n.d(t,{Kf:()=>o,hQ:()=>d});var i=n(96540),r=n(18312);let a=n(38959),l=n(58231),s=({oldCommit:e,newCommit:t},{oldTreeEntry:n,newTreeEntry:i,...r},a)=>{if(r.isBinary||r.isSubmodule||r.isLfsPointer||!i||(n?.size??0)>1048576||(i.size??0)>1048576)return;let l=n||!a?t.oid:a;return{type:"file-diff",id:`diff-${r.pathDigest}`,url:r.rawUrl??"",baseFile:n?{type:"file",repoID:e.repository.databaseId??0,repoName:e.repository.name,repoOwner:e.repository.owner.login,path:n.path??"",commitOID:e.oid,url:`${e.repository.url}/raw/${e.oid}/${n.path}`,ref:e.oid}:null,headFile:{type:"file",repoID:t.repository.databaseId??0,repoName:t.repository.name,repoOwner:t.repository.owner.login,path:i.path??"",commitOID:l,url:`${t.repository.url}/raw/${l}/${i.path}`,ref:l},head:null,base:null}},o=(e,t,n)=>{let o=(0,r.useFragment)(a,e),d=(0,r.useFragment)(l,t);return(0,i.useMemo)(()=>s(o,d,n),[o,d,n])},d=(e,t)=>{let n=(0,r.useFragment)(a,e);return(0,i.useMemo)(()=>s(n,t),[n,t])}},30792:(e,t,n)=>{n.d(t,{B:()=>p,C:()=>x});var i=n(74848),r=n(20053),a=n(38621),l=n(34614),s=n(58081),o=n(30729),d=n(32799),c=n(63808),u=n(97394),f=n(47529);let m={"diff-file-header":"DiffFileHeader-module__diff-file-header--TjXyn",collapsed:"DiffFileHeader-module__collapsed--FPwYM","file-name":"DiffFileHeader-module__file-name--mY1O5"};function h({newPath:e,oldPath:t,status:n}){let r=(0,i.jsxs)(i.Fragment,{children:["\u200E",e]}),l=(0,i.jsxs)(i.Fragment,{children:["\u200E",t]});return"RENAMED"===n?(0,i.jsxs)("code",{children:[l," ",(0,i.jsx)(a.ArrowRightIcon,{})," ",r]}):"DELETED"===n||"REMOVED"===n?(0,i.jsx)("code",{children:l}):(0,i.jsx)("code",{children:r})}function p({additionalLeftSideContent:e,areLinesExpanded:t,canExpandOrCollapseLines:n,defaultToRichDiff:p,isCollapsed:g,canToggleRichDiff:x,linesAdded:y,linesChanged:b,linesDeleted:j,fileLinkHref:C,fileLinkRef:v,newMode:N,newPath:w,oldMode:L,oldPath:S,onCopyPath:D,onHeaderClick:k,onToggleDiffDisplay:I,onToggleExpandAllLines:_,onToggleFileCollapsed:E,patchStatus:A,path:R,rightSideContent:T}){return(0,i.jsxs)("div",{className:(0,r.$)(m["diff-file-header"],g?m.collapsed:"","flex-wrap flex-sm-nowrap"),children:[(0,i.jsx)("button",{onClick:E,className:"Button Button--iconOnly Button--invisible flex-shrink-0 flex-order-1","aria-label":g?`expand file: ${R}`:`collapse file: ${R}`,children:g?(0,i.jsx)(a.ChevronRightIcon,{}):(0,i.jsx)(a.ChevronDownIcon,{})}),e,(0,i.jsxs)("div",{className:"d-flex px-1 flex-items-center overflow-hidden flex-order-2 flex-sm-order-1",children:[(0,i.jsx)("h3",{className:(0,r.$)(m["file-name"]),children:(0,i.jsx)(l.A,{className:"Link--primary",href:C,onClick:k,ref:v,children:(0,i.jsx)(h,{newPath:w,oldPath:S,status:A})})}),(0,i.jsx)(f.T,{className:"ml-1 flex-shrink-0",textToCopy:w??S??"",ariaLabel:"Copy file name to clipboard",tooltipProps:{direction:"s",anchorSide:"outside-bottom"},onCopy:D,avoidStyledComponent:!0,hasPortalTooltip:!0}),(0,c._$)(A,L,N)&&(0,i.jsxs)("div",{className:"p-2",children:[(0,i.jsx)("code",{children:L}),(0,i.jsx)(o.A,{icon:a.ArrowRightIcon,sx:{mx:1}}),(0,i.jsx)("code",{children:N})]}),n&&_&&(0,i.jsx)(d.m,{text:t?`collapse non diff lines: ${R}`:`expand all lines: ${R}`,direction:"s",children:(0,i.jsx)("button",{onClick:_,className:`Button Button--iconOnly Button--invisible flex-shrink-0 ${t?"":"js-expand-all-difflines-button"}`,"aria-label":t?`collapse non diff lines: ${R}`:`expand all lines: ${R}`,"data-file-path":R,children:t?(0,i.jsx)(a.FoldIcon,{}):(0,i.jsx)(a.UnfoldIcon,{})})})]}),(0,i.jsxs)("div",{className:"d-flex flex-row flex-justify-end flex-1 flex-order-1 flex-sm-order-2 flex-items-center",children:[(0,i.jsx)("div",{className:"d-flex mr-2 flex-justify-end flex-items-center flex-1",children:(0,i.jsx)(u.z,{linesAdded:y,linesDeleted:j,linesChanged:b,tooltipDirection:"sw"})}),x&&(0,i.jsxs)(s.I,{"aria-label":"File view",size:"small",sx:{mx:2},onChange:I?e=>I(1===e):void 0,children:[(0,i.jsx)(s.I.IconButton,{"aria-label":"Display the source diff",defaultSelected:!p,icon:a.CodeIcon}),(0,i.jsx)(s.I.IconButton,{"aria-label":"Display the rich diff",defaultSelected:p,icon:a.FileIcon})]}),T]})]})}try{h.displayName||(h.displayName="FileName")}catch{}try{p.displayName||(p.displayName="DiffFileHeader")}catch{}var g=n(75177);function x({children:e,isAddition:t,sx:n}){return(0,i.jsx)(g.A,{sx:{color:t?"success.fg":"danger.fg",ml:1,fontWeight:"bold",fontSize:0,...n},children:e})}try{x.displayName||(x.displayName="LinesChangedCounterLabel")}catch{}},63808:(e,t,n)=>{function i(e){return void 0!==e.linesChanged&&0!==e.linesChanged}function r(e,t,n){return"MODIFIED"===e&&t!==n}function a(e){return"COPIED"===e.status&&!i(e)}function l(e){return"RENAMED"===e.status&&!i(e)}function s(e){return!!e.oldTreeEntry&&null===e.newTreeEntry}function o(e){return!!e.truncatedReason}n.d(t,{HI:()=>o,Jc:()=>a,_$:()=>r,dK:()=>l,lO:()=>s,l_:()=>u,s8:()=>m,xW:()=>f});let d=["maximum diff size exceeded.","maximum number of lines exceeded."],c=/^maximum file count exceeded/;function u(e){let t=e;return d.includes(e)?t="Sorry, we could not display the changes to this file because there were too many other changes to display.":c.test(e)&&(t="Sorry, we could not display the changes to this file because there were too many other files to display."),t}function f(e){return!!e.newTreeEntry?.isGenerated}function m(e){return 0===e.linesChanged}},49078:(e,t,n)=>{n.d(t,{oj:()=>_,EB:()=>C,sK:()=>b});var i=n(74848),r=n(38621),a=n(96540),l=n(56511),s=n(68976);function o(e,t,n){if(!t.has(e))throw TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}function d(e,t){var n=o(e,t,"get");return n.get?n.get.call(e):n.value}function c(e,t,n){!function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,n)}function u(e,t,n){var i=o(e,t,"set");return!function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw TypeError("attempted to set read only private field");t.value=n}}(e,i,n),n}function f(e,t){return e<t?-1:e>t?1:0}function m(e,t){return f(e.name,t.name)}function h(e,t){return f(e.fileName,t.fileName)}function p(e){return e.diff}var g=new WeakMap;let FileNode=class FileNode{constructor(e){c(this,g,{writable:!0,value:void 0}),this.diff=e,this.filePath=this.diff.path,u(this,g,this.filePath.split("/")),this.fileName=d(this,g)[d(this,g).length-1],this.directoryParts=d(this,g).slice(0,d(this,g).length-1)}};var x=new WeakMap;let DirectoryNode=class DirectoryNode{getOrCreateDirectory(e){let t=d(this,x).get(e);if(!t){let n=this.path?`${this.path}/`:"";t=new DirectoryNode(e,`${n}${e}`),this.directories.push(t),d(this,x).set(e,t)}return t}sort(){for(let e of(this.directories.sort(m),this.files.sort(h),this.directories))e.sort()}getOrderedDiffs(){let e=this.files.map(p);for(let t of this.directories)e.push(...t.getOrderedDiffs());return e}constructor(e,t){c(this,x,{writable:!0,value:void 0}),this.name=e,this.path=t,this.directories=[],this.files=[],u(this,x,new Map)}};function y(e){let t=new DirectoryNode("","");for(let n of e.map(e=>new FileNode(e))){let e=t;for(let t of n.directoryParts)e=e.getOrCreateDirectory(t);e.files.push(n)}return t.sort(),t}function b(e){return y(e.filter(e=>!!e)).getOrderedDiffs()}var j=n(30729);function C({status:e}){switch(e){case"ADDED":case"COPIED":return(0,i.jsx)(j.A,{size:16,icon:r.FileAddedIcon,className:"fgColor-success"});case"DELETED":case"REMOVED":return(0,i.jsx)(j.A,{size:16,icon:r.FileRemovedIcon,className:"fgColor-danger"});case"RENAMED":return(0,i.jsx)(j.A,{size:16,icon:r.FileMovedIcon,className:"fgColor-attention"});default:return(0,i.jsx)(j.A,{size:16,icon:r.FileIcon,className:"fgColor-muted"})}}try{C.displayName||(C.displayName="FileStatusIcon")}catch{}var v=n(27500),N=n(26750),w=n(76515),L=n(97156);let S=(0,a.memo)(function({file:e,depth:t,hash:n,onSelect:o}){let d=a.useRef(null),c=(0,v.Z)({focusRowRef:d,mouseRowRef:d}),u=(e.diff.totalCommentsCount??0)+(e.diff.totalAnnotationsCount??0),f=(0,a.useCallback)(()=>{d.current?.tabIndex===0&&d.current?.focus()},[d]);return(0,a.useEffect)(()=>{d.current&&e.diff.pathDigest===n&&setTimeout(()=>{let e=L.XC?.getElementById("diff_file_tree")?.parentElement,t=d.current.offsetTop,n=L.cg?.innerHeight??0;e&&(e.scrollTop=t-n/2)},0)},[e.diff.pathDigest,n]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(N.ak,{commands:{"pull-requests-diff-file-tree:focus-file-tree":f}}),(0,i.jsxs)(l.G.Item,{defaultExpanded:!0,"aria-level":t,current:e.diff.pathDigest===n,id:e.diff.path,onSelect:()=>o?.(e.diff),ref:d,children:[(0,i.jsx)(l.G.LeadingVisual,{children:(0,i.jsx)(C,{status:e.diff.changeType})}),e.fileName,c&&(0,i.jsx)(s.m,{"data-testid":`${e.fileName}-item-tooltip`,id:`${e.fileName}-item-tooltip`,contentRef:d,"aria-label":e.fileName,open:!0,direction:"ne"}),!!u&&(0,i.jsxs)("span",{className:"sr-only",children:["has ",u<10?u:"9+"," ",u>1?"comments":"comment"]}),!!u&&(0,i.jsx)(l.G.TrailingVisual,{children:(0,i.jsxs)("div",{className:"d-flex flex-items-center flex-row",children:[(0,i.jsx)(r.CommentIcon,{}),(0,i.jsx)("div",{className:"ml-1 text-bold fgColor-default f6",children:u<10?u:"9+"})]})})]})]})});function D({directory:e,renderPattern:t,depth:n=0,leadingPath:r="",...o}){let d=r?`${r}/`:"",c=a.useRef(null),u=a.useRef(null),f=(0,v.Z)({focusRowRef:u,mouseRowRef:c}),m=(0,a.useCallback)(()=>{u.current?.tabIndex===0&&u.current?.focus()},[u]);if(!e.files.length&&1===e.directories.length)return(0,i.jsx)(i.Fragment,{children:e.directories.map(r=>(0,i.jsx)(D,{depth:0===n?1:n,directory:r,leadingPath:`${d}${e.name}`,renderPattern:t,...o},r.path))});function h(){return"traditional"===t?(0,i.jsx)(k,{directory:e,depth:n,renderPattern:t,...o}):(0,i.jsx)(I,{directory:e,depth:n,renderPattern:t,...o})}return 0===n?h():(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(N.ak,{commands:{"pull-requests-diff-file-tree:focus-file-tree":m}}),(0,i.jsxs)(l.G.Item,{ref:u,defaultExpanded:!0,id:e.path,children:[(0,i.jsx)(l.G.LeadingVisual,{children:(0,i.jsx)(l.G.DirectoryIcon,{})}),(0,i.jsx)("span",{ref:c,children:`${d}${e.name}`}),f&&(0,i.jsx)(s.m,{"data-testid":`${e.name}-directory-item-tooltip`,id:`${e.name}-directory-item-tooltip`,contentRef:u,"aria-label":`${d}${e.name}`,open:!0,direction:"ne"}),(0,i.jsx)(l.G.SubTree,{children:h()})]},e.path)]})}function k({directory:e,renderPattern:t,depth:n=0,...r}){let a=e.files.map(e=>({path:e.filePath,pathType:"file",node:e})).concat(e.directories.map(e=>({path:e.path,pathType:"directory",node:e})));return a.sort((e,t)=>f(e.path,t.path)),(0,i.jsx)(i.Fragment,{children:a.map(e=>"file"===e.pathType?(0,i.jsx)(S,{depth:n+1,file:e.node,...r},e.path):(0,i.jsx)(D,{depth:n+1,directory:e.node,renderPattern:t,...r},e.path))})}function I({directory:e,depth:t=0,...n}){return(0,i.jsxs)(i.Fragment,{children:[e.files.map(e=>(0,i.jsx)(S,{depth:t+1,file:e,...n},e.filePath)),e.directories.map(e=>(0,i.jsx)(D,{depth:t+1,directory:e,...n},e.path))]})}let _=(0,a.memo)(function({diffs:e,renderPattern:t,...n}){let r=y(e),[s,o]=a.useState(""),d=(0,a.useCallback)(()=>{o(((0,w.pd)(L.fV.hash??"")??"").replace("diff-",""))},[o]);return(0,a.useEffect)(()=>(window.addEventListener("hashchange",d),d(),()=>{window.removeEventListener("hashchange",d)}),[d]),(0,i.jsx)(l.G,{"aria-label":"File Tree",children:(0,i.jsx)(D,{directory:r,renderPattern:t,...n,hash:s})})});try{S.displayName||(S.displayName="File")}catch{}try{D.displayName||(D.displayName="Directory")}catch{}try{k.displayName||(k.displayName="TraditionalDirectoryRendering")}catch{}try{I.displayName||(I.displayName="GroupedDirectoryRendering")}catch{}try{_.displayName||(_.displayName="DiffFileTree")}catch{}},37541:(e,t,n)=>{n.d(t,{cP:()=>tD,qj:()=>tN,T5:()=>tx,Uz:()=>tL,Yj:()=>c.Y,N0:()=>tI.N0,Dd:()=>tI.Dd,K_:()=>tk,xB:()=>tF});var i,r=n(74848),a=n(63808),l=n(89895),s=n(51888),o=n(34614),d=n(96540),c=n(50990),u=n(9393),f=n(20053),m=n(55847);let h={gridColumnTemplate:"HiddenDiffPatch-module__gridColumnTemplate--3bEGq"};function p({children:e,helpText:t,helpUrl:n,onLoadDiff:i,diffAnchor:a}){let l=n&&t;return(0,r.jsx)("div",{className:"px-3 py-4 fgColor-muted","data-diff-anchor":a,children:(0,r.jsxs)("div",{className:(0,f.$)(h.gridColumnTemplate),children:[(0,r.jsx)("svg",{"aria-hidden":!0,height:"84",style:{maxWidth:"340px"},viewBox:"0 0 340 84",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{clipPath:"url(#diff-placeholder)",d:"M0 0h340v84H0z",fillRule:"evenodd",style:{fill:"var(--bgColor-muted, var(--color-canvas-subtle))"}})})," ",(0,r.jsxs)("div",{className:"d-flex flex-justify-center flex-column flex-column text-center",children:[(0,r.jsx)(m.Q,{className:"h4 mx-auto fgColor-accent",variant:"invisible",onClick:()=>i(),children:"Load Diff"}),(0,r.jsxs)("span",{className:"fgColor-muted mt-1",children:[e,l&&(0,r.jsx)(o.A,{inline:!0,href:n,children:t})]})]})]})})}try{p.displayName||(p.displayName="HiddenDiffPatch")}catch{}let g={finalLineId:"final-hunk-header-line"};function x(e,t){return e.startBlobLineNumber-t.startBlobLineNumber}function y(e,t){if("HUNK"===e.type&&e.__id===g.finalLineId)return{currentHunk:t[t.length-1],previousHunk:t[t.length-2]};let n=t.sort(x).findIndex(t=>t.startBlobLineNumber<=e.blobLineNumber&&t.endBlobLineNumber>=e.blobLineNumber);return{currentHunk:t[n],nextHunk:t[n+1],previousHunk:t[n-1]}}function b(e){let t=[],n=0;for(let i=1;i<e.length;i++){let r=e[i],a=i===e.length-1;if(r&&!(0,u.Po)(r)){if("HUNK"===r.type){let a;let l=e[n];if(!l||(0,u.Po)(l))continue;let s=i-1;for(;(!a||(0,u.Po)(a))&&(a=e[s],-1!=--s););a&&!(0,u.Po)(a)&&t.push({startBlobLineNumber:l.blobLineNumber,endBlobLineNumber:a.blobLineNumber}),r.__id===g.finalLineId&&t.push({startBlobLineNumber:r.blobLineNumber,endBlobLineNumber:r.blobLineNumber+20}),n=i;continue}if(a){let i=e[n];i&&!(0,u.Po)(i)&&t.push({startBlobLineNumber:i.blobLineNumber,endBlobLineNumber:r.blobLineNumber})}}}return t}var j=n(51012),C=n(58748);let v={overlay:"SelectedDiffLinesOverlay-module__overlay--mWvvK",overlayOpacity:"SelectedDiffLinesOverlay-module__overlayOpacity--B9iKM"};function N({selectedLineRange:e,tableRef:t}){let[n,i]=(0,d.useState)(null),a=(0,d.useCallback)(()=>{if(!t.current)return;let e=t.current.querySelectorAll('td[data-selected="true"]');if(0===e.length){i(null);return}let n=(function(e){let t=e.parentNode;for(;null!==t;){if(t instanceof HTMLElement&&"static"!==getComputedStyle(t).position)return t;t=t.parentNode}return document.body})(t.current).getBoundingClientRect(),r=0,a=Number.MAX_SAFE_INTEGER,l=0,s=Number.MAX_SAFE_INTEGER;for(let t of e){let e=t.getBoundingClientRect();r=Math.max(r,e.bottom-n.top),a=Math.min(a,e.left-n.left),l=Math.max(l,e.right-n.left),s=Math.min(s,e.top-n.top)}i({left:a-1,height:r-s+2,top:s-1,width:l-a+2})},[t]);return((0,j.N)(()=>{a()},[e,t,a]),(0,C.w)(a,t),n)?(0,r.jsx)("div",{className:(0,f.$)("position-absolute","borderColor-accent-emphasis",v.overlay),style:n,children:(0,r.jsx)("div",{className:(0,f.$)("width-full","height-full","bgColor-accent-emphasis",v.overlayOpacity)})}):null}try{N.displayName||(N.displayName="SelectedDiffLinesOverlay")}catch{}let w=(0,d.createContext)(null);function L({children:e,currentHunk:t,diffEntryId:n,diffLine:i,fileAnchor:a,fileLineCount:l,filePath:s,isLeftSide:o,isRowSelected:c,isSplit:u,modifiedLineThreads:f,modifiedLineThreadsConnectionId:m,nextHunk:h,originalLineThreads:p,originalLineThreadsConnectionId:g,previousHunk:x,rowId:y,diffContext:b}){let j=(0,d.useMemo)(()=>({currentHunk:t,diffEntryId:n,diffLine:i,fileAnchor:a,fileLineCount:l,filePath:s,isLeftSide:o,isRowSelected:c,isSplit:u,modifiedLineThreads:f,modifiedLineHasThreads:f&&f.length>0,modifiedLineThreadsConnectionId:m,nextHunk:h,originalLineThreads:p,originalLineHasThreads:p&&p.length>0,originalLineThreadsConnectionId:g,previousHunk:x,rowId:y,diffContext:b}),[t,n,i,a,l,s,o,c,u,f,m,h,p,g,x,y,b]);return(0,r.jsx)(w.Provider,{value:j,children:e})}function S(){let e=(0,d.useContext)(w);if(!e)throw Error("useDiffLineContext must be used within a DiffLineContextProvider");return e}try{w.displayName||(w.displayName="DiffLineContext")}catch{}try{L.displayName||(L.displayName="DiffLineContextProvider")}catch{}function D(e,t){return e?.threads?.flatMap(e=>{let n=e?.id,i=e?.commentsData?.comments?.[0]?.author??t,r=e?.commentsData.totalCount??0,a=e?.commentsData?.__id;return n&&i?[{id:n,author:i,commentCount:r,commentsConnectionId:a,diffSide:e.diffSide,isOutdated:e.isOutdated,line:e.line,startLine:e.startLine,startDiffSide:e.startDiffSide}]:[]})??[]}var k=n(77321),I=n(82678);let GridNavigator=class GridNavigator{moveToNextItem(e,t){let n;let i=this.cellIdToGridLocation.get(this.focusedGridCell?.cellId??"");if(!i)return;let[r]=i,[,a]=i;switch(("ArrowDown"===e||"ArrowUp"===e)&&this.isHunkRow(r)&&this.savedColumnIndex&&(a=this.savedColumnIndex,this.savedColumnIndex=void 0),!0){case t&&"Home"===e:this.focusFirstGridCell();break;case t&&"End"===e:{let e=this.grid.length-1,t=this.grid[e]?.length;t&&(n=this.grid[e]?.[t-1]);break}case"ArrowUp"===e:this.isHunkRow(r-1)?(this.saveColumnIndex(a),n=this.grid[r-1]?.[0]):n=this.grid[r-1]?.[a];break;case"ArrowDown"===e:this.isHunkRow(r+1)?(this.saveColumnIndex(a),n=this.grid[r+1]?.[0]):n=this.grid[r+1]?.[a];break;case"ArrowLeft"===e:n=this.grid[r]?.[a-1];break;case"ArrowRight"===e:n=this.grid[r]?.[a+1];break;case"PageUp"===e:{this.saveColumnIndex(a);let e=this.getPreviousHunkRowIndex(r);n=this.grid[e]?.[0];break}case"PageDown"===e:{this.saveColumnIndex(a);let e=this.getNextHunkRowIndex(r),t=0;e||(e=this.grid.length-1,t=a),n=this.grid[e]?.[t];break}case"Home"===e:n=this.grid[r]?.[0];break;case"End"===e:{let e=this.grid[r];if(e&&!this.isHunkRow(r)){let t=e.length-1;n=this.grid[r]?.[t]}}}return n&&(this.focusedGridCell=n),this.focusedGridCell}reinitializeGrid(e,t){this.initializeGrid(e,t)}focusFirstGridCell(e){e&&this.cellIdToGridLocation.get(e)?this.focusGridCell(e):this.focusedGridCell=this.grid[0]?.[0]}focusGridCell(e){if(this.focusedGridCell?.cellId===e)return;let t=this.cellIdToGridLocation.get(e);if(!t)return;let[n,i]=t;this.focusedGridCell=this.grid[n]?.[i]}getNextSelectableCell(e){let t;let n=this.lastSelectedGridCell||this.focusedGridCell,i=this.cellIdToGridLocation.get(n?.cellId??"");if(!i)return;let[r,a]=i;if(("ArrowUp"!==e||!(r<=1))&&("ArrowDown"!==e||r!==this.grid.length-1)){if("ArrowUp"===e){let e=r-1;for(;!t;)t=this.getNextSelectableCellFromRow({rowIndex:e,columnIndex:a}),e--}if("ArrowDown"===e){let e=r+1;for(;!t;)t=this.getNextSelectableCellFromRow({rowIndex:e,columnIndex:a}),e++}return t&&(this.lastSelectedGridCell=t),t}}getValidSelectableRowCell(){if(this.focusedGridCell?.isHunk)return;if(!this.focusedGridCell?.isEmpty)return this.focusedGridCell;let e=this.cellIdToGridLocation.get(this.focusedGridCell.cellId)?.[0];if(e)return this.focusedGridCell.columnIndex<2?this.grid[e]?.[this.focusedGridCell.columnIndex+2]:this.grid[e]?.[this.focusedGridCell.columnIndex-2]}clearLastSelectedCell(){this.lastSelectedGridCell=void 0}getFirstCodeCell(){let e=this.grid.find(e=>e[0]&&!e[0].isHunk);return e?.find(e=>!e.isEmpty)}getLastCodeCell(){let e=this.grid.slice().reverse().find(e=>e[0]&&!e[0].isHunk);return e?.slice().reverse().find(e=>!e.isEmpty)}hasLine(e,t,n){let i=(0,u.qX)(this.fileAnchor,e,t),r=(0,u.u6)(i,0),a=this.cellIdToGridLocation.get(r);if(!a)return!1;let[l]=a;return!!n===this.isHunkRow(l)}getNextSelectableCellFromRow({rowIndex:e,columnIndex:t}){let n=this.grid[e],i=n?.[t];switch(!0){case i?.isHunk:return;case i?.orientation==="left"&&i.isEmpty:return n?.[t+2];case i?.orientation==="right"&&i.isEmpty:return n?.[t-2];default:return n?.[t]}}getNextHunkRowIndex(e){return Array.from(this.hunkRowIndexes).sort((e,t)=>e-t).find(t=>t>e)}getPreviousHunkRowIndex(e){return Array.from(this.hunkRowIndexes).sort((e,t)=>e-t).reverse().find(t=>t<e)??0}initializeGrid(e,t){this.grid=[],this.cellIdToGridLocation=new Map,this.hunkRowIndexes=new Set;for(let n=0;n<e.length;n++){let i=[],r=e[n];if(void 0!==r){if(this.isSplitDiff){let e=(t||[])[n],a=(0,u.qX)(this.fileAnchor,r,e);(0,u.Po)(r)||"HUNK"!==r.type?this.initializeSplitDiffCodeRow({leftLine:r,rightLine:e,row:i,rowIdentifier:a,rowIndex:n}):this.initializeHunkRow(i,a,n)}else{let e=(0,u.qX)(this.fileAnchor,r,r);(0,u.Po)(r)||"HUNK"!==r.type?this.initializeUnifiedDiffCodeRow({diffLine:r,row:i,rowIdentifier:e,rowIndex:n}):this.initializeHunkRow(i,e,n)}this.grid.push(i)}}}initializeContentCell({cellIndex:e,diffLine:t,orientation:n,row:i,rowIdentifier:r,rowIndex:a}){let l;let s=(0,u.u6)(r,e);(0,u.Po)(t)||"left"!==n||(l=t?.left),(0,u.Po)(t)||"right"!==n||(l=t?.right),i.push({lineNumber:l,orientation:n,isHunk:!1,isEmpty:(0,u.Po)(t),cellId:(0,u.u6)(r,e),columnIndex:e}),this.cellIdToGridLocation.set(s,[a,e])}initializeHunkRow(e,t,n){let i=(0,u.u6)(t,0);e.push({isHunk:!0,isEmpty:!1,cellId:i,columnIndex:0}),this.cellIdToGridLocation.set(i,[n,0]),this.hunkRowIndexes.add(n)}isHunkRow(e){return this.hunkRowIndexes.has(e)}initializeSplitDiffCodeRow({leftLine:e,rightLine:t,row:n,rowIdentifier:i,rowIndex:r}){this.initializeContentCell({cellIndex:0,diffLine:e,orientation:"left",row:n,rowIdentifier:i,rowIndex:r}),this.initializeContentCell({cellIndex:1,diffLine:e,orientation:"left",row:n,rowIdentifier:i,rowIndex:r}),this.initializeContentCell({cellIndex:2,diffLine:t,orientation:"right",row:n,rowIdentifier:i,rowIndex:r}),this.initializeContentCell({cellIndex:3,diffLine:t,orientation:"right",row:n,rowIdentifier:i,rowIndex:r})}initializeUnifiedDiffCodeRow({diffLine:e,row:t,rowIdentifier:n,rowIndex:i}){let r=(0,u.Po)(e)||"DELETION"!==e.type?"right":"left";this.initializeContentCell({cellIndex:0,diffLine:e,orientation:"left",row:t,rowIdentifier:n,rowIndex:i}),this.initializeContentCell({cellIndex:1,diffLine:e,orientation:"right",row:t,rowIdentifier:n,rowIndex:i}),this.initializeContentCell({cellIndex:2,diffLine:e,orientation:r,row:t,rowIdentifier:n,rowIndex:i})}saveColumnIndex(e){this.isHunkRow(e)||(this.savedColumnIndex=e)}constructor(e,t,n,i,r){this.fileAnchor=e,this.isSplitDiff=t,this.grid=[],this.cellIdToGridLocation=new Map,this.hunkRowIndexes=new Set,this.initializeGrid(n,i),this.focusFirstGridCell(r)}};function _(e){e&&setTimeout(()=>{0!==e.tabIndex&&(e.tabIndex=0)})}var E=n(69676);let A={ArrowLeft:E.z0.ArrowHorizontal,ArrowDown:E.z0.ArrowVertical,ArrowUp:E.z0.ArrowVertical,ArrowRight:E.z0.ArrowHorizontal,h:E.z0.HL,j:E.z0.JK,k:E.z0.JK,l:E.z0.HL,a:E.z0.AD,s:E.z0.WS,w:E.z0.WS,d:E.z0.AD,Tab:E.z0.Tab,Home:E.z0.HomeAndEnd,End:E.z0.HomeAndEnd,PageUp:E.z0.PageUpDown,PageDown:E.z0.PageUpDown,Backspace:E.z0.Backspace},R=E.z0.ArrowAll|E.z0.PageUpDown|E.z0.HomeAndEnd|E.z0.AD,T={ghostUser:{displayName:"Ghost",login:"ghost",avatarUrl:"https://avatars.githubusercontent.com/ghost",path:"/ghost",url:"/ghost"}};function F(e){return e in A&&(A[e]&R)>0}function O({clearSelectedDiffRowRange:e,containerRef:t,fileAnchor:n,isSplitDiff:i,leftLines:r,replaceSelectedDiffRowRangeFromGridCells:a,rightLines:l,selectedDiffRowRange:s,updateSelectedDiffRowRange:o}){var c;let f=(0,d.useRef)(),m=(0,d.useMemo)(()=>new GridNavigator(n,i,r,l,f.current?.focusedGridCell?.cellId),[n,i,r,l]);(0,d.useEffect)(()=>{f.current=m},[m]),c=f.current,(0,d.useEffect)(()=>{if(c&&document.activeElement){let e=function(e,t,n){let i=[];for(let r=0;r<t.length;r++){let a=t[r],l=n?.[r]??a,s=!(0,u.Po)(a)&&a?.type==="HUNK";a&&l&&!e.hasLine(a,l,s)&&i.push(a)}return i}(c,r,l);if(0!==e.length){if(document.activeElement===document.body){let t,i,a;let l=r.indexOf(e[e.length-1]),s=r[l+1],o=e[0];s&&!(0,u.Po)(s)&&"HUNK"===s.type&&(t=(0,u.u6)((0,u.qX)(n,s,s),0),i=document.querySelector(`[data-grid-cell-id=${t}]`),a=i?.querySelector("button[data-direction=down], button[data-direction=all]")),a||(t=(0,u.u6)((0,u.qX)(n,o,o),0),i=document.querySelector(`[data-grid-cell-id=${t}]`),a=i?.querySelector("button[data-direction=up], button[data-direction=all]")),t&&i&&(a?a.focus():i.focus(),m.focusGridCell(t),_(i))}else if("BUTTON"===document.activeElement.tagName)_(document.activeElement.closest("td"));else if("TD"===document.activeElement.tagName){let e=document.activeElement.getAttribute("data-grid-cell-id"),n=m.focusedGridCell?.cellId;if(e!==n){let e=t.current?.querySelector(`[data-grid-cell-id=${n}]`);e?.focus()}}}}},[n,r,m,l,c,t]),function(e,t){let n=(0,d.useCallback)(e=>{let n=e.target.getAttribute("data-grid-cell-id");n&&t.focusGridCell(n)},[t]);(0,d.useEffect)(()=>{let t=e.current;return t?.addEventListener("focusin",n),()=>t?.removeEventListener("focusin",n)},[e,n])}(t,m);let h=(0,d.useCallback)((t,i,r)=>{let l=m.getValidSelectableRowCell();switch(!0){case(r.metaKey||r.ctrlKey)&&"KeyA"===r.code:{let e=m.getFirstCodeCell(),t=m.getLastCodeCell();if(!e||!t)return i;return a({diffAnchor:n,focusedGridCell:e,startGridCell:e,endGridCell:t}),i}case r.shiftKey&&"ArrowDown"===r.key:{let e=m.getNextSelectableCell("ArrowDown");if(!e||!l)return i;return s?.firstSelectedLineNumber?o(n,e.lineNumber,e.orientation,!0):a({diffAnchor:n,focusedGridCell:l,startGridCell:l,endGridCell:e}),i}case r.shiftKey&&"ArrowUp"===r.key:{let e=m.getNextSelectableCell("ArrowUp");if(!e||!l)return i;return s?.firstSelectedLineNumber?o(n,e.lineNumber,e.orientation,!0):a({diffAnchor:n,focusedGridCell:l,startGridCell:e,endGridCell:l}),i}default:{let t=m.moveToNextItem(r.key,r.ctrlKey),n=t&&document.querySelector(`[data-grid-cell-id=${t.cellId}]`);return e(),m.clearLastSelectedCell(),n??void 0}}},[m,s,o,n,a,e]);return(0,I.G)({containerRef:t,bindKeys:R,getNextFocusable:h,focusableElementFilter:e=>"BUTTON"!==e.tagName,focusInStrategy:"previous"},[h]),{gridNavigator:m}}var P=n(6024),$=n(48193),M=n(47529),U=n(22084),B=n(26750),H=n(83296),V=n(38621);let z=(0,d.createContext)(null);function G({children:e,...t}){let n=!!t.commentingImplementation,i=!!t.markerNavigationImplementation;if(t.commentingEnabled!==n&&t.commentingEnabled!==i)throw Error("commentingEnabled, commentingImplementation, and markerNavigationImplementation must be passed together");let a=t?.ghostUser??T.ghostUser,l=(0,d.useMemo)(()=>({ghostUser:a,...t}),[...Object.values(t),a]);return(0,r.jsx)(z.Provider,{value:l,children:e})}function K(){let e=(0,d.useContext)(z);if(!e)throw Error("useDiffContext must be used within a DiffContextProvider");return e}try{z.displayName||(z.displayName="DiffContext")}catch{}try{G.displayName||(G.displayName="DiffContextProvider")}catch{}var W=n(19255);function q(e){return null!=e}let X="thread",Q="annotation",Y=(0,d.createContext)(null);function J({children:e,line:t}){let[n,i]=(0,d.useState)(!1),[a,l]=(0,d.useState)(),[s,o]=(0,d.useState)(),[c,u]=(0,d.useState)(),[f,m]=(0,d.useState)(),[h,p]=(0,d.useState)(),{ghostUser:g,markerNavigationImplementation:x}=K(),{originalLineThreads:y,modifiedLineThreads:b,originalLineThreadsConnectionId:j,modifiedLineThreadsConnectionId:C}=S(),[v,N]=(0,d.useState)(),{threads:w,threadConnectionId:L}=ee({line:t,side:v,originalLineThreads:y,modifiedLineThreads:b,originalLineThreadsConnectionId:j,modifiedLineThreadsConnectionId:C,ghostUser:g}),D=(0,d.useMemo)(()=>!!a||!!s||!!c||!!f,[a,c,s,f]),k=(0,d.useCallback)(()=>{i(!0)},[]),I=(0,d.useCallback)(()=>{i(!1)},[]),_=(0,d.useCallback)(e=>{e?p({id:e,kind:X}):p(void 0)},[]),E=h?.kind===X?h.id:void 0,A=h?.kind===Q?h.id:void 0,R=(0,d.useCallback)(e=>{e?p({id:e,kind:Q}):p(void 0)},[]),T=(0,d.useCallback)((e,t,n)=>{switch((0,W.e)(x?.overlayPortalContainerName),e){case"context-menu":l(t),m(void 0),u(void 0),o(void 0);break;case"new-conversation":m({cellId:t,withSuggestedChange:n?.withSuggestedChange}),l(void 0),u(void 0),o(void 0);break;case"marker-details":u(t),l(void 0),o(void 0),m(void 0);break;case"marker-list":o(t),l(void 0),m(void 0),u(void 0)}},[x?.overlayPortalContainerName]),F=(0,d.useCallback)(e=>{switch(e){case"context-menu":l(void 0);break;case"new-conversation":m(void 0);break;case"marker-details":u(void 0);break;case"marker-list":o(void 0)}},[]),O=(0,d.useCallback)(e=>(N(e),ee({line:t,side:e,modifiedLineThreads:b,modifiedLineThreadsConnectionId:C,originalLineThreads:y,originalLineThreadsConnectionId:j,ghostUser:g}).threads),[t,b,C,y,j,g]),P=(0,d.useMemo)(()=>t.annotationsData?.annotations?.filter(q)??[],[t.annotationsData?.annotations]),$=(0,d.useMemo)(()=>({annotations:P,isActionBarVisible:n,showActionBar:k,hideActionBar:I,selectThreadId:_,selectAnnotationId:R,closeDialog:F,openDialog:T,anyMenuOpen:D,selectedThreadId:E,selectedAnnotationId:A,openContextMenuCell:a,openMarkersListCell:s,openMarkerDetailsCell:c,openNewConversationCell:f,threads:w,updateVisibleThreads:O,threadConnectionId:L}),[P,n,k,I,_,R,F,T,D,E,A,a,s,c,f,w,L,O]);return(0,r.jsx)(Y.Provider,{value:$,children:e})}function Z(){let e=(0,d.useContext)(Y);if(!e)throw Error("useMarkersDialogContext must be used within a MarkersDialogContextProvider");return e}function ee({line:e,side:t,originalLineThreads:n,modifiedLineThreads:i,originalLineThreadsConnectionId:r,modifiedLineThreadsConnectionId:a,ghostUser:l}){switch(t){case"LEFT":return{threads:n||[],threadConnectionId:r};case"RIGHT":return{threads:i||[],threadConnectionId:a};case void 0:return{threads:D(e.threadsData,l),threadConnectionId:e.threadsData?.__id};default:return{threads:[],threadConnectionId:void 0}}}try{Y.displayName||(Y.displayName="MarkersDialogContext")}catch{}try{J.displayName||(J.displayName="MarkersDialogContextProvider")}catch{}var et=n(30841),en=n(71312);function ei({cellId:e,actionBarRef:t}){let{replaceSelectedDiffRowRange:n}=(0,c.o)(),{fileAnchor:i}=S(),[r,a]=(0,d.useState)(t),{annotations:l,openDialog:s,closeDialog:o,selectedAnnotationId:u,selectAnnotationId:f,selectedThreadId:m,selectThreadId:h,openContextMenuCell:p,openNewConversationCell:g,openMarkerDetailsCell:x,openMarkersListCell:y,updateVisibleThreads:b,threads:j,threadConnectionId:C,anyMenuOpen:v}=Z(),{sendAnalyticsEvent:N}=(0,en.s)(),w=(0,d.useMemo)(()=>g?.cellId===e,[e,g]),L=(0,d.useMemo)(()=>g?.withSuggestedChange,[g]),D=(0,d.useCallback)(t=>{s("new-conversation",e,t)},[e,s]),k=(0,d.useCallback)(()=>{D()},[D]),I=(0,d.useCallback)(()=>{a(t),D(),N("diff.start_new_conversation","PLUS_ICON")},[t,D,N]),_=(0,d.useCallback)(()=>{D({withSuggestedChange:!0}),N("diff.start_new_conversation_with_suggested_change","CELL_CONTEXT_MENU")},[D,N]),E=(0,d.useCallback)(()=>{a(t),D({withSuggestedChange:!0}),N("diff.start_new_conversation_with_suggested_change","ACTION_BAR_CONTEXT_MENU")},[t,D,N]),A=(0,d.useCallback)(()=>{o("new-conversation")},[o]),R=(0,d.useMemo)(()=>p===e,[e,p]),T=(0,d.useCallback)(()=>{s("context-menu",e)},[e,s]),F=(0,d.useCallback)(()=>{a(t),T()},[t,T]),O=(0,d.useCallback)(()=>{o("context-menu")},[o]),P=(0,d.useCallback)(()=>{R?O():T()},[O,R,T]),$=(0,d.useCallback)(()=>{a(t),P()},[t,P]),M=(0,d.useMemo)(()=>x===e?m:void 0,[e,x,m]),U=(0,d.useMemo)(()=>x===e?u:void 0,[e,x,u]),B=(0,d.useCallback)(()=>{s("marker-details",e)},[e,s]),H=(0,d.useCallback)(()=>{o("marker-details")},[o]),V=(0,et.K)((e,t={skipLineSelection:!1})=>{if(h(e),B(),t.skipLineSelection)return;let r=j.find(t=>t.id===e);if(r&&r.diffSide&&r.line){let e=r.startLine??r.line,t=r.startDiffSide??r.diffSide;n({diffAnchor:i,endLineNumber:r.line,endOrientation:"LEFT"===r.diffSide?"left":"right",startLineNumber:e,startOrientation:"LEFT"===t?"left":"right",firstSelectedLineNumber:e,firstSelectedOrientation:"LEFT"===t?"left":"right"})}}),z=(0,et.K)((e,t={skipLineSelection:!1})=>{if(f(e),B(),t.skipLineSelection)return;let r=l.find(t=>t.id===e);r&&n({diffAnchor:i,endLineNumber:r.location.end.line,endOrientation:"right",startLineNumber:r.location.start.line,startOrientation:"right",firstSelectedLineNumber:r.location.start.line,firstSelectedOrientation:"right"})}),G=(0,d.useCallback)(()=>{s("marker-list",e)},[e,s]),K=(0,d.useCallback)(()=>{o("marker-list")},[o]),W=(0,d.useCallback)(e=>{let t=b(e);if(!t?.length&&!l.length)return;let n=t&&t[0],i=t&&1===t.length&&n&&!l.length,r=l[0],a=1===l.length&&r&&!t?.length;i?V(n.id):a?z(r.id):G()},[l,G,z,V,b]);return{isNewConversationDialogOpen:w,startNewConversation:k,startNewConversationFromActionBar:I,closeNewConversationDialog:A,startNewConversationWithSuggestedChange:_,startNewConversationFromActionBarWithSuggestedChange:E,shouldStartNewConversationWithSuggestedChange:L,isContextMenuOpen:R,openContextMenu:T,openContextMenuFromActionBar:F,closeContextMenu:O,toggleContextMenu:P,toggleContextMenuFromActionBar:$,optimizedSelectedThreadId:M,optimizedSelectedAnnotationId:U,selectThread:V,selectAnnotation:z,openMarkerDetailsDialog:B,closeConversationDetailsDialog:H,isMarkerListDialogOpen:y===e,openMarkerListDialog:G,closeMarkerListDialog:K,openMarkerOrListDialogFromActionBar:(0,d.useCallback)(e=>{W(e),a(t)},[t,W]),openMarkerOrListDialog:(0,d.useCallback)(e=>{W(e)},[W]),annotations:l,returnFocusRef:r,threadConnectionId:C,threads:j,anyMenuOpen:v}}function er({cellRef:e}){let{showActionBar:t,hideActionBar:n,anyMenuOpen:i}=Z(),[r,a]=(0,d.useState)(!1),l=(0,d.useCallback)(()=>{t()},[t]),s=(0,d.useCallback)(t=>{!i&&(e.current&&e.current.contains(t.relatedTarget)||n())},[i,e,n]),o=(0,d.useCallback)(()=>{t()},[t]),c=(0,d.useCallback)(()=>{!i&&(e.current===document.activeElement||e.current?.contains(document.activeElement)||n())},[i,e,n]);return{isActionBarFocused:r,handleCellBlur:s,handleCellFocus:l,handleCellMouseEnter:o,handleCellMouseLeave:c,handleActionBarBlur:(0,d.useCallback)(t=>{e.current&&!i&&(e.current.contains(t.relatedTarget)?e.current===t.relatedTarget&&a(!1):(n(),a(!1)))},[i,e,n]),handleActionBarFocusCapture:(0,d.useCallback)(e=>{i||(e.stopPropagation(),a(!0))},[i]),handleActionBarKeydownCapture:(0,d.useCallback)(e=>{!i&&F(e.key)&&e.stopPropagation()},[i])}}function ea(){let{nextHunk:e,currentHunk:t,previousHunk:n}=S(),{addInjectedContextLines:i}=K(),r=!!t&&0!==t.startBlobLineNumber,a=!!t&&!!e;return{expandStartOfHunk:()=>{r&&t&&i({start:Math.max(0,t.startBlobLineNumber-20),end:t.startBlobLineNumber})},expandEndOfHunk:()=>{a&&t&&i({start:t.endBlobLineNumber+1,end:t.endBlobLineNumber+1+20})},expandEndOfPreviousHunk:()=>{n&&i({start:n.endBlobLineNumber+1,end:n.endBlobLineNumber+1+20})},canExpandEndOfHunk:a,canExpandStartOfHunk:r}}var el=n(52019),es=n(64515),eo=n(6185),ed=n(87330),ec=n(89323),eu=n(16823),ef=n(22868),em=n(90305),eh=n(52464),ep=n(83994);let eg={commentIndicatorContainer:"CommentIndicator-module__commentIndicatorContainer--L8lU3"},ex={compact:{avatarSize:18,maxWidth:"32px"},relaxed:{avatarSize:20,maxWidth:"40px"}};function ey({shouldAnimateRef:e,lineSpacingPreference:t="relaxed"}){let{diffLine:n}=S(),{ghostUser:i}=K();(0,d.useEffect)(()=>{e?.current&&(e.current=!1)},[e]);let{avatarSize:a,maxWidth:l}=ex[t],s=(n.threadsData?.totalCommentsCount||0)+(n.annotationsData?.totalCount||0);if(0===s)return null;let o={},c=[];n.annotationsData?.annotations?.map(e=>{e?.annotationLevel&&c.push({id:e.id,level:e.annotationLevel})}),n.threadsData?.threads?.map(e=>e?.commentsData?.comments?.map(e=>{e?.author?o[e?.author.login]=e.author:i?.login&&(o[i.login]=i)}));let u=[...c.sort((e,t)=>(ep.GF[e.level]?.priority||0)<(ep.GF[t.level]?.priority||0)?-1:1).map(t=>e?.current?(0,r.jsx)(ep.S,{annotationLevel:t.level},t.id):(0,r.jsx)(ep.Xh,{annotationLevel:t.level},t.id)),...Object.keys(o).map(e=>{let t=o[e]?.login,n=o[e]?.avatarUrl??(i?.avatarUrl||" ");return(0,r.jsx)(ef.r,{alt:t,size:20,src:n},t)})].slice(0,3),m=s>9?"9+":`${s}`;return(0,r.jsxs)("div",{className:(0,f.$)("d-flex","flex-justify-between","flex-items-center",eg.commentIndicatorContainer),children:[(0,r.jsx)(em.A,{disableExpand:!0,size:a,sx:{maxWidth:l,"--avatar-stack-three-plus-min-width":"32px"},children:u}),(0,r.jsx)(eh.A,{sx:{color:"fg.default",ml:1,fontSize:0,fontWeight:400,fontVariantNumeric:"tabular-nums",width:"2ch",textAlign:"start"},children:m})]})}try{ey.displayName||(ey.displayName="CommentIndicator")}catch{}var eb=n(38553),ej=n(78017),eC=n(23246),ev=n(39037),eN=n(79476);let ew=({selectedRange:e,showDivider:t,...n})=>(0,r.jsx)(eN.B,{errorFallback:(0,r.jsx)(eL,{}),suspenseFallback:(0,r.jsx)(eS,{}),componentProps:{selectedRange:e,showDivider:t},Component:eD,...n}),eL=()=>(0,r.jsxs)(eu.l.Item,{disabled:!0,children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.AlertIcon,{})}),"Copilot failed to load"]}),eS=()=>(0,r.jsxs)(eu.l.Item,{disabled:!0,children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(eb.A,{size:"small"})}),"Copilot is loading..."]}),eD=({fileDiffReference:e,selectedRange:t,showDivider:n})=>{let i=(0,d.useMemo)(()=>{let n={...e};return t&&(n.selectedRange={start:`${t?.startOrientation[0]?.toUpperCase()??""}${t?.startLineNumber}`,end:`${t?.endOrientation[0]?.toUpperCase()??""}${t?.endLineNumber}`}),n},[e,t]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(ec.W,{children:[(0,r.jsx)(ec.W.Anchor,{children:(0,r.jsxs)(eu.l.Item,{children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.CopilotIcon,{})}),"Copilot"]})}),(0,r.jsx)(ec.W.Overlay,{children:(0,r.jsxs)(eu.l,{children:[(0,r.jsx)(eC.t,{fileDiffReference:i,eventContext:{prx:!0}}),(0,r.jsx)(ev.e,{fileDiffReference:i,eventContext:{prx:!0}}),(0,r.jsx)(ej.i,{fileDiffReference:i,eventContext:{prx:!0}})]})})]}),n&&(0,r.jsx)(eu.l.Divider,{})]})};try{ew.displayName||(ew.displayName="CopilotDiffChatContextMenu")}catch{}try{eL.displayName||(eL.displayName="MenuItemError")}catch{}try{eS.displayName||(eS.displayName="MenuItemLoading")}catch{}try{eD.displayName||(eD.displayName="BaseCopilotDiffChatContextMenu")}catch{}var ek=n(8784);let eI={left:"L",right:"R"},e_="Start conversation",eE="Suggest change";function eA(e,t,n){let i=n&&!(0,u.Ji)(t)?eI.left:eI.right;return`${e} on line ${i}${t.blobLineNumber}`}function eR({handleStartConversationWithSuggestedChange:e,handleStartConversation:t}){let n,i,a;let{selectedDiffRowRange:l,selectedDiffLines:s,replaceSelectedDiffRowRange:o}=(0,c.o)(),{commentingEnabled:f}=K(),{diffLine:m,isLeftSide:h,isSplit:p,diffContext:g}=S(),x=(0,d.useMemo)(()=>s.leftLines[0],[s.leftLines]),y=(0,d.useMemo)(()=>s.leftLines[s.leftLines.length-1],[s.leftLines]),b=(0,d.useMemo)(()=>s.leftLines.every(e=>!(0,u.Po)(e)&&"DELETION"!==e.type),[s.leftLines]),j=(0,d.useMemo)(()=>s.rightLines[0],[s.rightLines]),C=(0,d.useMemo)(()=>s.rightLines[s.rightLines.length-1],[s.rightLines]),v=(0,d.useMemo)(()=>0===s.rightLines.length,[s.rightLines]),N=(0,d.useMemo)(()=>0===s.leftLines.length,[s.leftLines]),w=(0,d.useMemo)(()=>!(s.leftLines.find(e=>!(0,u.Po)(e)&&!(0,u.Ji)(e)&&"INJECTED_CONTEXT"!==e.type)||s.rightLines.find(e=>!(0,u.Po)(e)&&!(0,u.Ji)(e)&&"INJECTED_CONTEXT"!==e.type)),[s.leftLines,s.rightLines]),L=(0,d.useCallback)((n,i)=>{!(!l||!y||!x||(0,u.Po)(y)||(0,u.Po)(x))&&x.left&&y.left&&(o({diffAnchor:l.diffAnchor,endLineNumber:y.left,endOrientation:"left",startLineNumber:x.left,startOrientation:"left",firstSelectedLineNumber:x.left,firstSelectedOrientation:"left"}),i?.withSuggestedChange?e():t())},[l,y,x,o,e,t]),D=(0,d.useCallback)((n,i)=>{!(!l||!C||!j||(0,u.Po)(C)||(0,u.Po)(j))&&j.right&&C.right&&(o({diffAnchor:l.diffAnchor,endLineNumber:C.right,endOrientation:"right",startLineNumber:j.right,startOrientation:"right",firstSelectedLineNumber:j.right,firstSelectedOrientation:"right"}),i?.withSuggestedChange?e():t())},[l,C,j,o,e,t]),k="DELETION"!==m.type&&("pr"===g||void 0===g),I=(0,d.useMemo)(()=>!!l&&(l.startOrientation!==l.endOrientation||l.startLineNumber!==l.endLineNumber),[l]);if(!f)return null;let _=!1,E=!1;if(l&&I){let t=eI[l.startOrientation],s=eI[l.endOrientation];return a=` on lines ${t}${l.startLineNumber}-${s}${l.endLineNumber}`,!(0,u.Po)(x)&&!(0,u.Po)(y)&&x&&y&&(_=!0,n=x.left===y.left?v?` on line L${x.left}`:`, original line L${x.left}`:v?` on lines L${x.left}-L${y.right}`:`, original lines L${x.left}-L${y.left}`),!(0,u.Po)(j)&&!(0,u.Po)(C)&&j&&C&&(E=!0,i=j.right===C.right?N||p&&w?` on line R${j.right}`:`, modified line R${C.right}`:N||p&&w?` on lines R${j.right}-R${C.right}`:`, modified lines R${j.right}-R${C.right}`),(0,r.jsx)(r.Fragment,{children:p?(0,r.jsx)(r.Fragment,{children:w?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(eu.l.Item,{onSelect:D,children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.PlusIcon,{})}),e_+i,(0,r.jsx)(eu.l.TrailingVisual,{children:(0,r.jsx)(ek.U,{keys:"Alt+n"})})]}),(0,r.jsxs)(eu.l.Item,{onSelect:e=>D(e,{withSuggestedChange:!0}),children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.PlusCircleIcon,{})}),eE+i]})]}):(0,r.jsxs)(r.Fragment,{children:[_?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(eu.l.Item,{onSelect:L,children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.PlusIcon,{})}),e_+n,(0,r.jsx)(eu.l.TrailingVisual,{children:(0,r.jsx)(ek.U,{keys:v?"Alt+n":"Alt+Shift+N"})})]}),b&&(0,r.jsxs)(eu.l.Item,{onSelect:e=>L(e,{withSuggestedChange:!0}),children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.PlusCircleIcon,{})}),eE+n]})]}):null,E?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(eu.l.Item,{onSelect:D,children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.PlusIcon,{})}),e_+i,(0,r.jsx)(eu.l.TrailingVisual,{children:(0,r.jsx)(ek.U,{keys:"Alt+n"})})]}),(0,r.jsxs)(eu.l.Item,{onSelect:e=>D(e,{withSuggestedChange:!0}),children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.PlusCircleIcon,{})}),eE+i]})]}):null]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(B.Vr,{commandId:"pull-requests-diff-view:start-conversation-current",leadingVisual:(0,r.jsx)(V.PlusIcon,{}),children:e_+a}),k&&b&&(0,r.jsxs)(eu.l.Item,{onSelect:e,children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.PlusCircleIcon,{})}),eE+a]})]})})}return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(B.Vr,{commandId:"pull-requests-diff-view:start-conversation-current",leadingVisual:(0,r.jsx)(V.PlusIcon,{}),children:eA(e_,m,h)}),k&&(0,r.jsxs)(eu.l.Item,{onSelect:e,children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.PlusCircleIcon,{})}),eA(eE,m,h)]})]})}try{eR.displayName||(eR.displayName="StartConversationContextMenuItems")}catch{}function eT(e){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e$,{...e}),(0,r.jsx)(eO,{copilotChatReferenceData:e.copilotChatReferenceData}),(0,r.jsx)(eV,{}),(0,r.jsx)(eP,{}),(0,r.jsx)(B.Vr,{commandId:"pull-requests-diff-view:copy-anchor-link",leadingVisual:(0,r.jsx)(V.LinkIcon,{})}),(0,r.jsx)(ez,{})]})}function eF(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eG,{}),(0,r.jsx)(eP,{})]})}let eO=({copilotChatReferenceData:e})=>{let{diffEntryId:t}=S(),{subjectId:n,oldCommitOid:i,newCommitOid:a}=K(),{selectedDiffRowRange:l}=(0,c.o)(),s=(0,d.useMemo)(()=>e&&n&&i&&a?{referenceData:e,queryVariables:{pullRequestId:n,startOid:i,endOid:a}}:t&&n&&i&&a?{queryVariables:{diffEntryId:t,pullRequestId:n,startOid:i,endOid:a}}:void 0,[t,a,i,n,e]);return s?(0,r.jsx)(ew,{selectedRange:l,showDivider:!0,...s}):null};function eP(){let{fileAnchor:e}=S();return(0,r.jsxs)(eu.l.Item,{onSelect:()=>{setTimeout(()=>{document.querySelector(`table[data-diff-anchor="${e}"]`)?.dispatchEvent(new KeyboardEvent("keydown",{key:"a",code:"KeyA",ctrlKey:!0}))})},children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.MultiSelectIcon,{})}),"Select all",(0,r.jsx)(eu.l.TrailingVisual,{children:(0,r.jsx)(ek.U,{keys:"Mod+a"})})]})}function e$({handleViewMarkersSelection:e,showStartConversation:t,startConversationCurrentLine:n,startConversationWithSuggestedChange:i}){let{commentingEnabled:a}=K(),{originalLineHasThreads:l,modifiedLineHasThreads:s}=S(),{annotations:o}=Z(),d=o.length>0;return a&&(t||l||s||d)?(0,r.jsxs)(r.Fragment,{children:[t&&(0,r.jsx)(eR,{handleStartConversation:n,handleStartConversationWithSuggestedChange:i}),(0,r.jsx)(eM,{handleViewMarkersSelection:e}),(0,r.jsx)(eu.l.Divider,{})]}):null}function eM({handleViewMarkersSelection:e}){let{commentingEnabled:t}=K(),{isSplit:n}=S();return t?n?(0,r.jsx)(eU,{handleViewMarkersSelection:e}):(0,r.jsx)(eB,{onSelect:()=>e()}):null}function eU({handleViewMarkersSelection:e}){let{originalLineHasThreads:t,modifiedLineHasThreads:n,isLeftSide:i}=S(),{annotations:a}=Z(),l=a.length>0;return i?(0,r.jsxs)(r.Fragment,{children:[t&&(0,r.jsx)(eH,{text:"View comments",onSelect:()=>e("LEFT")}),(n||l)&&(0,r.jsx)(eH,{text:"View comments, modified line",onSelect:()=>e("RIGHT")})]}):(0,r.jsxs)(r.Fragment,{children:[(n||l)&&(0,r.jsx)(eH,{text:"View comments",onSelect:()=>e("RIGHT")}),t&&(0,r.jsx)(eH,{text:"View comments, original line",onSelect:()=>e("LEFT")})]})}function eB({onSelect:e}){let{ghostUser:t}=K(),{diffLine:n}=S(),{annotations:i}=Z();return n&&D(n.threadsData,t).length>0||i.length>0?(0,r.jsx)(eH,{text:"View comments",onSelect:()=>e()}):null}function eH({onSelect:e,text:t}){return(0,r.jsxs)(eu.l.Item,{onSelect:e,children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.CommentDiscussionIcon,{})}),t]})}function eV(){return(0,r.jsx)("div",{onMouseDown:e=>{window.getSelection()?.toString()!==""&&e.preventDefault()},children:(0,r.jsx)(B.Vr,{commandId:"pull-requests-diff-view:copy-code",leadingVisual:(0,r.jsx)(V.CopyIcon,{})})})}function ez(){let{canExpandStartOfHunk:e,canExpandEndOfHunk:t}=ea(),{previousHunk:n,nextHunk:i}=S();return e||t||n||i?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(eu.l.Divider,{}),(0,r.jsx)(eG,{}),(0,r.jsx)(eK,{})]}):null}function eG(){let{canExpandStartOfHunk:e,canExpandEndOfHunk:t}=ea();return(0,r.jsxs)(r.Fragment,{children:[e&&(0,r.jsx)(B.Vr,{commandId:"pull-requests-diff-view:expand-hunk-up",leadingVisual:(0,r.jsx)(V.FoldUpIcon,{})}),t&&(0,r.jsx)(B.Vr,{commandId:"pull-requests-diff-view:expand-hunk-down",leadingVisual:(0,r.jsx)(V.FoldDownIcon,{})})]})}function eK(){let{previousHunk:e,nextHunk:t}=S(),{fileAnchor:n}=S();return(0,r.jsxs)(r.Fragment,{children:[t?(0,r.jsxs)(eu.l.Item,{"aria-keyshortcuts":"PageDown",onSelect:()=>{setTimeout(()=>{document.querySelector(`table[data-diff-anchor="${n}"]`)?.dispatchEvent(new KeyboardEvent("keydown",{key:"PageDown"}))})},children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.MoveToBottomIcon,{})}),"Go to next hunk",(0,r.jsx)(eu.l.TrailingVisual,{children:"Page Down"})]}):null,e?(0,r.jsxs)(eu.l.Item,{"aria-keyshortcuts":"PageUp",onSelect:()=>{setTimeout(()=>{document.querySelector(`table[data-diff-anchor="${n}"]`)?.dispatchEvent(new KeyboardEvent("keydown",{key:"PageUp"}))})},children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.MoveToTopIcon,{})}),"Go to previous hunk",(0,r.jsx)(eu.l.TrailingVisual,{children:"Page Up"})]}):null]})}try{eT.displayName||(eT.displayName="CellContextMenu")}catch{}try{eF.displayName||(eF.displayName="EmptyCellContextMenu")}catch{}try{eO.displayName||(eO.displayName="CopilotListItems")}catch{}try{eP.displayName||(eP.displayName="SelectAllListItem")}catch{}try{e$.displayName||(e$.displayName="MarkerListItems")}catch{}try{eM.displayName||(eM.displayName="ViewMarkerListItems")}catch{}try{eU.displayName||(eU.displayName="SplitDiffMarkersListItems")}catch{}try{eB.displayName||(eB.displayName="UnifiedDiffMarkerListItem")}catch{}try{eH.displayName||(eH.displayName="MarkerListItem")}catch{}try{eV.displayName||(eV.displayName="CopyContentListItems")}catch{}try{ez.displayName||(ez.displayName="HunkListItems")}catch{}try{eG.displayName||(eG.displayName="ExpandHunksListItems")}catch{}try{eK.displayName||(eK.displayName="JumpToHunkListItems")}catch{}var eW=n(224);function eq({authorAvatarUrl:e,authorLogin:t,lineSpacingPreference:n,sx:i}){return(0,r.jsx)(eW.k,{altText:`${t}'s avatar image with pending indicator`,icon:V.DotFillIcon,iconColor:"var(--fgColor-attention, var(--color-attention-fg))",square:!1,size:"compact"===n?18:20,src:e,backgroundSx:{backgroundColor:"var(--bgColor-default, var(--color-canvas-default))",boxShadow:"0 0 0 .1px var(--bgColor-default, var(--color-canvas-default))"},sx:{alignItems:"center",display:"flex",opacity:.5,height:"var(--diff-line-minimum-height)",...i}})}try{eq.displayName||(eq.displayName="InProgressCommentIndicator")}catch{}let eX={"action-bar-position":"ActionBar-module__action-bar-position--q5zYS"},eQ="24px",eY="30px",eJ=(0,d.forwardRef)(function({authorAvatarUrl:e,authorLogin:t,cellId:n,cellRef:i,showStartConversation:a,hasDraftComment:l,copilotChatReferenceData:s},o){let c=(0,d.useRef)(null),u=(0,d.useRef)(null),{commentingEnabled:h,viewerData:{lineSpacingPreference:p}}=K(),{diffLine:g,isRowSelected:x}=S(),y=(0,d.useRef)(null),b=c.current?c:u;(0,es.T)(o,b);let j=g.threadsData?.totalCommentsCount||0,C=g.annotationsData?.totalCount||0,{isActionBarFocused:v,handleActionBarBlur:N,handleActionBarFocusCapture:w,handleActionBarKeydownCapture:L}=er({cellRef:i}),{annotations:D,isContextMenuOpen:k,openMarkerOrListDialogFromActionBar:I,startNewConversationFromActionBar:_,startNewConversationFromActionBarWithSuggestedChange:E,anyMenuOpen:A,threads:R,toggleContextMenu:T,toggleContextMenuFromActionBar:F}=ei({cellId:n,actionBarRef:y}),O=(0,d.useCallback)(e=>{x&&e.preventDefault()},[x]);return(0,r.jsx)("div",{"aria-hidden":!v,className:(0,f.$)("d-flex","flex-row",eX["action-bar-position"]),children:(0,r.jsxs)(eo.A,{onBlur:N,onClick:O,onFocusCapture:w,onKeyDownCapture:L,children:[h&&(0,r.jsxs)(r.Fragment,{children:[j+C>0&&(0,r.jsx)(m.Q,{ref:c,"aria-expanded":A,"aria-label":"View conversations",size:"small",sx:{pt:0,pb:0,px:1,height:eQ},onClick:e=>{(1===R.length||1===D.length)&&e.preventDefault(),I()},children:(0,r.jsx)(ey,{lineSpacingPreference:p})}),a&&(0,r.jsx)(r.Fragment,{children:l?(0,r.jsx)(m.Q,{"aria-label":"Start conversation (comment in progress)",size:"small",sx:{pt:0,pb:0,px:1,width:eY,height:eQ},onClick:_,children:(0,r.jsx)(eq,{lineSpacingPreference:p,authorAvatarUrl:e,authorLogin:t})}):(0,r.jsx)(ed.K,{unsafeDisableTooltip:!0,"aria-label":"Start conversation",ref:u,icon:V.PlusIcon,size:"small",sx:{width:eY,height:eQ,color:"fg.muted"},onClick:_})})]}),(0,r.jsx)(ed.K,{unsafeDisableTooltip:!0,ref:y,"aria-haspopup":"true","aria-label":"More actions",icon:V.TriangleDownIcon,size:"small",sx:{width:eQ,height:eQ,color:"fg.muted"},onClick:F}),(0,r.jsx)(ec.W,{anchorRef:y,open:k,onOpenChange:T,children:(0,r.jsx)(ec.W.Overlay,{width:"medium",children:(0,r.jsx)(eu.l,{children:(0,r.jsx)(eT,{copilotChatReferenceData:s,showStartConversation:a,handleViewMarkersSelection:I,startConversationCurrentLine:_,startConversationWithSuggestedChange:E})})})})]})})});eJ.displayName="ActionBar";let eZ={visibilityHidden:"DiffHighlightedOverlay-module__visibilityHidden--v59uf",userSelectNone:"DiffHighlightedOverlay-module__userSelectNone--i39lB",focusedResultStyles:"DiffHighlightedOverlay-module__focusedResultStyles--QZMIm",nonFocusedResultStyles:"DiffHighlightedOverlay-module__nonFocusedResultStyles--x2N7d",nonHunkStyles:"DiffHighlightedOverlay-module__nonHunkStyles--_dJlQ"};function e0({searchResults:e,focusedSearchResult:t,className:n,styleObject:i}){let a=0,l=e[0]?.text??"",s=e[0]?.diffLineNumIndex??-1,o=`overlay-${s}-${l}`;return(0,r.jsxs)("span",{className:(0,f.$)(n,"position-absolute",eZ.userSelectNone,!e[0].isHunk&&eZ.nonHunkStyles),style:{...i},children:[e.map(e=>{var n,i;let s=e.indexWithinPathDigest===t,o=(0,r.jsxs)("span",{children:[(0,r.jsx)("span",{className:(0,f.$)(eZ.visibilityHidden,eZ.userSelectNone),children:l.substring(a,e.column)}),(0,r.jsx)("span",{className:(0,f.$)(eZ.userSelectNone,s&&eZ.focusedResultStyles,!s&&eZ.nonFocusedResultStyles),children:(0,r.jsx)("span",{className:(0,f.$)(!s&&eZ.visibilityHidden),id:(n=e.indexWithinPathDigest,i=e.pathDigest,`match-${i}-${n}`),children:l.substring(e.column,e.columnEnd)})})]},`find-match-${e.diffLineNumIndex}-${e.column}`);return a=e.columnEnd,o}),(0,r.jsx)("span",{className:(0,f.$)(eZ.visibilityHidden,eZ.userSelectNone),children:l.substring(a)})]},o)}try{e0.displayName||(e0.displayName="DiffHighlightedOverlay")}catch{}function e1(e,t,n){let i=e.threadsData?.totalCount||0,r=t.threadsData?.totalCount||0;if(0===i&&0===r)return;let a=e.threadsData?.threads?.[0]?.commentsData.comments?.[0]?.author?.login||"",l=t.threadsData?.threads?.[0]?.commentsData.comments?.[0]?.author?.login||"",s="";1===i?s=`has conversation started by @${a}.`:i>1&&(s="has conversations.");let o="";1===r?o=`has conversation started by @${l}.`:r>1&&(o="has conversations.");let d="";if("LEFT"===n){let e=`${s.charAt(0).toUpperCase()}${s.slice(1)}`,t=`${o.length>1?"Modified line":""} ${o}`;d=`${e} ${t}`}else{let e=`${o.charAt(0).toUpperCase()}${o.slice(1)}`,t=`${s.length>1?"Original line":""} ${s}`;d=`${e} ${t}`}return d}function e2({summary:e}){return""===e?null:(0,r.jsx)("div",{className:"sr-only","data-testid":"pr-diffline-summary",children:e.trimStart().trimEnd()})}try{e2.displayName||(e2.displayName="DiffLineScreenReaderSummary")}catch{}var e8=n(15820);let e4=["CONTEXT","INJECTED_CONTEXT"];function e3(e){let{rowId:t}=S();if(t)return(0,u.u6)(t,e)}function e6(e,t){let{selectedDiffRowRange:n}=(0,c.o)();return(0,d.useMemo)(()=>{let i="Add a comment on",r=!!n&&n.startLineNumber!==n.endLineNumber;if(n&&r){let e={left:"L",right:"R"},t=e[n.startOrientation],r=e[n.endOrientation];i+=n.startLineNumber!==n.endLineNumber?` lines ${t}${n.startLineNumber} to ${r}${n.endLineNumber}`:` line ${t}${n.startLineNumber}`}else{let n=t&&!(0,u.Ji)(e)?"L":"R";i+=` line ${n}${e.blobLineNumber}`}return i},[e,t,n])}let e7=(0,d.forwardRef)(function({children:e,ContextMenu:t,className:n,columnIndex:i,handleDiffCellClick:a,handleDiffSideCellSelectionBlocking:l,lineAnchor:s,commentDialogOpen:o,startConversation:f,...m},h){let{diffLine:p,isRowSelected:g,isLeftSide:x,isSplit:y}=S(),b=(0,d.useRef)(null);(0,d.useImperativeHandle)(h,()=>b.current,[]);let[j,C]=(0,d.useState)(!1),{selectedDiffRowRange:v}=(0,c.o)(),{fileAnchor:N,filePath:w}=S(),{expandStartOfHunk:L,expandEndOfHunk:D,expandEndOfPreviousHunk:k}=ea(),{getUnifiedDiffLineCode:I,getSplitDiffSingleLineCode:_,getSplitDiffMultiLineCode:E}=function(e){let{selectedDiffRowRange:t,selectedDiffLines:n,getDiffLinesByDiffAnchor:i}=(0,c.o)();return{getUnifiedDiffLineCode:()=>{let n=i(e);if(!n||!t)return"";let{startOrientation:r,endOrientation:a,startLineNumber:l,endLineNumber:s}=t,o=0,d=0;return n.length>1&&(o=n.findIndex(e=>"left"===r?e.left===l:e.right===l),d=n.findIndex(e=>"left"===a?e.left===s:e.right===s)),(0,u.Ls)(n.slice(o,d+1))},getSplitDiffSingleLineCode:(t,n)=>{if(!t||!n)return"";let r=i(e)?.find(e=>"left"===t?e.left===n:e.right===n);return r?(0,u.Ls)([r]):""},getSplitDiffMultiLineCode:e=>void 0===e?"":"left"===e?(0,u.Ls)(n.leftLines):(0,u.Ls)(n.rightLines)}}(N),A=(0,d.useRef)(null),R=(0,H.U)(e=>{if(!e.target)return;let t=e.target;!j||A.current?.contains(t)||b.current?.contains(t)||2!==e.button?b.current?.contains(t)&&e.target.closest("button")?.contains(t)&&C(!1):C(!1)});(0,d.useEffect)(()=>{j?document.addEventListener("mousedown",R):document.removeEventListener("mousedown",R)},[R,j]),(0,d.useEffect)(()=>()=>document.removeEventListener("mousedown",R),[]);let T=(0,d.useCallback)(e=>{e.shiftKey&&e.preventDefault(),l?.(e)},[l]);return(0,r.jsxs)(B.tL,{as:"td",commands:{"pull-requests-diff-view:copy-code":()=>{let e=window.getSelection();if(e&&""!==e.toString()){document.execCommand("copy");return}if(y){void 0===v||v?.startOrientation===v?.endOrientation&&v?.startLineNumber===v?.endLineNumber?(0,M.D)(_(x?"left":"right",x?p?.left:p?.right)):(0,M.D)(E(x?"left":"right"));return}(0,M.D)(I())},"pull-requests-diff-view:expand-all-hunks":()=>{let e=document.querySelector(`.js-expand-all-difflines-button[data-file-path="${w}"]`);e?.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0}))},"pull-requests-diff-view:expand-hunk-up":L,"pull-requests-diff-view:expand-hunk-down":()=>{if(p?.type==="HUNK"){k();return}D()},"pull-requests-diff-view:copy-anchor-link":()=>{let e=(0,u.j2)({line:p,range:v,fileAnchor:N});e&&(0,M.D)(e)},"pull-requests-diff-view:start-conversation-current":f},ref:b,"data-grid-cell-id":e3(i),"data-line-anchor":s,"data-selected":g,role:"gridcell",style:{userSelect:"none",position:"relative"},tabIndex:-1,valign:"top",className:n?`focusable-grid-cell ${n} ${i<3?"left-side":""}`:"focusable-grid-cell",onBlur:e=>e.target.ariaSelected="false",onClick:a,onFocus:e=>e.target.ariaSelected="true",onMouseDown:T,...m,children:[e,t&&j&&(0,r.jsx)(ec.W,{anchorRef:b,open:!0,onOpenChange:C,children:(0,r.jsx)(ec.W.Overlay,{width:e?"medium":"small",children:(0,r.jsx)(eu.l,{children:t})})})]})});function e5(){return(0,r.jsx)("div",{className:"hunk-kebab-icon pr-2 pb-1",children:(0,r.jsx)(V.KebabHorizontalIcon,{})})}function e9({summary:e,searchResultsForLine:t,focusedSearchResult:n,columnIndex:i,lineAnchor:a,handleDiffCellClick:s,handleDiffSideCellSelectionBlocking:o,filePath:m,tabSize:h,copilotChatReferenceData:p}){let{diffLine:g,fileAnchor:x,isLeftSide:y}=S(),{getTextIndent:b,getPaddingLeft:j}=(0,d.useMemo)(()=>(0,l.oW)(g.text,h),[g,h]),[C,v]=(0,u._S)(g.html,g.type),N=v&&["+","-"].includes(v),{isActionBarVisible:w}=Z(),{selectedDiffRowRange:L,selectedDiffLines:D}=(0,c.o)(),{commentBatchPending:k,commentingEnabled:I,commentingImplementation:_,initialExpandedThreadId:E,markerNavigationImplementation:A,repositoryId:R,subjectId:T,subject:F,viewerData:O}=K(),{hasPersistedComment:P}=(0,$.L4)({diffSide:y?"LEFT":"RIGHT",filePath:m,line:g.blobLineNumber,subjectId:T,fileLevelComment:!1}),M=(0,d.useMemo)(()=>{var e;return e=O.viewerCanComment,I&&e&&(0,u.a1)(g,D)},[I,O,g,D]),B=(0,d.useRef)(null),H=(0,d.useRef)(null),V=(0,u.YY)({shouldAlignRight:P||!M,lineSpacingPreference:O.lineSpacingPreference}),z=!!g.threadsData?.threads?.length||!!g.annotationsData?.annotations?.length,G=(0,u.S4)({hasThreads:z}),W=e6(g,!!y),q=e3(i),{handleCellBlur:X,handleCellFocus:Q,handleCellMouseEnter:Y,handleCellMouseLeave:J}=er({cellRef:H}),{annotations:ee,isNewConversationDialogOpen:et,shouldStartNewConversationWithSuggestedChange:en,startNewConversation:ea,startNewConversationWithSuggestedChange:es,openMarkerOrListDialog:eo,selectAnnotation:ed,selectThread:ec,isMarkerListDialogOpen:eu,closeNewConversationDialog:ef,closeMarkerListDialog:em,closeConversationDetailsDialog:eh,returnFocusRef:ep,optimizedSelectedAnnotationId:eg,optimizedSelectedThreadId:ex,threadConnectionId:eb,threads:ej}=ei({cellId:q,actionBarRef:B});(0,d.useEffect)(()=>{_&&E&&ex!==E&&ej.map(e=>e.id).includes(E)&&ec(E,{skipLineSelection:!0})},[E]),(0,d.useEffect)(()=>{if(!A)return;let{activeGlobalMarkerID:e,onActivateGlobalMarkerNavigation:t}=A;if(e){let n=ej.map(e=>e.id),i=ee.map(e=>e.id);n.includes(e)?(ec(e,{skipLineSelection:!0}),t()):i.includes(e)&&(ed(e,{skipLineSelection:!0}),t())}},[ec,ej,A,ee,ed]);let eC=(0,el.S)(_?.suggestedChangesEnabled,g,en),ev=(0,d.useRef)(!0),{ghostUser:eN}=K(),ew=(0,e8.u)("diff_ux_refresh_tab_wrap_reset")?void 0:{paddingLeft:j(),textIndent:b()};return(0,r.jsxs)(e7,{ref:H,columnIndex:i,commentDialogOpen:et,handleDiffCellClick:s,handleDiffSideCellSelectionBlocking:o,lineAnchor:a,startConversation:ea,ContextMenu:(0,r.jsx)(eT,{copilotChatReferenceData:p,showStartConversation:M,handleViewMarkersSelection:eo,startConversationCurrentLine:ea,startConversationWithSuggestedChange:es}),className:(0,f.$)(`diff-text-cell ${y?"left-side-diff-cell":"right-side-diff-cell"}`,{"border-right":y&&"HUNK"!==g.type}),style:{backgroundColor:ti(g.type,!1),paddingRight:G},onBlur:X,onFocus:Q,onMouseEnter:Y,onMouseLeave:J,children:[(0,r.jsxs)("code",{className:(0,f.$)("diff-text syntax-highlighted-line",{addition:"ADDITION"===g.type,deletion:"DELETION"===g.type}),children:[N&&(0,r.jsx)("span",{className:"diff-text-marker",children:v}),t&&t.length>0&&(0,r.jsx)(e0,{searchResults:t,focusedSearchResult:n,className:(0,f.$)("diff-text-inner",{"color-fg-muted":"HUNK"===g.type}),styleObject:ew}),(0,r.jsx)(U.mo,{html:C,className:(0,f.$)("diff-text-inner",{"color-fg-muted":"HUNK"===g.type}),style:ew})]}),w&&(0,r.jsx)(eJ,{copilotChatReferenceData:p,authorAvatarUrl:O.avatarUrl,authorLogin:O.login,ref:B,cellId:q,cellRef:H,hasDraftComment:P,showStartConversation:M}),_&&A&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)($.c7,{annotations:ee,batchPending:k,batchingEnabled:_.batchingEnabled,commentingImplementation:{..._,deleteComment:({onCompleted:e,...t})=>{_&&g&&_.deleteComment({...t,onCompleted:()=>{e?.(),ej.length<=1&&(eh(),setTimeout(()=>H.current?.focus()))},filePath:m})}},conversationAnchorRef:H,conversationListAnchorRef:ep,conversationListThreads:ej,fileAnchor:x,filePath:m,isMarkerListOpen:eu,repositoryId:R,returnFocusRef:ep,selectedAnnotationId:eg,selectedThreadId:ex,subjectId:T,subject:F,suggestedChangesConfig:eC,threadsConnectionId:eb,onCloseConversationDialog:eh,onCloseConversationList:em,onAnnotationSelected:ed,onThreadSelected:ec,markerNavigationImplementation:A,viewerData:O,ghostUser:eN}),(0,r.jsx)($.cT,{addCommentDialogTitle:W,anchorRef:H,batchPending:k,batchingEnabled:_.batchingEnabled,commentBoxConfig:_.commentBoxConfig,filePath:m,isLeftSide:!!y,isOpen:et,lineNumber:g.blobLineNumber,repositoryId:R,returnFocusRef:ep,subjectId:T,suggestedChangesConfig:eC,threadsConnectionId:eb,viewerData:O,onAddComment:({onCompleted:e,threadsConnectionId:t,...n})=>{if(!_||!g)return;let{leftLines:i,rightLines:r}=D;if(L){let e="left"===L.endOrientation?i:r,n=e[e.length-1];n&&(0,u.qK)(n)&&n.threadsData?.__id&&(t=n.threadsData?.__id)}_.addThread({...n,diffLine:g,isLeftSide:y,selectedDiffRowRange:L,threadsConnectionId:t,onCompleted:(t,n)=>{e?.(t,n),ec(t)}})},onCloseCommentDialog:ef})]}),!w&&(0,r.jsxs)("div",{"aria-hidden":"true",style:{right:V},className:"position-absolute top-0 d-flex user-select-none",children:[(0,r.jsx)(ey,{shouldAnimateRef:ev,lineSpacingPreference:O.lineSpacingPreference}),P&&(0,r.jsx)(eq,{lineSpacingPreference:O.lineSpacingPreference,authorAvatarUrl:O.avatarUrl,authorLogin:O.login})]}),e&&(0,r.jsx)(e2,{summary:e})]})}function te({children:e,columnIndex:t,handleDiffCellClick:n,handleDiffSideCellSelectionBlocking:i,filePath:a,copilotChatReferenceData:l,...s}){let o=(0,d.useRef)(null),m=e3(t),{commentBatchPending:h,commentingEnabled:p,commentingImplementation:g,repositoryId:x,subject:y,subjectId:b,markerNavigationImplementation:j,viewerData:C}=K(),{diffLine:v,fileAnchor:N,isLeftSide:w}=S(),{selectedDiffRowRange:L,selectedDiffLines:D}=(0,c.o)(),k=e6(v,!!w),I=(0,d.useMemo)(()=>{var e;return e=C.viewerCanComment,p&&e&&(0,u.a1)(v,D)},[p,C,v,D]),{handleCellBlur:_,handleCellFocus:E,handleCellMouseEnter:A,handleCellMouseLeave:R}=er({cellRef:o}),{ghostUser:T}=K(),{annotations:F,isNewConversationDialogOpen:O,shouldStartNewConversationWithSuggestedChange:P,startNewConversation:M,startNewConversationWithSuggestedChange:U,openMarkerOrListDialog:B,isMarkerListDialogOpen:H,closeConversationDetailsDialog:V,closeMarkerListDialog:z,selectAnnotation:G,selectThread:W,closeNewConversationDialog:q,returnFocusRef:X,optimizedSelectedThreadId:Q,optimizedSelectedAnnotationId:Y,threadConnectionId:J,threads:Z}=ei({cellId:m,actionBarRef:o}),ee=(0,el.S)(g?.suggestedChangesEnabled,v,P);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e7,{ref:o,className:(0,f.$)("diff-line-number",e4.includes(v.type)&&"diff-line-number-neutral"),columnIndex:t,commentDialogOpen:O,handleDiffCellClick:n,handleDiffSideCellSelectionBlocking:i,startConversation:M,style:{backgroundColor:ti(v.type,!0),textAlign:"center"},ContextMenu:(0,r.jsx)(eT,{copilotChatReferenceData:l,showStartConversation:I,handleViewMarkersSelection:B,startConversationCurrentLine:M,startConversationWithSuggestedChange:U}),onBlur:_,onFocus:E,onMouseEnter:A,onMouseLeave:R,...s,children:(0,r.jsx)("code",{children:e})}),g&&j&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)($.c7,{annotations:F,batchPending:h,batchingEnabled:g.batchingEnabled,commentingImplementation:{...g,deleteComment:({onCompleted:e,...t})=>{g&&v&&g.deleteComment({...t,onCompleted:()=>{e?.(),Z.length<=1&&(V(),setTimeout(()=>o.current?.focus()))},filePath:a})}},conversationAnchorRef:o,conversationListAnchorRef:X,conversationListThreads:Z,fileAnchor:N,filePath:a,isMarkerListOpen:H,repositoryId:x,returnFocusRef:X,selectedAnnotationId:Y,selectedThreadId:Q,subjectId:b,subject:y,suggestedChangesConfig:ee,threadsConnectionId:J,markerNavigationImplementation:j,onCloseConversationDialog:V,onCloseConversationList:z,onThreadSelected:W,onAnnotationSelected:G,viewerData:C,ghostUser:T}),(0,r.jsx)($.cT,{addCommentDialogTitle:k,align:"start",anchorRef:o,batchPending:h,batchingEnabled:g.batchingEnabled,commentBoxConfig:g.commentBoxConfig,filePath:a,isLeftSide:!!w,isOpen:O,lineNumber:v.blobLineNumber,repositoryId:x,returnFocusRef:X,subjectId:b,suggestedChangesConfig:ee,threadsConnectionId:J,viewerData:C,onAddComment:({onCompleted:e,threadsConnectionId:t,...n})=>{if(!g||!v)return;let{leftLines:i,rightLines:r}=D;if(L){let e="left"===L.endOrientation?i:r,n=e[e.length-1];n&&(0,u.qK)(n)&&n.threadsData?.__id&&(t=n.threadsData?.__id)}g.addThread({...n,diffLine:v,selectedDiffRowRange:L,threadsConnectionId:t,onCompleted:(t,n)=>{e?.(t,n),W(t)}})},onCloseCommentDialog:q})]})]})}function tt({ContextMenu:e,renderHunkButton:t,searchResultsForLine:n,focusedSearchResult:i}){let a=(0,d.useRef)(null),[l,s]=function(e){let[t,n]=(0,d.useState)(!1),[i,r]=(0,d.useState)(!1),a=(0,d.useCallback)(t=>{e.current&&e.current.contains(t.relatedTarget)||n(!1)},[e]),l=(0,d.useCallback)(()=>{e.current===document.activeElement&&n(!0)},[e]),s=(0,d.useCallback)(t=>{e.current&&!e.current.contains(t.relatedTarget)&&n(!1),r(!1)},[e]);return[{onFocus:l,onBlur:a},{"aria-hidden":!i,tabIndex:t?0:-1,onBlur:s,onFocusCapture:(0,d.useCallback)(e=>{e.stopPropagation(),r(!0)},[]),onKeyDownCapture:(0,d.useCallback)(e=>{F(e.key)&&e.stopPropagation()},[])}]}(a),{diffLine:o}=S();return(0,r.jsx)(e7,{ref:a,ContextMenu:e,colSpan:4,columnIndex:0,style:{backgroundColor:"var(--bgColor-accent-muted, var(--color-accent-subtle))",flexGrow:1},...l,children:(0,r.jsxs)("div",{className:"d-flex flex-row",children:[t?.(s)??(0,r.jsx)(e5,{}),(0,r.jsxs)("code",{className:"diff-text-cell hunk",children:[n&&n.length>0&&(0,r.jsx)(e0,{searchResults:n,focusedSearchResult:i,className:(0,f.$)("diff-text-inner",{"color-fg-muted":"HUNK"===o.type})}),(0,r.jsx)(U.mo,{className:"diff-text-inner color-fg-muted",html:o.html})]})]})})}function tn({columnIndex:e,showRightBorder:t}){return(0,r.jsx)(e7,{ContextMenu:(0,r.jsx)(eF,{}),className:(0,f.$)("empty-diff-line",{"border-right":t}),columnIndex:e})}function ti(e,t=!1){switch(e){case"ADDITION":return t?"var(--diffBlob-addition-bgColor-num, var(--color-diff-blob-addition-num-bg))":"var(--diffBlob-addition-bgColor-line, var(--color-diff-blob-addition-line-bg))";case"DELETION":return t?"var(--diffBlob-deletion-bgColor-num, var(--color-diff-blob-deletion-num-bg))":"var(--diffBlob-deletion-bgColor-line, var(--color-diff-blob-deletion-line-bg))";case"HUNK":case"EMPTY":return t?"var(--diffBlob-hunk-bgColor-num, var(--color-diff-blob-hunk-num-bg))":"var(--bgColor-accent-muted, var(--color-accent-subtle))";default:return}}try{e7.displayName||(e7.displayName="Cell")}catch{}try{e5.displayName||(e5.displayName="HunkKebabIcon")}catch{}try{e9.displayName||(e9.displayName="ContentCell")}catch{}try{te.displayName||(te.displayName="LineNumberCell")}catch{}try{tt.displayName||(tt.displayName="HunkCell")}catch{}try{tn.displayName||(tn.displayName="EmptyCell")}catch{}let tr=({summary:e,resultsForLine:t,focusedSearchResult:n,handleDiffSideCellSelectionBlocking:i,handleDiffRowClick:a,lineAnchor:l,filePath:s,copilotChatReferenceData:o})=>{let{diffLine:c,isLeftSide:u,isSplit:f}=S(),{viewerData:m}=K(),{tabSizePreference:h}=m,p="ADDITION"!==c.type,g=!f||u,x=g&&!p,y="DELETION"!==c.type,b=!f||!u,j=b&&!y,C=(0,d.useCallback)(e=>{c.left&&a(e,c.left,"left",e.shiftKey)},[a,c.left]),v=(0,d.useCallback)(e=>{c.right&&a(e,c.right,"right",e.shiftKey)},[a,c.right]),N=(0,d.useCallback)(()=>{i&&i("left")},[i]),w=(0,d.useCallback)(()=>{i&&i("right")},[i]);return(0,r.jsxs)(J,{line:c,children:[g&&(0,r.jsx)(te,{copilotChatReferenceData:o,columnIndex:0,filePath:s,handleDiffCellClick:x?v:C,handleDiffSideCellSelectionBlocking:w,children:p&&c.left}),b&&(0,r.jsx)(te,{copilotChatReferenceData:o,columnIndex:f?2:1,filePath:s,handleDiffCellClick:j?C:v,handleDiffSideCellSelectionBlocking:N,children:y&&c.right}),(0,r.jsx)(e9,{copilotChatReferenceData:o,columnIndex:f?u?1:3:2,filePath:s,handleDiffCellClick:u?C:v,lineAnchor:l,tabSize:h,handleDiffSideCellSelectionBlocking:u?w:N,searchResultsForLine:t,focusedSearchResult:n,summary:e})]})},ta=({summary:e,resultsForLine:t,focusedSearchResult:n,fileAnchor:i,filePath:a,handleDiffRowClick:l,handleDiffSideCellSelectionBlocking:o,copilotChatReferenceData:d})=>{let{diffLine:c,isLeftSide:f}=S();if((0,u.Po)(c))return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(tn,{columnIndex:f?0:2}),(0,r.jsx)(tn,{columnIndex:f?1:3,showRightBorder:f})]});let m=f?"left":(0,s.XU)(c.type),h="left"===m?c.left:c.right,p=(0,s.IQ)(i,m,h??0);switch(c.type){case"HUNK":return null;case"ADDITION":case"DELETION":case"CONTEXT":case"INJECTED_CONTEXT":return(0,r.jsx)(ts,{copilotChatReferenceData:d,filePath:a,handleDiffRowClick:l,handleDiffSideCellSelectionBlocking:o,lineAnchor:p,resultsForLine:t,focusedSearchResult:n,summary:e});default:throw Error(`cannot handle type ${c.type}`)}},tl=d.memo(ta),ts=d.memo(tr);try{tr.displayName||(tr.displayName="CodeDiffLineUnmemoized")}catch{}try{ta.displayName||(ta.displayName="DiffLineSideUnmemoized")}catch{}try{tl.displayName||(tl.displayName="DiffLineSide")}catch{}try{ts.displayName||(ts.displayName="CodeDiffLine")}catch{}let to={"expand-button-line":"ExpandableHunkHeaderDiffLine-module__expand-button-line--rnQN5","expand-up-and-down":"ExpandableHunkHeaderDiffLine-module__expand-up-and-down--hCan_"};function td({direction:e,icon:t,label:n,onClick:i,ariaLabel:a,className:l,...s}){let{sendAnalyticsEvent:o}=(0,en.s)();return(0,r.jsx)("button",{onClick:()=>{i(),o("file_entry.expand_hunk","FILE_EXPANDER_BUTTON")},className:(0,f.$)("Button Button--iconOnly Button--invisible",to["expand-button-line"],l),"aria-label":a??n,"data-direction":e,...s,children:(0,r.jsx)(t,{})})}function tc({nextLine:e,prevLine:t,resultsForLine:n,focusedSearchResult:i}){let{fileLineCount:a,diffLine:l}=S(),{expandStartOfHunk:s,expandEndOfPreviousHunk:o}=ea(),c=!t,f=!e,m=0===l.blobLineNumber,h=c||f,p=f&&l.blobLineNumber===a,g=(0,d.useMemo)(()=>!h&&!(l.blobLineNumber<=0)&&(l.blobLineNumber-t.blobLineNumber<=20||e.blobLineNumber-l.blobLineNumber>=20),[h,l,e,t]),x=(0,d.useMemo)(()=>!h&&!p&&l.blobLineNumber-t.blobLineNumber>20,[h,p,l,t]),y=(0,d.useMemo)(()=>!(l.blobLineNumber<=0)&&!m&&!!c,[c,m,l]),b=(0,d.useMemo)(()=>!c&&!p&&!!f,[c,f,p]),j=(0,d.useMemo)(()=>{switch(!0){case g:return"expand-all";case x:return"expand-up-and-down";case y:return"expand-up";case b:return"expand-down"}},[g,x,y,b]),C=()=>s(),v=()=>o(),N=()=>s();return(0,r.jsx)(tt,{searchResultsForLine:n,focusedSearchResult:i,renderHunkButton:n=>{switch(j){case"expand-all":return(0,r.jsx)(td,{...n,direction:"all",icon:V.UnfoldIcon,label:`Expand file from line ${t?.blobLineNumber||""} to line ${e?.blobLineNumber||""}`,onClick:N});case"expand-up-and-down":return(0,r.jsxs)("div",{className:"d-flex flex-column",children:[(0,r.jsx)(td,{...n,direction:"down",icon:V.FoldDownIcon,label:`Expand file down from line ${t?.blobLineNumber||""}`,className:to["expand-up-and-down"],onClick:v}),(0,r.jsx)(td,{...n,direction:"up",icon:V.FoldUpIcon,label:`Expand file up from line ${e?.blobLineNumber||""}`,className:to["expand-up-and-down"],onClick:C})]});case"expand-up":return(0,r.jsx)(td,{...n,direction:"up",icon:V.FoldUpIcon,label:`Expand file up from line ${e?.blobLineNumber||""}`,onClick:C});case"expand-down":return(0,r.jsx)(td,{...n,direction:"down",icon:V.FoldDownIcon,label:`Expand file down from line ${t?.blobLineNumber||""}`,onClick:v});default:return null}},ContextMenu:(0,r.jsx)(tu,{handleCopyContent:()=>{let[e]=(0,u._S)((0,u.ZC)(l.html),l.type);(0,M.D)(e)},handleExpandAbove:C,handleExpandAll:N,handleExpandBelow:v,shouldCopyContent:!!l.html,shouldExpandAbove:x||y,shouldExpandBelow:x||b})})}function tu({shouldExpandBelow:e,shouldExpandAbove:t,shouldCopyContent:n,handleExpandAll:i,handleExpandBelow:a,handleExpandAbove:l,handleCopyContent:s}){let o={includeShiftKey:!0,key:"["},d={key:"]"},c={key:"["},f={key:"C"};return(0,r.jsx)(ec.W.Overlay,{width:"medium",children:(0,r.jsxs)(eu.l,{children:[(0,r.jsxs)(eu.l.Item,{"aria-keyshortcuts":(0,u.oE)(o),onSelect:i,children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.UnfoldIcon,{})}),"Expand all",(0,r.jsx)(eu.l.TrailingVisual,{children:(0,r.jsx)("span",{children:`${(0,u.pI)(o)}`})})]}),t?(0,r.jsxs)(eu.l.Item,{"aria-keyshortcuts":(0,u.oE)(d),onSelect:l,children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.FoldUpIcon,{})}),"Expand above",(0,r.jsx)(eu.l.TrailingVisual,{children:(0,r.jsx)("span",{children:`${(0,u.pI)(d)}`})})]}):null,e?(0,r.jsxs)(eu.l.Item,{"aria-keyshortcuts":(0,u.oE)(c),onSelect:a,children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.FoldDownIcon,{})}),"Expand below",(0,r.jsx)(eu.l.TrailingVisual,{children:(0,r.jsx)("span",{children:`${(0,u.pI)(c)}`})})]}):null,(0,r.jsx)(eK,{}),n?(0,r.jsxs)(eu.l.Item,{"aria-keyshortcuts":(0,u.oE)(f),onSelect:s,children:[(0,r.jsx)(eu.l.LeadingVisual,{children:(0,r.jsx)(V.CopyIcon,{})}),"Copy",(0,r.jsx)(eu.l.TrailingVisual,{children:(0,r.jsx)("span",{children:`${(0,u.pI)(f)}`})})]}):null]})})}try{td.displayName||(td.displayName="ExpandButtonLine")}catch{}try{tc.displayName||(tc.displayName="ExpandableHunkHeaderDiffLine")}catch{}try{tu.displayName||(tu.displayName="HunkContextMenu")}catch{}let tf=(0,d.memo)(function({searchResults:e,diffContext:t="pr",focusedSearchResult:n,clearSelectedDiffRowRange:i,diffEntryId:a,diffLines:l,fileAnchor:s,fileLineCount:o,filePath:c,handleDiffRowClick:f,handleDiffSideCellSelectionBlocking:m,replaceSelectedDiffRowRangeFromGridCells:h,selectedDiffRowRange:p,tableRef:g,updateDiffLines:x,updateSelectedDiffRowRange:j,copilotChatReferenceData:C}){let{leftLines:v,rightLines:N}=function(e){let t=e.reduce((e,t)=>e+(t.threadsData?.totalCount??0),0)??0,{leftLines:n,rightLines:i}=(0,d.useMemo)(()=>(function(e){let t=[],n=[],i=()=>{for(;t.length<n.length;)t.push(P.V);for(;n.length<t.length;)n.push(P.V)};for(let r of e)switch(r.type){case"ADDITION":n.push(r);break;case"DELETION":t.push(r);break;case"CONTEXT":case"INJECTED_CONTEXT":i();let[e,a]=[{...r,threadsData:void 0,annotationsData:void 0},{...r,threadsData:r.threadsData?{...r.threadsData,threads:r.threadsData.threads,totalCommentsCount:r.threadsData.totalCommentsCount,totalCount:r.threadsData.totalCount}:void 0}];t.push(e),n.push(a);break;case"HUNK":i(),t.push(r),n.push(r)}return i(),{leftLines:t,rightLines:n}})(e),[e,t]);return{leftLines:n,rightLines:i}}(l),{ghostUser:w}=K();O({clearSelectedDiffRowRange:i,containerRef:g,fileAnchor:s,isSplitDiff:!0,leftLines:v,replaceSelectedDiffRowRangeFromGridCells:h,rightLines:N,selectedDiffRowRange:p,updateSelectedDiffRowRange:j});let S=(0,d.useMemo)(()=>{if(p)return(0,k.A)({selectedDiffRowRange:p,leftLines:v,rightLines:N})},[p,v,N]);(0,d.useEffect)(()=>{x(s,l)},[l,s,x]);let I=(0,d.useMemo)(()=>b(v),[v]),_=new Map,E=new Map,A=new Map;for(let t=0;t<(e?.length??0);t++){let n=e?.[t];n&&(_.has(n.leftLineNumber)?_.get(n.leftLineNumber)?.push(n):-1!==n.leftLineNumber&&_.set(n.leftLineNumber,[n]),A.has(n.hunkLineNumber)?A.get(n.hunkLineNumber)?.push(n):n.isHunk&&A.set(n.hunkLineNumber,[n]),E.has(n.rightLineNumber)?E.get(n.rightLineNumber)?.push(n):-1!==n.rightLineNumber&&E.set(n.rightLineNumber,[n]))}let R=[];for(let e=0;e<v.length;e++){let i=v[e],l=N[e],h=v[e-1],p=(0,u.Po)(v[e+1])?N[e+1]:v[e+1],g=(0,u.qK)(i)&&"HUNK"===i.type,x=(0,u.qX)(s,i,l),b=(0,u.Po)(i)?(0,u.Po)(l)?void 0:l:i;if(!b)continue;let j=(0,u.Po)(i)?void 0:i.threadsData,k=(0,u.Po)(l)?void 0:l.threadsData,{currentHunk:T,nextHunk:F,previousHunk:O}=y(b,I),P=_.get((0,u.Po)(i)?-2:i.left??-2),$=E.get((0,u.Po)(l)?-2:l.right??-2),M=A.get(b.blobLineNumber),U=M?.[0]?.rightLineNumber===l?.right?n:void 0,B=P?.[0]?.leftLineNumber===i?.left?n:void 0,H=$?.[0]?.rightLineNumber===l?.right?n:void 0,V=e1(i,l,"LEFT"),z=e1(i,l,"RIGHT"),G=D(k,w),K=D(j,w),W={currentHunk:T,diffEntryId:a,fileAnchor:s,fileLineCount:o,filePath:c,isRowSelected:S?.isRowSelected(i)||S?.isRowSelected(l),modifiedLineThreadsConnectionId:k?.__id,nextHunk:F,originalLineThreadsConnectionId:j?.__id,previousHunk:O,rowId:x,isSplit:!0,diffContext:t};R.push((0,r.jsx)(d.Fragment,{children:(0,r.jsx)("tr",{className:"diff-line-row",children:g?(0,r.jsx)(L,{...W,diffLine:b,modifiedLineThreads:G,originalLineThreads:K,children:(0,r.jsx)(tc,{nextLine:p,prevLine:h,focusedSearchResult:U,resultsForLine:M})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(L,{...W,diffLine:i,isLeftSide:!0,children:(0,r.jsx)(tl,{summary:V,copilotChatReferenceData:C,fileAnchor:s,filePath:c,handleDiffRowClick:f,handleDiffSideCellSelectionBlocking:m,resultsForLine:P,focusedSearchResult:B})}),(0,r.jsx)(L,{...W,diffLine:l,children:(0,r.jsx)(tl,{summary:z,copilotChatReferenceData:C,fileAnchor:s,filePath:c,handleDiffRowClick:f,handleDiffSideCellSelectionBlocking:m,resultsForLine:$,focusedSearchResult:H})})]})})},x))}return(0,r.jsx)(r.Fragment,{children:R})});try{tf.displayName||(tf.displayName="SplitDiffLines")}catch{}let tm=(0,d.memo)(function({searchResults:e,diffContext:t="pr",focusedSearchResult:n,clearSelectedDiffRowRange:i,diffEntryId:a,diffLines:l,fileLineCount:o,fileAnchor:c,filePath:f,tableRef:m,selectedDiffRowRange:h,handleDiffRowClick:p,updateDiffLines:g,updateSelectedDiffRowRange:x,replaceSelectedDiffRowRangeFromGridCells:j,copilotChatReferenceData:C}){O({clearSelectedDiffRowRange:i,containerRef:m,fileAnchor:c,isSplitDiff:!1,leftLines:l,replaceSelectedDiffRowRangeFromGridCells:j,selectedDiffRowRange:h,updateSelectedDiffRowRange:x});let v=(0,d.useMemo)(()=>{if(h)return(0,k.A)({selectedDiffRowRange:h,leftLines:l})},[h,l]),N=(0,d.useMemo)(()=>b(l.map(e=>e)),[l]);(0,d.useEffect)(()=>{g(c,l)},[l,c,g]);let w=new Map;for(let t=0;t<(e?.length??0);t++){let n=e?.[t];n&&(e&&w.has(n.diffLineNumIndex)?w.get(n.diffLineNumIndex)?.push(n):e&&w.set(n.diffLineNumIndex,[n]))}let S=l.map((e,i)=>{let m=l[i+1],h=l[i-1],g="HUNK"===e.type,x=(0,s.IQ)(c,(0,s.XU)(e.type),e.blobLineNumber),{currentHunk:b,nextHunk:j,previousHunk:S}=y(e,N),D=w.get(i),k=i===D?.[0]?.diffLineNumIndex?n:void 0,I=e1(e,e,"RIGHT"),_=v?.isRowSelected(e),E=(0,u.qX)(c,e,e),A={diffEntryId:a,diffLine:e,currentHunk:b,fileAnchor:c,fileLineCount:o,filePath:f,isLeftSide:"DELETION"===e.type,isSplit:!1,nextHunk:j,previousHunk:S,diffContext:t};return(0,r.jsx)(d.Fragment,{children:(0,r.jsx)("tr",{className:"diff-line-row",children:(0,r.jsx)(L,{...A,isRowSelected:_,rowId:E,children:g?(0,r.jsx)(tc,{nextLine:m,prevLine:h,focusedSearchResult:k,resultsForLine:D},i):(0,r.jsx)(ts,{filePath:f,copilotChatReferenceData:C,handleDiffRowClick:p,lineAnchor:x,resultsForLine:D,focusedSearchResult:k,summary:I},i)})})},i)});return(0,r.jsx)(r.Fragment,{children:S})});try{tm.displayName||(tm.displayName="UnifiedDiffLines")}catch{}let th={tableLayoutFixed:"DiffLines-module__tableLayoutFixed--YZcIJ",compact:"DiffLines-module__compact--wEEom"};var tp=n(97156);function tg({diffAnchor:e,children:t}){return(0,r.jsx)("div",{className:"fgColor-muted p-2","data-diff-anchor":e,children:t})}let tx=(0,d.memo)(function({searchResults:e,diffContext:t="pr",focusedSearchResult:n,diffEntryData:i,diffLinesManuallyUnhidden:m,baseHelpUrl:h,onHandleLoadDiff:x,copilotChatReferenceData:y,...b}){let j=(0,d.useRef)(null),[C,v]=(0,d.useState)(null),w=i.newTreeEntry?.lineCount??i.oldTreeEntry?.lineCount??0,L=(0,d.useMemo)(()=>{let e=i.diffLines[i.diffLines.length-1];return e?.blobLineNumber&&e.blobLineNumber<w?i.diffLines.concat({__id:g.finalLineId,blobLineNumber:e.blobLineNumber+1,left:null,right:null,type:"HUNK",html:"",text:""}):i.diffLines},[i.diffLines,w]),{diffViewPreference:S,lineSpacingPreference:D,tabSizePreference:k}=b.viewerData,{selectedDiffRowRange:I,replaceSelectedDiffRowRange:_,replaceSelectedDiffRowRangeFromGridCells:E,clearSelectedDiffRowRange:A,updateDiffLines:R,updateSelectedDiffRowRange:T}=(0,c.o)(),F=`diff-${i.pathDigest}`,O=F===I?.diffAnchor;(0,d.useEffect)(()=>{if(!O)return;let e=(0,u.On)(I,L);e&&e!==I&&_(e)},[L,I,O,_]);let P=tp.cg?.location.search,$=(0,d.useMemo)(()=>"split"===new URLSearchParams(P).get("diff")||"split"===S,[P,S]),M=(0,s.c7)(L),U=(0,d.useCallback)(e=>{v(e)},[v]),B=(0,d.useCallback)((e,t,n,i)=>{!function(e){let t=document.getElementById("__primerPortalRoot__");return!!t&&!!e&&t.contains(e)}(e.target)&&(e.defaultPrevented||T(F,t,n,i))},[F,T]);if(i.isBinary)return(0,r.jsx)(tg,{diffAnchor:F,children:"Binary file not shown."});if((0,a.dK)(i))return(0,r.jsx)(tg,{diffAnchor:F,children:"File renamed without changes."});if((0,a.Jc)(i))return(0,r.jsx)(tg,{diffAnchor:F,children:"File copied without changes."});if((0,a._$)(i.status,i.oldTreeEntry?.mode,i.newTreeEntry?.mode))return(0,r.jsx)(tg,{diffAnchor:F,children:"File mode changed."});if((0,a.HI)(i))return(0,r.jsx)(tg,{diffAnchor:F,children:(0,a.l_)(i.truncatedReason)});if((0,a.s8)(i))return(0,r.jsx)(tg,{diffAnchor:F,children:"Whitespace-only changes."});if(!m&&(0,a.lO)(i))return(0,r.jsx)(p,{diffAnchor:F,onLoadDiff:x,children:"This file was deleted."});if(!m&&(0,a.xW)(i))return(0,r.jsxs)(p,{diffAnchor:F,helpText:"customizing how changed files appear on GitHub.",helpUrl:`${h}/github/administering-a-repository/customizing-how-changed-files-appear-on-github`,onLoadDiff:x,children:["Some generated files are not rendered by default. Learn more about"," "]});if(i.isTooBig){if("commit"===t&&0===i.diffLines.length)return m?(0,r.jsxs)(tg,{diffAnchor:F,children:["Diff is too big to render. To view,"," ",(0,r.jsx)(o.A,{inline:!0,href:`${h}/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally`,children:"check out this pull request locally."})]}):(0,r.jsx)(p,{diffAnchor:F,onLoadDiff:x,children:"Large diffs are not rendered by default."});if("pr"===t)return i.diffLines.length>0?(0,r.jsx)(p,{diffAnchor:F,onLoadDiff:x,children:"Large diffs are not rendered by default."}):(0,r.jsxs)(tg,{diffAnchor:F,children:["Diff is too big to render. To view,"," ",(0,r.jsx)(o.A,{inline:!0,href:`${h}/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally`,children:"check out this pull request locally."})]})}let H={searchResults:e,diffContext:t,focusedSearchResult:n,clearSelectedDiffRowRange:A,diffEntryId:i.objectId,diffLines:L,fileAnchor:F,fileLineCount:w,filePath:i.path,handleDiffRowClick:B,handleDiffSideCellSelectionBlocking:U,replaceSelectedDiffRowRangeFromGridCells:E,selectedDiffRowRange:O?I:null,tableRef:j,updateDiffLines:R,updateSelectedDiffRowRange:T,copilotChatReferenceData:y};return i.diffLines?(0,r.jsxs)(G,{...b,children:[O&&(0,r.jsx)(N,{selectedLineRange:I,tableRef:j}),(0,r.jsx)("table",{ref:j,className:(0,f.$)("tab-size","width-full",th.tableLayoutFixed,{[th.compact]:"compact"===D}),"data-block-diff-cell-selection":C,"data-diff-anchor":F,"data-tab-size":k,"data-paste-markdown-skip":!0,role:"grid",style:{"--line-number-cell-width":`${M}px`},children:$?(0,r.jsx)(l.wj,{lineWidth:M,children:(0,r.jsx)(tf,{...H})}):(0,r.jsx)(l.Qe,{lineWidth:M,children:(0,r.jsx)(tm,{...H})})})]}):null});try{tg.displayName||(tg.displayName="PlainTextStatus")}catch{}try{tx.displayName||(tx.displayName="DiffLines")}catch{}var ty=n(62353),tb=n(3121),tj=n(67749),tC=n(30729);let tv={visibilityHidden:"DiffFindPopover-module__visibilityHidden--HCMWu",visibilityVisible:"DiffFindPopover-module__visibilityVisible--AknNV",defaultStyles:"DiffFindPopover-module__defaultStyles--IjqxB",stickyStyles:"DiffFindPopover-module__stickyStyles--oNP5J",notStickyStyles:"DiffFindPopover-module__notStickyStyles--_E6rW"},tN=(0,d.memo)(function({inputContainer:e,currentPathDigestIndex:t,stickied:n,searchTerm:i,searchResults:a,setSearchTerm:l,focusedSearchResult:s,currentIndex:o,setCurrentIndex:c,setFocusedSearchResult:u,onClose:m,scrollDiffCellIntoView:h}){let{findInFileShortcut:p}=(0,ty.wk)(),[g,x]=(0,d.useState)(!0),y=(0,d.useRef)([]),b=(0,d.useRef)(0),j=()=>{l(""),u(void 0),t.current=0},C=e=>{if(void 0===s||""===s.pathDigest){t.current=0,u({pathDigest:y.current[0]??"",indexWithinDigest:0});return}1===e?(c(o===b.current-1?0:o+1),s.indexWithinDigest===a.get(s.pathDigest).length-1?(t.current=t.current+1,t.current===y.current.length&&(t.current=0),s.pathDigest=y.current[t.current]??"",s.indexWithinDigest=0):s.indexWithinDigest=s.indexWithinDigest+1):(c(0===o?b.current-1:o-1),0===s.indexWithinDigest?(t.current=t.current-1,-1===t.current&&(t.current=y.current.length-1),s.pathDigest=y.current[t.current]??"",s.indexWithinDigest=a.get(s.pathDigest).length-1):s.indexWithinDigest=s.indexWithinDigest-1),u(s)};return(0,d.useEffect)(()=>{e.current?.focus(),e.current?.select()},[e]),(0,d.useEffect)(()=>{y.current=Array.from(a.keys()),t.current=0,u({pathDigest:y.current[0]??"",indexWithinDigest:0});let e=0;for(let t of a.values())e+=t.length;b.current=e},[t,a,a.size,u]),(0,d.useEffect)(()=>{a.size>0&&void 0!==s&&h(s)},[a,s,o]),(0,r.jsxs)("div",{className:(0,f.$)(tv.defaultStyles,n&&tv.stickyStyles,!n&&tv.notStickyStyles),children:[(0,r.jsx)(B.ak,{commands:{"pull-requests-diff-view:jump-to-next-result-alternate":()=>C(1),"pull-requests-diff-view:jump-to-previous-result-alternate":()=>C(-1),"pull-requests-diff-view:close-find":m}}),(0,r.jsxs)(B.tL,{commands:{"pull-requests-diff-view:jump-to-next-result":()=>C(1),"pull-requests-diff-view:jump-to-previous-result":()=>C(-1)},children:[(0,r.jsxs)("div",{className:"py-2 pl-3 pr-2 d-flex flex-justify-center flex-items-center flex-row f6 borderColor-default border-bottom",children:[(0,r.jsxs)("div",{className:"d-flex flex-row flex-items-baseline",children:[(0,r.jsx)("h5",{className:"fgColor-default pr-2 text-bold",children:"Find"}),(0,r.jsxs)("span",{className:(0,f.$)("find-text-help-tooltip","fgColor-subtle",g&&tv.visibilityVisible,!g&&tv.visibilityHidden),children:["Press ",(0,r.jsx)(tb.A,{children:p.text})," again to open the browser's find menu"]})]}),(0,r.jsx)("div",{className:"flex-1"}),(0,r.jsx)(ed.K,{unsafeDisableTooltip:!0,variant:"invisible",size:"small",onClick:m,icon:V.XIcon,className:"fgColor-subtle","aria-label":"Close find in file"})]}),(0,r.jsx)("div",{className:"pl-2 pr-2 pt-2 pb-2",children:(0,r.jsx)(tj.A,{ref:e,className:"pl-1 border-0 box-shadow-none",validationStatus:b.current>1e3?"error":void 0,type:"text",leadingVisual:()=>(0,r.jsx)(tC.A,{icon:V.SearchIcon,"aria-hidden":"true"}),autoComplete:"off",name:"Find in file input",placeholder:"Search this diff",value:i,block:!0,onChange:e=>{e.target.value?(x(!1),l(e.target.value),c(0)):(x(!0),j())},trailingAction:(0,r.jsxs)("div",{className:"d-flex flex-row flex-justify-center flex-items-center",children:[(0,r.jsxs)("span",{className:"text-small fgColor-subtle m-2 text-center",children:[0===a.size||void 0===s?0:o+1,"/",b.current]}),(0,r.jsx)(ed.K,{unsafeDisableTooltip:!0,size:"small",variant:"invisible",onClick:()=>{C(-1)},icon:V.ChevronUpIcon,"aria-label":"Up","data-testid":"up-search",className:"fgColor-subtle"}),(0,r.jsx)(ed.K,{unsafeDisableTooltip:!0,size:"small",variant:"invisible",onClick:()=>{C(1)},icon:V.ChevronDownIcon,"aria-label":"Down","data-testid":"down-search",className:"fgColor-subtle"})]}),onKeyDown:t=>{(t.metaKey||t.ctrlKey)&&("f"===t.key||"F"===t.key)&&(g?m():(x(!0),t.preventDefault(),e.current?.focus(),e.current?.select()))}})})]})]})});try{tN.displayName||(tN.displayName="DiffFindPopover")}catch{}var tw=n(59972);function tL({dependencyDiffPath:e,fileRendererInfo:t,proseDiffHtml:n,loading:i}){return i?(0,r.jsx)("div",{className:"d-flex flex-justify-center p-4",children:(0,r.jsx)(eb.A,{size:"large"})}):n?(0,r.jsx)("div",{className:"prose-diff position-relative",children:(0,r.jsx)(U.oG,{html:n})}):t?(0,r.jsx)(tw.default,{...t}):e?(0,r.jsx)("include-fragment",{src:e,children:(0,r.jsxs)("div",{className:"text-center py-3",children:[(0,r.jsx)(eb.A,{size:"medium"}),(0,r.jsx)("p",{className:"color-fg-muted my-2",children:"Loading Dependency Review..."})]})}):(0,r.jsx)("div",{className:"d-flex flex-justify-center p-4",children:"This rich diff is not supported at the moment."})}try{tL.displayName||(tL.displayName="RichDiff")}catch{}let tS=(0,d.createContext)({diffFindOpen:!1,setDiffFindOpen:()=>void 0});function tD({children:e,searchTerm:t,setSearchTerm:n}){let i=(0,d.useRef)(""),[a,l]=(0,d.useState)(!1),s=(0,d.useCallback)(e=>{e&&""===t&&""!==i.current?n(i.current):e||""===t||(i.current=t,n("")),l(e)},[t,n]),o=(0,d.useMemo)(()=>({diffFindOpen:a,setDiffFindOpen:s}),[a,s]);return(0,r.jsx)(tS.Provider,{value:o,children:e})}function tk(){return(0,d.useContext)(tS)}try{tS.displayName||(tS.displayName="DiffFindOpenContext")}catch{}try{tD.displayName||(tD.displayName="DiffFindOpenProvider")}catch{}var tI=n(76515),t_=n(37363),tE=n(76391);function tA({data:e}){let{query:t,diffEntryInfo:n,currentDiffEntryData:i}=e;return{matchingDiffs:i?function(e,t,n){if(0===n.size)return new Map;let i=n.size>=200,r={},a=e.reduce((n,i,a)=>{if(r[a])return n;r[a]=!0;let l=tT(t,[e[a]]),s=l.next();for(;!s.done&&n.size<200;){let{resultsWithinDiff:t}=s.value;n.set(e[a]?.pathDigest??"",t),s=l.next()}return n},new Map);if(a.size<200&&i){let n=tT(t,e,a.size),i=n.next();for(;!i.done&&a.size<200;){let{resultsWithinDiff:t,diff:r}=i.value;a.set(e[r]?.pathDigest??"",t),i=n.next()}}return a}(n,tR(t),i):function(e,t){let n=new Map,i=tT(t,e),r=i.next();for(;!r.done&&n.size<200;){let{resultsWithinDiff:t,diff:a}=r.value;n.set(e[a]?.pathDigest??"",t),r=i.next()}return n}(n,tR(t)),query:t}}function tR(e){return{kind:0,regexp:RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi")}}function*tT(e,t,n=0){for(let i=n;i<t.length;i++){let n=t[i],r=[],a=0;for(let l=0;l<n.diffLines.length;l++){let s,o;s=t[i]?.diffLines[l]?.type==="HUNK"?n.diffLines[l]?.text:n.diffLines[l]?.text?.substring(1);let d=n.diffLines[l];for(;s&&null!==(o=e.regexp.exec(s));){let e=o[0],t=o.index;r.push({pathDigest:n.pathDigest,indexWithinPathDigest:a,matchContent:e,column:t,diffLineNumIndex:l,isHunk:d?.type==="HUNK",hunkLineNumber:d?.blobLineNumber??-1,leftLineNumber:d?.type!=="ADDITION"?d?.left??-1:-1,rightLineNumber:d?.type!=="DELETION"?d?.right??-1:-1,columnEnd:t+e.length,text:s}),a++}}0!==r.length&&(yield{diff:i,resultsWithinDiff:r})}}function tF(e,t,n,i){let[r,a]=(0,d.useState)(new Map),[l,s]=(0,d.useState)(void 0),[o,c]=(0,d.useState)(0),u=d.useRef();!u.current&&t&&(u.current=new tE.N(new t_.z(n,tA),200,e=>1!==e.query.length));let f=(0,d.useRef)(t);f.current=t;let m=(0,d.useRef)("");(0,d.useEffect)(()=>function(){u.current?.terminate()},[]);let h=(0,d.useRef)([]);return u.current&&e!==h.current&&(u.current.onResponse=e=>{e.query===f.current&&(a(e.matchingDiffs),m.current=f.current)},h.current=e),(0,d.useEffect)(()=>{if(!e||!u.current||!m.current||""===m.current){a(new Map),s(void 0);return}a(new Map),s(void 0),u.current.post({query:m.current,diffEntryInfo:e,currentDiffEntryData:void 0})},[e?.length,e]),(0,d.useEffect)(()=>{if(e&&u.current){if(""===t)a(new Map),s(void 0),c(0),m.current="";else{if(!(t.length>0&&t.length<=1e3))return;let n=m.current.length>0&&t.startsWith(m.current);u.current.post({query:t,diffEntryInfo:e,currentDiffEntryData:n?r:void 0}),c(0)}}},[t,i]),{focusedSearchResult:l,setFocusedSearchResult:s,searchResults:r,currentIndex:o,setCurrentIndex:c}}!function(e){e[e.Text=0]="Text",e[e.Symbol=1]="Symbol"}(i||(i={}))},77321:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(51888),r=n(9393);function a({selectedDiffRowRange:e,leftLines:t,rightLines:n}){let a=!!n,{startOrientation:l,endOrientation:s}=e;if(e.startLineNumber===e.endLineNumber&&e.startOrientation===e.endOrientation)return{isRowSelected:()=>!1,selectedRightLines:[],selectedLeftLines:[]};let o=f(l).findIndex(t=>(0,r.a2)(t,e.startLineNumber,e.startOrientation)),d=f(s).findIndex(t=>(0,r.a2)(t,e.endLineNumber,e.endOrientation)),c=o>=0&&d>=0;function u(e){if(!c||(0,r.Po)(e))return!1;let t=f((0,i.XU)(e.type)).indexOf(e);return t>=o&&t<=d}function f(e){return a&&"left"!==("string"==typeof e?e:(0,i.XU)(e.type))?n:t}let m=f("left").filter(e=>u(e)),h=f("right").filter(e=>u(e));return{isRowSelected:u,selectedRightLines:h,selectedLeftLines:m}}},76515:(e,t,n)=>{function i(e,t){return`${"left"===t?"L":"R"}${e}`}function r(e){let t=e.match(/^#?(diff-[a-f0-9]+)/);return t?.[1]}function a(e){let t=e.match(/^#?(r\d+)/),n=t?.[1];return n?parseInt(n.slice(1)):void 0}function l(e){let t=e.match(/^#annotation_(\d+)/),n=t?.[1];return n?parseInt(n):void 0}function s(e){let t=function(e){let t=e.match(/^#?(diff-[a-f0-9]+)(L|R)(\d+)(?:-(L|R)(\d+))?$/i);if(null!=t&&6===t.length)return t;let n=e.match(/^#?(discussion-diff-[0-9]+)(L|R)(\d+)(?:-(L|R)(\d+))?$/i);return null!=n&&6===n.length?n:null}(e);if(t){let e=t[1],n=t[2]?"L"===t[2]?"left":"right":void 0,i=t[3]?parseInt(t[3]):void 0;if(!e||!n||void 0===i)return;return{diffAnchor:e,startOrientation:n,startLineNumber:i,endOrientation:(t[4]?"L"===t[4]?"left":"right":void 0)??n,endLineNumber:(t[5]?parseInt(t[5]):void 0)??i,firstSelectedLineNumber:i,firstSelectedOrientation:n}}}function o(e){c(d(e))}function d(e){let t=i(e.startLineNumber,e.startOrientation),n=`${e.diffAnchor}${t}`;if(e.endLineNumber!==e.startLineNumber||e.endOrientation!==e.startOrientation){let t=i(e.endLineNumber,e.endOrientation);n+=`-${t}`}return n}function c(e){let t=`#${e}`;if(t===window.location.hash)return;let n=window.location.href;history.replaceState({...history.state},"",t),window.dispatchEvent(new HashChangeEvent("hashchange",{newURL:window.location.href,oldURL:n}))}n.d(t,{Dd:()=>a,N0:()=>l,ZD:()=>s,i8:()=>o,j$:()=>d,pd:()=>r,pk:()=>c})},9393:(e,t,n)=>{n.d(t,{Ji:()=>m,Ls:()=>w,Mk:()=>p,On:()=>o,Po:()=>u,S4:()=>b,YY:()=>j,ZC:()=>g,_S:()=>h,a1:()=>N,a2:()=>s,j2:()=>x,oE:()=>C,pI:()=>y,qK:()=>f,qX:()=>d,u6:()=>c});var i=n(51888),r=n(12480),a=n(6024),l=n(76515);function s(e,t,n){return"left"===n?!u(e)&&e.left===t:!u(e)&&(0,i.XU)(e.type)===n&&e.right===t}function o(e,t){if(!e)return;if(!t)return e;let n=!1,i=!1,r=!1;for(let a of t)if(a&&(i||(i=s(a,e.startLineNumber,e.startOrientation)),r||(r=s(a,e.endLineNumber,e.endOrientation)),(n=r&&!i)||i&&r))break;return n?{...e,startLineNumber:e.endLineNumber,startOrientation:e.endOrientation,endLineNumber:e.startLineNumber,endOrientation:e.startOrientation,firstSelectedLineNumber:e.endLineNumber}:e}function d(e,t,n){let i=`-${u(t)||"number"!=typeof t.left?"empty":t.left}`,r=n?`-${u(n)||"number"!=typeof n.right?"empty":n.right}`:"";return`${e}${i}${r}`}function c(e,t){return`${e}-${t}`}function u(e){return!!e&&e===a.V}function f(e){return!!e&&e!==a.V}function m(e){return"CONTEXT"===e.type}function h(e,t){let n;switch(t){case"ADDITION":n="+";break;case"DELETION":n="-";break;case"CONTEXT":case"INJECTED_CONTEXT":n=" "}if(!n||!e.startsWith(n))return[e,void 0];let i=e[0];return[e.substring(1),i]}function p(e){let t=[],n=[],i=()=>{for(;t.length<n.length;)t.push(a.V);for(;n.length<t.length;)n.push(a.V)};for(let r of e)switch(r.type){case"ADDITION":n.push(r);break;case"DELETION":t.push(r);break;case"CONTEXT":case"INJECTED_CONTEXT":case"HUNK":i(),t.push(r),n.push(r)}return i(),{leftLines:t,rightLines:n}}function g(e){return new DOMParser().parseFromString(e,"text/html").documentElement.textContent||""}function x({line:e,range:t,fileAnchor:n}){let i;let{origin:r,pathname:a}=window.location;if(t?i=(0,l.j$)(t):e&&(i=function(e,t){let n=["HUNK","CONTEXT","INJECTED_CONTEXT","DELETION"].includes(e.type),i=n?e.left:e.right,r=n?"left":"right";if(null!==i)return(0,l.j$)({diffAnchor:t,endLineNumber:i,endOrientation:r,startLineNumber:i,startOrientation:r,firstSelectedLineNumber:i,firstSelectedOrientation:r})}(e,n)),i)return`${r}${a}#${i}`}function y({includeControlKey:e=!0,includeShiftKey:t,includeOptionKey:n,key:i}){let a=e?`${(0,r.U0)()?"\u2318":"Ctrl + "}`:"";return n&&(a+=`${(0,r.U0)()?"\u2325":"Alt + "}`),t&&(a+=`${(0,r.U0)()?"\u21E7":"Shift + "}`),a+=i}function b({hasThreads:e}){return e?"96px":"30px"}function j({shouldAlignRight:e,lineSpacingPreference:t}){return e?"compact"===t?"12px":"11px":"40px"}function C({includeControlKey:e=!0,includeShiftKey:t,includeOptionKey:n,key:i}){let a="";return e&&(a+=(0,r.U0)()?"Command+":"Control+"),n&&(a+=(0,r.U0)()?"Option+":"Alt+"),t&&(a+="Shift+"),a+=i}let v=["ADDITION","DELETION","CONTEXT"],N=(e,t)=>{if(!e)return!1;let n=t.leftLines.concat(t.rightLines);return n.length>0&&n.includes(e)?n.every(e=>!u(e)&&v.includes(e.type)):!u(e)&&v.includes(e.type)},w=e=>e?e.filter(e=>!u(e)).map(e=>{let[t]=h(g(e.html),e.type);return t}).join("\n"):""},30841:(e,t,n)=>{n.d(t,{K:()=>a});var i=n(51012),r=n(96540);let a=e=>{let t=(0,r.useRef)(e);return(0,i.N)(()=>(t.current=e,()=>t.current=null),[e]),(0,r.useCallback)((...e)=>t.current?.(...e),[])}},52019:(e,t,n)=>{n.d(t,{S:()=>c,n:()=>d});var i=n(96540),r=n(50990),a=n(9393),l=n(71312),s=n(30841),o=n(76919);function d(e){let t=(0,o.Lm)(e),n=(e.subject?.diffLines??[]).filter(e=>t?e.left&&e.left>=t.startLineNumber&&e.left<=t.endLineNumber||e.right&&e.right>=t.startLineNumber&&e.right<=t.endLineNumber:[]),i=n.every(e=>"DELETION"!==e.type),r=n?.map(e=>a._S(e.text,e.type)[0]).join("\n");return{isValidSuggestionRange:n.length>0&&!!i,showSuggestChangesButton:!1,sourceContentFromDiffLines:r,onInsertSuggestedChange:()=>{},shouldInsertSuggestedChange:!1}}function c(e,t,n){let{sendAnalyticsEvent:o}=(0,l.s)(),{getDiffLinesFromLineRange:d,selectedDiffRowRange:c}=(0,r.o)(),u=(0,s.K)(function(n,i){if(!e)return;let r=function(e){if(!e)return"DELETION"!==t.type;if("right"===e.startOrientation&&"right"===e.endOrientation)return!0;if(e.startLineNumber===e.endLineNumber&&e.startOrientation===e.endOrientation)return"DELETION"!==t.type;let n=d(e)?.selectedLeftLines;return!!n?.every(e=>"empty-diff-line"!==e&&"DELETION"!==e.type)}(n);return{isValidSuggestionRange:r,showSuggestChangesButton:r,sourceContentFromDiffLines:r?function(e){let n=d(e)?.selectedRightLines;if(e&&n&&n.length>1)return(0,a.Ls)(n);if(!t)return"";let[i]=(0,a._S)(t.text,t.type);return i}(n):void 0,onInsertSuggestedChange:()=>{o("diff.add_suggested_change","ADD_SUGGESTED_CHANGE_BUTTON")},shouldInsertSuggestedChange:i}});return(0,i.useMemo)(()=>({selectedDiffRowRange:c,configureSuggestedChangesFromLineRange:u,shouldStartNewConversationWithSuggestedChange:n}),[c,u,n])}},6024:(e,t,n)=>{n.d(t,{V:()=>i});let i="empty-diff-line"},69144:(e,t,n)=>{n.d(t,{L:()=>r});var i=n(96540);function r(e){(0,i.useEffect)(()=>{if(!e)return;let t=document.querySelector(".footer");if(t)return t.hidden=!0,()=>{t.hidden=!1}},[e])}},84928:(e,t,n)=>{n.d(t,{W:()=>a});var i=n(96540),r=n(20826);function a(e,t){let n=(0,r.H)(e,t);return(0,i.useCallback)(async i=>{let r=t;if(!n)throw Error(`No authenticity token found for method ${r} and path ${e}`);return i||(i={}),l(i,"X-Requested-With","XMLHttpRequest"),i.body instanceof URLSearchParams&&"delete"===r&&(i.body.append("_method","delete"),r="post"),i.body instanceof URLSearchParams||i.body instanceof FormData?i.body.append("authenticity_token",n):l(i,"Scoped-CSRF-Token",n),await fetch(e,{...i,method:r})},[e,t,n])}function l(e,t,n){e.headers??(e.headers=new Headers);let i=e.headers;if(i instanceof Headers)i.set(t,n);else if(Array.isArray(i)){let e=i.findIndex(([e])=>e===t);-1===e?i.push([t,n]):i[e]=[t,n]}else i[t]=n}},41631:(e,t,n)=>{n.d(t,{Y:()=>l,h:()=>o});var i=n(96540),r=n(35822);let a=e=>e;function l(e){let t=i.useRef({}),n=i.useRef({}),l=(e,n)=>{t.current[e](n)},s=i.useRef(l);s.current=l;let o=i.useRef(new ResizeObserver(e=>{for(let t of e){let e=t.target,n="data-key",i=e.getAttribute(n);if(null===i)throw Error(`Value not found, for '${n}' attribute`);s.current(i,e)}}));i.useEffect(()=>{let e=o.current;return()=>{e.disconnect()}},[]);let{size:d,keyExtractor:c=a}=e,u=i.useMemo(()=>{let e=e=>t=>{n.current[e]&&o.current.unobserve(n.current[e]),t&&(s.current(e,t),o.current.observe(t)),n.current[e]=t},t={};for(let n=0;n<d;n++){let i=c(n);t[i]=e(i)}return t},[d,c]),f=(0,r.z)(e),m=f.virtualItems.map(e=>(t.current[e.key]=e.measureRef,{...e,measureRef:u[e.key]}));return{...f,virtualItems:m}}var s=n(51012);function o({additionalScrollOffset:e=0,scrollToFn:t,horizontal:n,parentRef:a,useVirtualImpl:l=r.z,...o}){let d=(0,i.useRef)(window),c=(0,i.useCallback)(()=>{let e=a.current?.getBoundingClientRect(),t=e?.top??0,i=e?.left??0;return n?-1*i:-1*t},[n,a]),u=(0,i.useCallback)(t=>{let i=t+((a.current?.getBoundingClientRect().top??0)+window.scrollY)+e;d.current?.scroll({top:n?0:i,left:n?i:0})},[e,n,a]);return l({...o,horizontal:n,parentRef:a,scrollToFn:t||u,onScrollElement:d,scrollOffsetFn:c,useObserver:()=>(function(e){let[t,n]=(0,i.useState)({height:0,width:0}),r=e.current;return(0,s.N)(()=>{if(!r)return;let e=()=>{let e={height:r.innerHeight,width:r.innerWidth};n(t=>t.height!==e.height||t.width!==e.width?e:t)};return e(),r.addEventListener("resize",e),()=>{r.removeEventListener("resize",e)}},[r]),t})(d)})}},52876:(e,t,n)=>{n.d(t,{T:()=>b});var i=n(74848),r=n(22868),a=n(38621),l=n(89323),s=n(75177),o=n(16823),d=n(67749),c=n(38553),u=n(65481),f=n(30729),m=n(96540),h=n(76024);let p=m.memo(function({user:e,isCurrent:t,onSelect:n}){return(0,i.jsxs)(o.l.Item,{selected:t,onSelect:()=>{n&&n(e)},children:[(0,i.jsx)(o.l.LeadingVisual,{children:(0,i.jsx)(r.r,{src:e.primaryAvatarUrl,square:e.path.startsWith("/apps/")})}),e.login,(0,i.jsx)(o.l.Description,{children:e.name})]})});try{p.displayName||(p.displayName="UserItem")}catch{}function g(e){return e.users.length>20?(0,i.jsx)(y,{...e}):(0,i.jsx)(x,{...e})}function x({users:e,currentUser:t,onSelect:n,sx:r={}}){return(0,i.jsx)(s.A,{sx:{maxHeight:330,overflowY:"auto",...r},children:e.map(e=>(0,i.jsx)(p,{user:e,isCurrent:e.login===t?.login,onSelect:n},e.login))})}function y({users:e,currentUser:t,onSelect:n,sx:r={}}){return(0,i.jsx)(h.F,{items:e,itemHeight:33,sx:{maxHeight:330,overflowY:"auto",...r},makeKey:e=>e.login,renderItem:e=>(0,i.jsx)(p,{user:e,isCurrent:e.login===t?.login,onSelect:n},e.login)})}try{g.displayName||(g.displayName="UsersList")}catch{}try{x.displayName||(x.displayName="FullUsersList")}catch{}try{y.displayName||(y.displayName="VirtualUsersList")}catch{}function b(e){let{defaultText:t,usersState:n,currentUser:d,onSelect:c,hotKey:u,onOpenChange:h,renderCustomFooter:p,size:x,showTypedInUser:y=!1,width:b="large",label:w=""}=e,[L,S]=(0,m.useState)(""),D=function(e,t){if(!e)return[];let n=t.trim().toLowerCase();return n?e.filter(e=>e.login.toLowerCase().includes(n)||e.name?.toLowerCase().includes(n)):e}(n.users,L);return(0,i.jsx)("div",{children:(0,i.jsxs)(l.W,{onOpenChange:h,children:[(0,i.jsx)(l.W.Button,{"data-hotkey":u,size:x,"data-testid":"user-selector-button",children:(0,i.jsxs)(s.A,{sx:{display:"flex"},children:[(0,i.jsx)(s.A,{sx:{mr:2},children:d?(0,i.jsx)(r.r,{size:16,src:d.primaryAvatarUrl,square:d.path.startsWith("/apps/")}):(0,i.jsx)(f.A,{icon:a.PeopleIcon,size:"small",sx:{color:"fg.muted"}})}),(0,i.jsx)(s.A,{sx:{maxWidth:125,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:d?(0,i.jsxs)("span",{children:[w,d.login]}):(0,i.jsx)("span",{children:t})})]})}),(0,i.jsx)(l.W.Overlay,{width:b,children:(0,i.jsxs)(o.l,{showDividers:!0,selectionVariant:"single",children:[(0,i.jsx)(j,{defaultText:L,onFilterChange:S}),(0,i.jsx)(o.l.Divider,{}),n.loading?(0,i.jsx)(C,{}):n.error?(0,i.jsx)(v,{}):0===D.length?(0,i.jsx)(N,{showTypedInUser:y,filterText:L,onSelect:c}):(0,i.jsx)(g,{users:D,currentUser:d,onSelect:c,sx:p?{pb:"10px",pt:1}:{pt:1}}),p&&(0,i.jsx)(o.l.Divider,{sx:{marginTop:0}}),p?.()]})})]})})}function j({onFilterChange:e,defaultText:t}){return(0,i.jsx)(o.l.Group,{sx:{px:2},children:(0,i.jsx)(d.A,{leadingVisual:a.SearchIcon,value:t,sx:{width:"100%"},placeholder:"Find a user...",onChange:t=>e(t.target.value)})})}function C(){return(0,i.jsx)(s.A,{sx:{display:"flex",justifyContent:"center",p:2},children:(0,i.jsx)(c.A,{size:"medium","aria-label":"Loading users..."})})}function v(){return(0,i.jsx)(u.A,{variant:"danger",children:"Could not load users"})}function N({showTypedInUser:e,filterText:t,onSelect:n}){return e?(0,i.jsx)(o.l.Item,{sx:{display:"flex",justifyContent:"center",mb:2},onSelect:()=>{n&&n({login:t,name:t,path:"",primaryAvatarUrl:""})},children:(0,i.jsxs)(i.Fragment,{children:["Filter on author\xa0",(0,i.jsx)(s.A,{as:"span",sx:{fontWeight:600},children:t})]})}):(0,i.jsx)(s.A,{sx:{p:3,display:"flex",justifyContent:"center"},children:"Nothing to show"})}try{b.displayName||(b.displayName="UserSelector")}catch{}try{j.displayName||(j.displayName="UserFilter")}catch{}try{C.displayName||(C.displayName="Loading")}catch{}try{v.displayName||(v.displayName="LoadingFailed")}catch{}try{N.displayName||(N.displayName="UsersZeroState")}catch{}},93461:(e,t,n)=>{n.d(t,{R:()=>s});var i=n(74848),r=n(36909),a=n(22706),l=n(23449);function s({hideActions:e,lazyFetchEditHistory:t=!1,...n}){let s=null;return s=t?(0,i.jsx)(r.$N,{id:n.comment.id}):(0,i.jsx)(r.WT,{editHistory:n.comment}),(0,i.jsx)(a.v,{...n,actions:e?void 0:(0,i.jsx)(l.p,{...n,editHistoryComponent:s})})}try{s.displayName||(s.displayName="CommentHeader")}catch{}},71078:(e,t,n)=>{n.d(t,{M:()=>u});var i=n(74848),r=n(47529),a=n(67726),l=n(38621),s=n(67749),o=n(59572),d=n(7512);let c={timeout:{description:"Try reloading the page, or if the problem persists, view the history locally using this command:",heading:"Commit history cannot be loaded",icon:(0,i.jsx)(l.AlertIcon,{size:"medium",className:"mb-2 fgColor-muted"}),showTextInput:!0},unavailable:{description:"There isn't any commit history to show here.",heading:"No commits history",icon:(0,i.jsx)(l.GitCommitIcon,{size:"medium"}),showTextInput:!1}};function u({timeoutMessage:e,unavailableMessage:t}){let n=c[""!==e?"timeout":"unavailable"],u=t??n.description;return(0,i.jsx)(d.Z,{children:(0,i.jsx)("div",{"data-hpc":!0,children:(0,i.jsxs)(o.A,{border:!1,spacious:!0,children:[(0,i.jsx)(o.A.Visual,{children:n.icon}),(0,i.jsx)(o.A.Heading,{children:n.heading}),(0,i.jsx)(o.A.Description,{children:u}),n.showTextInput&&(0,i.jsx)(s.A,{"aria-label":"View commit history locally command",className:"d-flex flex-justify-center mt-2",monospace:!0,onChange:a.l,readOnly:!0,size:"large",trailingAction:(0,i.jsx)(s.A.Action,{onClick:()=>(0,r.D)(e),icon:l.CopyIcon,"aria-label":"Copy to clipboard",className:"fgColor-muted"}),value:e})]})})})}try{u.displayName||(u.displayName="CommitsBlankState")}catch{}},83994:(e,t,n)=>{n.d(t,{GF:()=>d,S:()=>o,Xh:()=>l});var i=n(74848),r=n(10619),a=n(35993);function l({annotationLevel:e,...t}){let{icon:n,...r}=d[e];return function({fill:e,stroke:t,ariaLabel:n,svgHtml:r,className:a}){return(0,i.jsx)("svg",{"aria-label":n,className:a,fill:e,height:"24",stroke:t,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",style:{boxShadow:"none"},viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:r})}({...n,...r,...t})}let s=(0,r.i7)(["0%{opacity:0;}100%{opacity:1;}"]),o=(0,r.Ay)(l).withConfig({displayName:"AnnotationIcon__AnimatedAnnotationIcon",componentId:"sc-306ab24a-0"})(["animation:"," 0.1s ease-in;"],s),d={[a.U.Failure]:{priority:1,ariaLabel:"Check failure",primaryColor:"danger.fg",icon:{fill:"var(--bgColor-danger-emphasis, var(--color-danger-emphasis))",stroke:"var(--fgColor-onEmphasis, var(--color-fg-on-emphasis))",svgHtml:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,i.jsx)("line",{x1:"15",x2:"9",y1:"9",y2:"15"}),(0,i.jsx)("line",{x1:"9",x2:"15",y1:"9",y2:"15"})]})}},[a.U.Warning]:{priority:2,ariaLabel:"Check warning",primaryColor:"attention.fg",icon:{fill:"var(--bgColor-attention-emphasis, var(--color-attention-emphasis))",stroke:"var(--fgColor-onEmphasis, var(--color-fg-on-emphasis))",svgHtml:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,i.jsx)("line",{x1:"12",x2:"12",y1:"8",y2:"12"}),(0,i.jsx)("line",{x1:"12",x2:"12",y1:"16",y2:"16"})]})}},[a.U.Notice]:{priority:3,ariaLabel:"Check notice",primaryColor:"fg.muted",icon:{fill:"var(--bgColor-neutral-emphasis, var(--color-neutral-emphasis))",stroke:"var(--fgColor-onEmphasis, var(--color-fg-on-emphasis))",svgHtml:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,i.jsx)("line",{x1:"12",x2:"12",y1:"16",y2:"12"}),(0,i.jsx)("line",{x1:"12",x2:"12",y1:"8",y2:"8"})]})}}};try{l.displayName||(l.displayName="AnnotationIcon")}catch{}try{o.displayName||(o.displayName="AnimatedAnnotationIcon")}catch{}},81602:(e,t,n)=>{n.d(t,{$:()=>d});var i=n(74848),r=n(38621),a=n(16823),l=n(38553),s=n(23246),o=n(79476);let d=e=>(0,i.jsx)(o.B,{errorFallback:(0,i.jsx)(c,{}),suspenseFallback:(0,i.jsx)(u,{}),Component:f,...e}),c=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.l.Divider,{}),(0,i.jsxs)(a.l.Item,{disabled:!0,children:[(0,i.jsx)(a.l.LeadingVisual,{children:(0,i.jsx)(r.AlertIcon,{})}),"Copilot failed to load"]})]}),u=()=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.l.Divider,{}),(0,i.jsxs)(a.l.Item,{disabled:!0,children:[(0,i.jsx)(a.l.LeadingVisual,{children:(0,i.jsx)(l.A,{size:"small"})}),"Copilot is loading..."]})]}),f=e=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.l.Divider,{}),(0,i.jsx)(s.t,{eventContext:{prx:!0},leadingVisual:(0,i.jsx)(r.CopilotIcon,{}),fileDiffReference:e.fileDiffReference})]});try{d.displayName||(d.displayName="CopilotDiffChatBlobActionsMenuItems")}catch{}try{c.displayName||(c.displayName="MenuItemError")}catch{}try{u.displayName||(u.displayName="MenuItemLoading")}catch{}try{f.displayName||(f.displayName="BaseCopilotDiffChatBlobActionsMenuItems")}catch{}},79476:(e,t,n)=>{n.d(t,{B:()=>p,x:()=>f});var i=n(74848),r=n(91160),a=n(44196),l=n(96540),s=n(18312),o=n(54371);let d=n(45307),c=n(53706),u=n(71324),f=({children:e})=>{let{viewer:t}=(0,s.useLazyLoadQuery)(d,{});return t.isCopilotDotcomChatEnabled?(0,i.jsx)(i.Fragment,{children:e}):null},m=({Component:e,componentProps:t,queryVariables:n})=>{let{pullRequest:a}=(0,s.useLazyLoadQuery)(c,n),{diffEntry:l}=(0,s.useLazyLoadQuery)(u,n);(0,r.M)(a?.comparison),(0,r.M)(l);let d=(0,o.Kf)(a.comparison,l);return d?(0,i.jsx)(e,{fileDiffReference:d,...t}):null},h=({Component:e,componentProps:t,referenceData:n,queryVariables:a})=>{let{pullRequest:l}=(0,s.useLazyLoadQuery)(c,a);(0,r.M)(l?.comparison);let d=(0,o.hQ)(l?.comparison,n);return d?(0,i.jsx)(e,{fileDiffReference:d,...t}):null},p=({Component:e,componentProps:t,errorFallback:n=null,suspenseFallback:r=null,...s})=>(0,i.jsx)(a.t,{fallback:n,children:(0,i.jsx)(l.Suspense,{fallback:r,children:(0,i.jsx)(f,{children:s.referenceData?(0,i.jsx)(h,{Component:e,componentProps:t,referenceData:s.referenceData,queryVariables:s.queryVariables}):(0,i.jsx)(m,{Component:e,componentProps:t,queryVariables:s.queryVariables})})})});try{f.displayName||(f.displayName="CopilotCodeChatAccessLoader")}catch{}try{m.displayName||(m.displayName="CopilotCodeChatReferenceLoader")}catch{}try{h.displayName||(h.displayName="CopilotCodeChatComparisonLoader")}catch{}try{p.displayName||(p.displayName="DiffChatWrapper")}catch{}},78017:(e,t,n)=>{n.d(t,{i:()=>o});var i=n(74848),r=n(822),a=n(51848),l=n(54156),s=n(16823);let o=({fileDiffReference:e,eventContext:t,afterSelect:n})=>{let{addToast:o}=(0,l.Y6)();return(0,i.jsx)(s.l.Item,{onSelect:()=>{(0,r.Oc)(e),o({message:"Reference added to thread",type:"success"}),(0,a.BI)("copilot.file-diff.add",t),n?.()},children:"Attach to current thread"})};try{o.displayName||(o.displayName="DiffLinesAttachMenuItem")}catch{}},23246:(e,t,n)=>{n.d(t,{t:()=>o});var i=n(74848),r=n(822),a=n(89426),l=n(51848),s=n(16823);let o=({fileDiffReference:e,leadingVisual:t,eventContext:n,afterSelect:o})=>(0,i.jsxs)(s.l.Item,{onSelect:()=>{(0,r.qR)({intent:a.wh.conversation,references:[e]}),(0,l.BI)("copilot.file-diff.discuss",n),o?.()},children:[t&&(0,i.jsx)(s.l.LeadingVisual,{children:t}),"Ask about this diff"]});try{o.displayName||(o.displayName="DiffLinesDiscussMenuItem")}catch{}},39037:(e,t,n)=>{n.d(t,{e:()=>o});var i=n(74848),r=n(822),a=n(89426),l=n(51848),s=n(16823);let o=({fileDiffReference:e,eventContext:t,afterSelect:n})=>(0,i.jsx)(s.l.Item,{onSelect:()=>{(0,r.qR)({content:"Explain",intent:a.wh.explainFileDiff,references:[e]}),(0,l.BI)("copilot.file-diff.explain",t),n?.()},children:"Explain"});try{o.displayName||(o.displayName="DiffLinesExplainMenuItem")}catch{}},48058:(e,t,n)=>{n.d(t,{Fv:()=>h,kF:()=>p,F7:()=>m});var i=n(74848),r=n(38621),a=n(67749),l=n(89323),s=n(87330),o=n(38553),d=n(16823),c=n(96540),u=n(20053);let f={filterLoadingHeight:"FileFilter-module__filterLoadingHeight--cW8BP"},m="No extension";function h({filterText:e,onFilterTextChange:t}){return(0,i.jsxs)("div",{className:"d-flex flex-nowrap gap-2",children:[(0,i.jsx)(a.A,{block:!0,"aria-label":"Filter files\u2026",leadingVisual:r.SearchIcon,placeholder:"Filter files\u2026",value:e,onChange:e=>t?.(e.target.value)}),(0,i.jsxs)(l.W,{children:[(0,i.jsx)(l.W.Anchor,{children:(0,i.jsx)(s.K,{unsafeDisableTooltip:!0,"aria-label":"Filter",icon:r.SlidersIcon,className:"flex-shrink-0"})}),(0,i.jsx)(l.W.Overlay,{className:(0,u.$)(f.filterLoadingHeight),children:(0,i.jsx)("div",{className:(0,u.$)("d-flex","flex-column","flex-justify-center","flex-items-center",f.filterLoadingHeight),children:(0,i.jsx)(o.A,{size:"medium"})})})]})]})}function p({filterText:e,onFilterTextChange:t,fileExtensions:n,unselectedFileExtensions:o,onFilterChange:u,additionalFilterGroups:f}){let[h,p]=(0,c.useState)(e),g=(e,t)=>{u?.(e?"selectFileExtension":"unselectFileExtension",{extension:t})},x=Array.from(n||[]).filter(e=>e!==m).sort(),y=e=>!o?.has(e),b=n?.has(m);return(0,i.jsxs)("div",{className:"d-flex flex-nowrap gap-2",children:[(0,i.jsx)(a.A,{block:!0,"aria-label":"Filter files\u2026",leadingVisual:r.SearchIcon,placeholder:"Filter files\u2026",value:h,onChange:e=>{p(e.target.value),t?.(e.target.value)}}),(0,i.jsxs)(l.W,{children:[(0,i.jsx)(l.W.Anchor,{children:(0,i.jsx)(s.K,{unsafeDisableTooltip:!0,"aria-label":"Filter",icon:r.SlidersIcon,className:"flex-shrink-0"})}),(0,i.jsx)(l.W.Overlay,{children:(0,i.jsxs)(d.l,{children:[(0,i.jsxs)(d.l.Group,{selectionVariant:"multiple",children:[(0,i.jsx)(d.l.GroupHeading,{children:"File extensions"}),x.map(e=>{let t=y(e);return(0,i.jsx)(d.l.Item,{selected:t,onSelect:()=>g(!t,e),children:`${e}`},e)}),b&&(0,i.jsx)(d.l.Item,{selected:y(m),onSelect:()=>g(!y(m),m),children:m},m)]}),f]})})]})]})}try{h.displayName||(h.displayName="FileFilterLoading")}catch{}try{p.displayName||(p.displayName="FileFilterShared")}catch{}},50990:(e,t,n)=>{n.d(t,{Y:()=>h,o:()=>f});var i=n(74848),r=n(7572),a=n(97156),l=n(96540),s=n(77321),o=n(76515),d=n(30841),c=n(9393);let u=(0,l.createContext)(null);function f(){let e=(0,l.useContext)(u);if(!e)throw Error("useSelectedDiffRowRange must be used within a SelectedDiffRowRangeContext");return e}function m(e){e.startLineNumber===e.endLineNumber&&e.startOrientation===e.endOrientation?(0,r.i)(`${"left"===e.startOrientation?"L":"R"}${e.startLineNumber} selected.`):(0,r.i)(`${"left"===e.startOrientation?"L":"R"}${e.startLineNumber} to ${"left"===e.endOrientation?"L":"R"}${e.endLineNumber} selected.`)}function h({children:e}){let t=(0,l.useRef)(new Map),n=(0,d.K)(e=>{if(!e)return;let n=e.diffAnchor,i=t.current.get(n);if(!i)return;let{leftLines:r,rightLines:a}=(0,c.Mk)(i);return(0,s.A)({selectedDiffRowRange:e,leftLines:r,rightLines:a})}),[f,h]=(0,l.useState)(()=>(0,o.ZD)(a.fV.hash)),[p,g]=(0,l.useState)(()=>{if(f){let e=n(f);if(e)return{leftLines:e.selectedLeftLines,rightLines:e.selectedRightLines||[]}}return{leftLines:[],rightLines:[]}}),x=(0,d.K)(e=>{let t=n(e);g(t?{leftLines:t.selectedLeftLines,rightLines:t.selectedRightLines||[]}:{leftLines:[],rightLines:[]})}),y=(0,d.K)((e,t,n,i)=>{if(!t||!n)return;let r=i&&f&&f.diffAnchor===e?t<=f.firstSelectedLineNumber?{...f,startLineNumber:t,startOrientation:n,endLineNumber:f.firstSelectedLineNumber,endOrientation:f.firstSelectedOrientation}:{...f,startLineNumber:f.firstSelectedLineNumber,startOrientation:f.firstSelectedOrientation,endLineNumber:t,endOrientation:n}:{diffAnchor:e,endLineNumber:t,endOrientation:n,startLineNumber:t,startOrientation:n,firstSelectedLineNumber:t,firstSelectedOrientation:n};m(r),h(r),x(r),(0,o.i8)(r)}),b=(0,d.K)(e=>{m(e),h(e),x(e),(0,o.i8)(e)}),j=(0,d.K)(({diffAnchor:e,startGridCell:t,endGridCell:n,focusedGridCell:i})=>{b({diffAnchor:e,endLineNumber:n.lineNumber,endOrientation:n.orientation,firstSelectedLineNumber:i.lineNumber,firstSelectedOrientation:i.orientation,startLineNumber:t.lineNumber,startOrientation:t.orientation})}),C=(0,d.K)(()=>{f&&(h(void 0),x(void 0),(0,r.i)("Selection Cleared"),history.replaceState({},"",window.location.pathname+window.location.search))}),v=(0,d.K)((e,n)=>{t.current.set(e,n),f?.diffAnchor===e&&x(f)}),N=(0,d.K)(e=>t.current.get(e)),w=(0,l.useMemo)(()=>({selectedDiffRowRange:f,updateSelectedDiffRowRange:y,clearSelectedDiffRowRange:C,replaceSelectedDiffRowRange:b,replaceSelectedDiffRowRangeFromGridCells:j,updateDiffLines:v,selectedDiffLines:p,getDiffLinesFromLineRange:n,getDiffLinesByDiffAnchor:N}),[f,y,C,b,j,p,v,n,N]);return(0,i.jsx)(u.Provider,{value:w,children:e})}try{u.displayName||(u.displayName="SelectedDiffRowRange")}catch{}try{h.displayName||(h.displayName="SelectedDiffRowRangeContextProvider")}catch{}},59972:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var i,r=n(74848),a=n(59008),l=n(65481),s=n(75177),o=n(38553),d=n(52464),c=n(96540);function u(e){e&&(e.load=e.hello=null,e.helloTimer&&(clearTimeout(e.helloTimer),e.helloTimer=null),e.loadTimer&&(clearTimeout(e.loadTimer),e.loadTimer=null))}function f(e,t){e&&e.postMessage&&e.postMessage(JSON.stringify(t),"*")}function m({identityUuid:e,size:t,type:n,url:d}){let[m]=(0,a.I)(()=>window.location.origin,"https://www.github.com",[]),p=new URL(d,m).origin,{renderState:g,errorMsg:x,iFrameRef:y,containerRef:b}=function(e){let[t,n]=function(e){let[t,n]=(0,c.useState)(e),i=(0,c.useRef)(t);return[i,e=>{i.current=e,n(e)}]}("LOADING"),i=(0,c.useRef)(null),r=(0,c.useRef)(null),a=(0,c.useRef)(null),l=(0,c.useRef)({untimed:!0}),s=(0,c.useCallback)(t=>(function(e,t,n,i,r,a,l){if(e.origin!==t)return;let s=function(e){var t;let n=e.data;if(!n)return null;if("string"==typeof n)try{n=JSON.parse(n)}catch{return null}return"object"==typeof(t=n)&&t&&"render"===t.type&&"string"==typeof t.body&&"object"==typeof t.payload?n:null}(e);if(!s){a("ERROR");return}let o=s.body,d=null!=s.payload?s.payload:void 0,c=n.current?.contentWindow;switch(o){case"hello":(r.current??{untimed:!0}).hello=Date.now(),f(c,{type:"render:cmd",body:{cmd:"ack",ack:!0}}),f(c,{type:"render:cmd",body:{cmd:"branding",branding:!1}});break;case"error":case"error:fatal":case"error:invalid":d&&l(d.error??null),a("ERROR");break;case"loading":a("LOADING");break;case"loaded":a("LOADED");break;case"ready":d&&"number"==typeof d.height&&i.current&&(i.current.style.height=`${d.height}px`),a("READY");break;case"resize":d&&"number"==typeof d.height&&i.current&&(i.current.style.height=`${d.height}px`);break;case"code_rendering_service:container:get_size":f(c,{type:"render:cmd",body:{cmd:"code_rendering_service:container:size","code_rendering_service:container:size":{width:i.current?.getBoundingClientRect().width}}});break;case"code_rendering_service:markdown:get_data":if(!n.current||!i.current)return;!function(e,t){let n=e.getAttribute("data-content");if(!n)return;let i={type:"render:cmd",body:{cmd:"code_rendering_service:data:ready","code_rendering_service:data:ready":{data:JSON.parse(n).data,width:t.getBoundingClientRect().width}}};f(e.contentWindow,i)}(n.current,i.current)}})(t,e,r,a,l,n,e=>i.current=e),[e,n]);return(0,c.useEffect)(()=>{u(l.current);let e=e=>{("LOADING"===t.current||"LOADED"===t.current)&&(!e||l.current.hello)&&n("ERROR")};return l.current={load:Date.now(),hello:null,helloTimer:window.setTimeout(e,1e4,!0),loadTimer:window.setTimeout(e,45e3)},()=>{u(l.current)}},[t,n]),(0,c.useEffect)(()=>(window.addEventListener("message",s),()=>window.removeEventListener("message",s)),[s]),{renderState:t.current,errorMsg:i.current,iFrameRef:r,containerRef:a}}(p);if("ipynb"===n&&t>3e7||t>2e8)return(0,r.jsx)(l.A,{variant:"danger",children:"Sorry, this is too big to display."});let j=g!==i.READY?{height:"1px",width:"1px",position:"fixed",bottom:0,right:0}:{height:"100%",width:"100%"};return(0,r.jsx)(s.A,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:(0,r.jsxs)(s.A,{"data-hpc":!0,"data-host":p,"data-type":n,ref:b,sx:{width:1024,...g!==i.ERROR?{borderBottomLeftRadius:"6px",borderBottomRightRadius:"6px",lineHeight:"0",padding:5,textAlign:"center"}:{},...g===i.READY?{height:"500px",padding:0,background:"none"}:{}},children:[g===i.ERROR?(0,r.jsx)(h,{error:x}):g!==i.READY?(0,r.jsx)(o.A,{size:"large",sx:{mx:"auto"}}):null,g!==i.ERROR&&(0,r.jsx)(s.A,{as:"iframe",ref:y,src:`${d}#${e}`,sandbox:"allow-scripts allow-same-origin allow-top-navigation",sx:{border:0,display:"block",...j},name:e,title:"File display",children:"Viewer requires iframe."})]})})}function h({error:e}){if(!e)return(0,r.jsx)(l.A,{variant:"danger",children:"Unable to render code block"});let t=e.split("\n");return(0,r.jsxs)(l.A,{variant:"danger",children:[(0,r.jsx)(d.A,{as:"p",sx:{fontWeight:"bold"},children:"Error rendering embedded code"}),(0,r.jsx)("p",{children:t.map((e,t)=>(0,r.jsxs)(c.Fragment,{children:[e,(0,r.jsx)("br",{})]},`error-line-${t}`))})]})}!function(e){e.ERROR="ERROR",e.LOADING="LOADING",e.LOADED="LOADED",e.READY="READY"}(i||(i={}));try{m.displayName||(m.displayName="FileRendererBlob")}catch{}try{h.displayName||(h.displayName="FileRendererErrorMessage")}catch{}},42024:(e,t,n)=>{n.d(t,{Gy:()=>i,LB:()=>c,lm:()=>d,nn:()=>u});var i,r=n(74848),a=n(70170),l=n(96540);!function(e){e[e.small=1]="small",e[e.medium=544]="medium",e[e.large=768]="large",e[e.xlarge=1012]="xlarge",e[e.xxlarge=1280]="xxlarge",e[e.xxxlarge=1350]="xxxlarge",e[e.xxxxlarge=1440]="xxxxlarge"}(i||(i={}));let s=[1440,1350,1280,1012,768,544,1],o=l.createContext({screenSize:1});function d(){return l.useContext(o)}function c({children:e,initialValue:t}){let n=(0,l.useSyncExternalStore)(()=>()=>{},()=>t??u(window.innerWidth),()=>t??1),i=(0,l.useRef)(n),[s,d]=(0,l.useState)(n),c=(0,l.useCallback)(()=>{let e=u(window.innerWidth);i.current!==e&&(i.current=e,d(e))},[]);(0,l.useEffect)(()=>{let e=new ResizeObserver((0,a.s)(c));return e.observe(document.documentElement),()=>e.disconnect()},[c]);let f=(0,l.useMemo)(()=>({screenSize:s}),[s]);return(0,r.jsx)(o.Provider,{value:f,children:e})}function u(e){for(let t of s)if(e>=t)return t;return 1}try{o.displayName||(o.displayName="ScreenContext")}catch{}try{c.displayName||(c.displayName="ScreenSizeProvider")}catch{}},224:(e,t,n)=>{n.d(t,{k:()=>s});var i=n(74848),r=n(22868),a=n(75177),l=n(64872);function s({zIndex:e,altText:t,hovercardUrl:n,src:s,square:o,icon:d,iconColor:c,backgroundColor:u,backgroundSx:f,sx:m,size:h=20}){return(0,i.jsxs)(a.A,{sx:{position:"relative",display:"flex",gap:2,alignItems:"center",...e,...m},children:[(0,i.jsx)(r.r,{alt:t,"data-hovercard-url":n,size:h,square:o,src:s}),(0,i.jsx)(l.k,{icon:d,iconColor:c,size:12,backgroundColor:u,backgroundSx:f})]})}try{s.displayName||(s.displayName="StatusAvatar")}catch{}},64872:(e,t,n)=>{n.d(t,{k:()=>l});var i=n(74848),r=n(75177),a=n(30729);function l({iconColor:e,icon:t,size:n=12,backgroundColor:l="fg.onEmphasis",absolute:s=!0,backgroundSx:o}){let d,c;return 12===n?(d="10px",c="1px"):20===n?(d="16px",c="2px"):(d="16px",c="4px"),(0,i.jsxs)(r.A,{sx:{display:"flex",borderRadius:"100px",...s?{position:"absolute",bottom:-1,right:-1,boxShadow:"0 0 0 2px var(--bgColor-default, var(--color-canvas-default))",backgroundColor:"var(--bgColor-default, var(--color-canvas-default))"}:{position:"relative"},...o},children:[(0,i.jsx)(r.A,{sx:{display:"flex",position:"absolute",borderRadius:"100px",width:d,height:d,left:c,top:c,backgroundColor:l}}),(0,i.jsx)(a.A,{icon:t,size:n,sx:{color:e,position:"relative"}})]})}try{l.displayName||(l.displayName="StatusIcon")}catch{}}},e=>{var t=t=>e(e.s=t);e.O(0,["primer-react-css","react-lib","vendors-node_modules_dompurify_dist_purify_js","vendors-node_modules_primer_behaviors_dist_esm_index_mjs","vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_primer_react_lib-esm_Fea-39267a","vendors-node_modules_primer_react_lib-esm_Button_Button_js","vendors-node_modules_primer_react_lib-esm_TooltipV2_Tooltip_js","vendors-node_modules_primer_react_lib-esm_ActionList_index_js","vendors-node_modules_primer_react_lib-esm_AnchoredOverlay_AnchoredOverlay_js","vendors-node_modules_primer_react_lib-esm_Text_Text_js-node_modules_primer_react_lib-esm_Text-7845da","vendors-node_modules_primer_react_lib-esm_FormControl_FormControl_js","vendors-node_modules_primer_react_lib-esm_ActionMenu_ActionMenu_js","vendors-node_modules_github_catalyst_lib_index_js-node_modules_primer_live-region-element_dis-428401","vendors-node_modules_react-router-dom_dist_index_js","vendors-node_modules_primer_react_lib-esm_FilteredActionList_FilteredActionListEntry_js","vendors-node_modules_github_relative-time-element_dist_index_js","vendors-node_modules_primer_react_lib-esm_ConfirmationDialog_ConfirmationDialog_js-node_modul-c2760e","vendors-node_modules_react-relay_index_js","vendors-node_modules_braintree_browser-detection_dist_browser-detection_js-node_modules_githu-bb80ec","vendors-node_modules_date-fns_format_mjs","vendors-node_modules_primer_react_lib-esm_Link_Link_js-node_modules_primer_react_lib-esm_Page-7c6288","vendors-node_modules_date-fns_addWeeks_mjs-node_modules_date-fns_addYears_mjs-node_modules_da-827f4f","vendors-node_modules_primer_react_lib-esm_KeybindingHint_KeybindingHint_js-node_modules_githu-3fe5e5","vendors-node_modules_primer_react_lib-esm_Avatar_Avatar_js-node_modules_primer_react_lib-esm_-ec4271","vendors-node_modules_primer_react_lib-esm_Popover_Popover_js-node_modules_date-fns_getDaysInM-dd25c8","vendors-node_modules_primer_react_lib-esm_Button_LinkButton_js-node_modules_primer_react_lib--206e8b","vendors-node_modules_primer_react_lib-esm_Dialog_js-node_modules_github_hydro-analytics-clien-531545","vendors-node_modules_github_quote-selection_dist_index_js-node_modules_primer_react_lib-esm_A-9d18ab","vendors-node_modules_primer_react_lib-esm_BranchName_BranchName_js-node_modules_primer_react_-3219ed","ui_packages_react-core_register-app_ts-ui_packages_react-core_JsonRoute_tsx","ui_packages_list-view_src_ListItem_ListItem_tsx-ui_packages_list-view_src_ListItem_Title_tsx--68e5b9","ui_packages_verified-fetch_verified-fetch_ts-ui_packages_item-picker_components_ItemPicker_tsx","ui_packages_date-picker_date-picker_ts-ui_packages_github-avatar_GitHubAvatar_tsx","ui_packages_relay-environment_relay-environment_ts-ui_packages_item-picker_components_Reposit-97e2e1","ui_packages_issue-create_dialog_CreateIssueDialogEntry_tsx","ui_packages_ref-selector_RefSelector_tsx","ui_packages_analytics-provider_analytics-provider_ts-ui_packages_commenting_hooks_use-markdow-3a16f3","ui_packages_commit-attribution_index_ts-ui_packages_commit-checks-status_index_ts-ui_packages-8621a7","ui_packages_code-view-shared_hooks_shortcuts_ts-ui_packages_code-view-shared_utilities_web-wo-ad5f08","ui_packages_react-core_create-browser-history_ts-ui_packages_commits_shared_Commits_tsx-ui_pa-6cd8ea"],()=>t(92957)),e.O()}]);
//# sourceMappingURL=commits-383b1a7a084d.js.map